<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Alan T. Arnholt">

<title>Misc Regression</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="MiscRegression_files/libs/clipboard/clipboard.min.js"></script>
<script src="MiscRegression_files/libs/quarto-html/quarto.js"></script>
<script src="MiscRegression_files/libs/quarto-html/popper.min.js"></script>
<script src="MiscRegression_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="MiscRegression_files/libs/quarto-html/anchor.min.js"></script>
<link href="MiscRegression_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="MiscRegression_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="MiscRegression_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="MiscRegression_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="MiscRegression_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

<link href="MiscRegression_files/libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="MiscRegression_files/libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="MiscRegression_files/libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="MiscRegression_files/libs/datatables-binding-0.33/datatables.js"></script>
<script src="MiscRegression_files/libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="MiscRegression_files/libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="MiscRegression_files/libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="MiscRegression_files/libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="MiscRegression_files/libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="MiscRegression_files/libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<script src="MiscRegression_files/libs/detect-resize-0.5.3/jquery.resize.js"></script>
<link href="MiscRegression_files/libs/jquery-ui-1.11.4/jquery-ui.min.css" rel="stylesheet">
<script src="MiscRegression_files/libs/jquery-ui-1.11.4/jquery-ui.min.js"></script>
<script src="MiscRegression_files/libs/d3-3.5.2/d3.min.js"></script>
<script src="MiscRegression_files/libs/vega-1.4.3/vega.min.js"></script>
<script src="MiscRegression_files/libs/lodash-4.17.21/lodash.min.js"></script>
<script>var lodash = _.noConflict();</script>
<link href="MiscRegression_files/libs/ggvis-0.4.9/css/ggvis.css" rel="stylesheet">
<script src="MiscRegression_files/libs/ggvis-0.4.9/js/ggvis.js"></script>
<script src="MiscRegression_files/libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="MiscRegression_files/libs/typedarray-0.1/typedarray.min.js"></script>
<link href="MiscRegression_files/libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="MiscRegression_files/libs/plotly-main-2.11.1/plotly-latest.min.js"></script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Misc Regression</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Alan T. Arnholt </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">Last modified on September 24, 2024 09:13:15 Eastern Daylight Time</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="read-in-data-with-read.csv" class="level1">
<h1>Read in data with <code>read.csv()</code></h1>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>site <span class="ot">&lt;-</span> <span class="st">"http://statlearning.com/s/Advertising.csv"</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>AD <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(site)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(AD)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  X    TV radio newspaper sales
1 1 230.1  37.8      69.2  22.1
2 2  44.5  39.3      45.1  10.4
3 3  17.2  45.9      69.3   9.3
4 4 151.5  41.3      58.5  18.5
5 5 180.8  10.8      58.4  12.9
6 6   8.7  48.9      75.0   7.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(AD)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 200   5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DT)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(AD[, <span class="sc">-</span><span class="dv">1</span>], <span class="at">rownames =</span> <span class="cn">FALSE</span>,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">caption =</span> <span class="st">'Table 1: This is a simple caption for the table.'</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item" id="htmlwidget-9eceb20dc2a931752ae4" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-9eceb20dc2a931752ae4">{"x":{"filter":"none","vertical":false,"caption":"<caption>Table 1: This is a simple caption for the table.<\/caption>","data":[[230.1,44.5,17.2,151.5,180.8,8.699999999999999,57.5,120.2,8.6,199.8,66.09999999999999,214.7,23.8,97.5,204.1,195.4,67.8,281.4,69.2,147.3,218.4,237.4,13.2,228.3,62.3,262.9,142.9,240.1,248.8,70.59999999999999,292.9,112.9,97.2,265.6,95.7,290.7,266.9,74.7,43.1,228,202.5,177,293.6,206.9,25.1,175.1,89.7,239.9,227.2,66.90000000000001,199.8,100.4,216.4,182.6,262.7,198.9,7.3,136.2,210.8,210.7,53.5,261.3,239.3,102.7,131.1,69,31.5,139.3,237.4,216.8,199.1,109.8,26.8,129.4,213.4,16.9,27.5,120.5,5.4,116,76.40000000000001,239.8,75.3,68.40000000000001,213.5,193.2,76.3,110.7,88.3,109.8,134.3,28.6,217.7,250.9,107.4,163.3,197.6,184.9,289.7,135.2,222.4,296.4,280.2,187.9,238.2,137.9,25,90.40000000000001,13.1,255.4,225.8,241.7,175.7,209.6,78.2,75.09999999999999,139.2,76.40000000000001,125.7,19.4,141.3,18.8,224,123.1,229.5,87.2,7.8,80.2,220.3,59.6,0.7,265.2,8.4,219.8,36.9,48.3,25.6,273.7,43,184.9,73.40000000000001,193.7,220.5,104.6,96.2,140.3,240.1,243.2,38,44.7,280.7,121,197.6,171.3,187.8,4.1,93.90000000000001,149.8,11.7,131.7,172.5,85.7,188.4,163.5,117.2,234.5,17.9,206.8,215.4,284.3,50,164.5,19.6,168.4,222.4,276.9,248.4,170.2,276.7,165.6,156.6,218.5,56.2,287.6,253.8,205,139.5,191.1,286,18.7,39.5,75.5,17.2,166.8,149.7,38.2,94.2,177,283.6,232.1],[37.8,39.3,45.9,41.3,10.8,48.9,32.8,19.6,2.1,2.6,5.8,24,35.1,7.6,32.9,47.7,36.6,39.6,20.5,23.9,27.7,5.1,15.9,16.9,12.6,3.5,29.3,16.7,27.1,16,28.3,17.4,1.5,20,1.4,4.1,43.8,49.4,26.7,37.7,22.3,33.4,27.7,8.4,25.7,22.5,9.9,41.5,15.8,11.7,3.1,9.6,41.7,46.2,28.8,49.4,28.1,19.2,49.6,29.5,2,42.7,15.5,29.6,42.8,9.300000000000001,24.6,14.5,27.5,43.9,30.6,14.3,33,5.7,24.6,43.7,1.6,28.5,29.9,7.7,26.7,4.1,20.3,44.5,43,18.4,27.5,40.6,25.5,47.8,4.9,1.5,33.5,36.5,14,31.6,3.5,21,42.3,41.7,4.3,36.3,10.1,17.2,34.3,46.4,11,0.3,0.4,26.9,8.199999999999999,38,15.4,20.6,46.8,35,14.3,0.8,36.9,16,26.8,21.7,2.4,34.6,32.3,11.8,38.9,0,49,12,39.6,2.9,27.2,33.5,38.6,47,39,28.9,25.9,43.9,17,35.4,33.2,5.7,14.8,1.9,7.3,49,40.3,25.8,13.9,8.4,23.3,39.7,21.1,11.6,43.5,1.3,36.9,18.4,18.1,35.8,18.1,36.8,14.7,3.4,37.6,5.2,23.6,10.6,11.6,20.9,20.1,7.1,3.4,48.9,30.2,7.8,2.3,10,2.6,5.4,5.7,43,21.3,45.1,2.1,28.7,13.9,12.1,41.1,10.8,4.1,42,35.6,3.7,4.9,9.300000000000001,42,8.6],[69.2,45.1,69.3,58.5,58.4,75,23.5,11.6,1,21.2,24.2,4,65.90000000000001,7.2,46,52.9,114,55.8,18.3,19.1,53.4,23.5,49.6,26.2,18.3,19.5,12.6,22.9,22.9,40.8,43.2,38.6,30,0.3,7.4,8.5,5,45.7,35.1,32,31.6,38.7,1.8,26.4,43.3,31.5,35.7,18.5,49.9,36.8,34.6,3.6,39.6,58.7,15.9,60,41.4,16.6,37.7,9.300000000000001,21.4,54.7,27.3,8.4,28.9,0.9,2.2,10.2,11,27.2,38.7,31.7,19.3,31.3,13.1,89.40000000000001,20.7,14.2,9.4,23.1,22.3,36.9,32.5,35.6,33.8,65.7,16,63.2,73.40000000000001,51.4,9.300000000000001,33,59,72.3,10.9,52.9,5.9,22,51.2,45.9,49.8,100.9,21.4,17.9,5.3,59,29.7,23.2,25.6,5.5,56.5,23.2,2.4,10.7,34.5,52.7,25.6,14.8,79.2,22.3,46.2,50.4,15.6,12.4,74.2,25.9,50.6,9.199999999999999,3.2,43.1,8.699999999999999,43,2.1,45.1,65.59999999999999,8.5,9.300000000000001,59.7,20.5,1.7,12.9,75.59999999999999,37.9,34.4,38.9,9,8.699999999999999,44.3,11.9,20.6,37,48.7,14.2,37.7,9.5,5.7,50.5,24.3,45.2,34.6,30.7,49.3,25.6,7.4,5.4,84.8,21.6,19.4,57.6,6.4,18.4,47.4,17,12.8,13.1,41.8,20.3,35.2,23.7,17.6,8.300000000000001,27.4,29.7,71.8,30,19.6,26.6,18.2,3.7,23.4,5.8,6,31.6,3.6,6,13.8,8.1,6.4,66.2,8.699999999999999],[22.1,10.4,9.300000000000001,18.5,12.9,7.2,11.8,13.2,4.8,10.6,8.6,17.4,9.199999999999999,9.699999999999999,19,22.4,12.5,24.4,11.3,14.6,18,12.5,5.6,15.5,9.699999999999999,12,15,15.9,18.9,10.5,21.4,11.9,9.6,17.4,9.5,12.8,25.4,14.7,10.1,21.5,16.6,17.1,20.7,12.9,8.5,14.9,10.6,23.2,14.8,9.699999999999999,11.4,10.7,22.6,21.2,20.2,23.7,5.5,13.2,23.8,18.4,8.1,24.2,15.7,14,18,9.300000000000001,9.5,13.4,18.9,22.3,18.3,12.4,8.800000000000001,11,17,8.699999999999999,6.9,14.2,5.3,11,11.8,12.3,11.3,13.6,21.7,15.2,12,16,12.9,16.7,11.2,7.3,19.4,22.2,11.5,16.9,11.7,15.5,25.4,17.2,11.7,23.8,14.8,14.7,20.7,19.2,7.2,8.699999999999999,5.3,19.8,13.4,21.8,14.1,15.9,14.6,12.6,12.2,9.4,15.9,6.6,15.5,7,11.6,15.2,19.7,10.6,6.6,8.800000000000001,24.7,9.699999999999999,1.6,12.7,5.7,19.6,10.8,11.6,9.5,20.8,9.6,20.7,10.9,19.2,20.1,10.4,11.4,10.3,13.2,25.4,10.9,10.1,16.1,11.6,16.6,19,15.6,3.2,15.3,10.1,7.3,12.9,14.4,13.3,14.9,18,11.9,11.9,8,12.2,17.1,15,8.4,14.5,7.6,11.7,11.5,27,20.2,11.7,11.8,12.6,10.5,12.2,8.699999999999999,26.2,17.6,22.6,10.3,17.3,15.9,6.7,10.8,9.9,5.9,19.6,17.3,7.6,9.699999999999999,12.8,25.5,13.4]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>TV<\/th>\n      <th>radio<\/th>\n      <th>newspaper<\/th>\n      <th>sales<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[0,1,2,3]},{"name":"TV","targets":0},{"name":"radio","targets":1},{"name":"newspaper","targets":2},{"name":"sales","targets":3}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<section id="base-r-graph" class="level2">
<h2 class="anchored" data-anchor-id="base-r-graph">Base R Graph</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sales <span class="sc">~</span> TV, <span class="at">data =</span> AD, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">pch =</span> <span class="dv">19</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(sales <span class="sc">~</span> TV, <span class="at">data =</span> AD)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(mod1, <span class="at">col =</span> <span class="st">"blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-base1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="MiscRegression_files/figure-html/fig-base1-1.png" class="img-fluid figure-img" width="480"></p>
<figcaption class="figure-caption">Figure&nbsp;1: Base R scatterplot of <code>sales</code> versus <code>TV</code></figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sales <span class="sc">~</span> TV, <span class="at">data =</span> AD, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">pch =</span> <span class="dv">19</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(sales <span class="sc">~</span> TV, <span class="at">data =</span> AD)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(mod1, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sales <span class="sc">~</span> radio, <span class="at">data =</span> AD, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">pch =</span> <span class="dv">19</span>)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(sales <span class="sc">~</span> radio, <span class="at">data =</span> AD)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(mod2, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sales <span class="sc">~</span> newspaper, <span class="at">data =</span> AD, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">pch =</span> <span class="dv">19</span>)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>mod3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(sales <span class="sc">~</span> newspaper, <span class="at">data =</span> AD)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(mod3, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-youchange" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="MiscRegression_files/figure-html/fig-youchange-1.png" class="img-fluid figure-img" width="1152"></p>
<figcaption class="figure-caption">Figure&nbsp;2: You should change this caption</figcaption>
</figure>
</div>
</div>
</div>
<p>Change the caption in <a href="#fig-youchange">Figure&nbsp;2</a>.</p>
</section>
<section id="using-ggplot2" class="level2">
<h2 class="anchored" data-anchor-id="using-ggplot2">Using <code>ggplot2</code></h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> AD, <span class="fu">aes</span>(<span class="at">x =</span> TV, <span class="at">y =</span> sales)) <span class="sc">+</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"lightblue"</span>) <span class="sc">+</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"loess"</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"rlm"</span>, <span class="at">color =</span> <span class="st">"purple"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-ggp" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="MiscRegression_files/figure-html/fig-ggp-1.png" class="img-fluid figure-img" width="480"></p>
<figcaption class="figure-caption">Figure&nbsp;3: <code>ggplot</code> graph with three superimposed lines</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> AD, <span class="fu">aes</span>(<span class="at">x =</span> TV, <span class="at">y =</span> sales)) <span class="sc">+</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"lightblue"</span>) <span class="sc">+</span> </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme_bw</span>()</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> AD, <span class="fu">aes</span>(<span class="at">x =</span> radio, <span class="at">y =</span> sales)) <span class="sc">+</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"lightblue"</span>) <span class="sc">+</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme_bw</span>()</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> AD, <span class="fu">aes</span>(<span class="at">x =</span> newspaper, <span class="at">y =</span> sales)) <span class="sc">+</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"lightblue"</span>) <span class="sc">+</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span> </span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme_bw</span>()</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p1, p2, p3, <span class="at">ncol =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-gm" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="MiscRegression_files/figure-html/fig-gm-1.png" class="img-fluid figure-img" width="1152"></p>
<figcaption class="figure-caption">Figure&nbsp;4: Using <code>grid.arrange()</code> with <code>ggplot</code></figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="MiscRegression_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="1152"></p>
<figcaption class="figure-caption">Using <code>patchwork</code> with <code>ggplot</code></figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="using-ggvis" class="level2">
<h2 class="anchored" data-anchor-id="using-ggvis">Using <code>ggvis</code></h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggvis)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>AD <span class="sc">%&gt;%</span> </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggvis</span>(<span class="at">x =</span> <span class="sc">~</span>TV, <span class="at">y =</span> <span class="sc">~</span>sales) <span class="sc">%&gt;%</span> </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layer_points</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layer_model_predictions</span>(<span class="at">model =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layer_model_predictions</span>(<span class="at">model =</span> <span class="st">"MASS::rlm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">stroke :=</span> <span class="st">"blue"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layer_smooths</span>(<span class="at">stroke:=</span><span class="st">"red"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="plot_id358819767-container" class="ggvis-output-container">
<div id="plot_id358819767" class="ggvis-output"></div>
<div class="plot-gear-icon">
<nav class="ggvis-control">
<a class="ggvis-dropdown-toggle" title="Controls" onclick="return false;" href=""></a>
<ul class="ggvis-dropdown">
<li>
Renderer: 
<a id="plot_id358819767_renderer_svg" class="ggvis-renderer-button" onclick="return false;" data-plot-id="plot_id358819767" data-renderer="svg" href="">SVG</a>
 | 
<a id="plot_id358819767_renderer_canvas" class="ggvis-renderer-button" onclick="return false;" data-plot-id="plot_id358819767" data-renderer="canvas" href="">Canvas</a>
</li>
<li>
<a id="plot_id358819767_download" class="ggvis-download" data-plot-id="plot_id358819767" href="">Download</a>
</li>
</ul>
</nav>
</div>
</div>
<script type="text/javascript">
var plot_id358819767_spec = {
  "data": [
    {
      "name": ".0",
      "format": {
        "type": "csv",
        "parse": {
          "TV": "number",
          "sales": "number"
        }
      },
      "values": "\"TV\",\"sales\"\n230.1,22.1\n44.5,10.4\n17.2,9.3\n151.5,18.5\n180.8,12.9\n8.7,7.2\n57.5,11.8\n120.2,13.2\n8.6,4.8\n199.8,10.6\n66.1,8.6\n214.7,17.4\n23.8,9.2\n97.5,9.7\n204.1,19\n195.4,22.4\n67.8,12.5\n281.4,24.4\n69.2,11.3\n147.3,14.6\n218.4,18\n237.4,12.5\n13.2,5.6\n228.3,15.5\n62.3,9.7\n262.9,12\n142.9,15\n240.1,15.9\n248.8,18.9\n70.6,10.5\n292.9,21.4\n112.9,11.9\n97.2,9.6\n265.6,17.4\n95.7,9.5\n290.7,12.8\n266.9,25.4\n74.7,14.7\n43.1,10.1\n228,21.5\n202.5,16.6\n177,17.1\n293.6,20.7\n206.9,12.9\n25.1,8.5\n175.1,14.9\n89.7,10.6\n239.9,23.2\n227.2,14.8\n66.9,9.7\n199.8,11.4\n100.4,10.7\n216.4,22.6\n182.6,21.2\n262.7,20.2\n198.9,23.7\n7.3,5.5\n136.2,13.2\n210.8,23.8\n210.7,18.4\n53.5,8.1\n261.3,24.2\n239.3,15.7\n102.7,14\n131.1,18\n69,9.3\n31.5,9.5\n139.3,13.4\n237.4,18.9\n216.8,22.3\n199.1,18.3\n109.8,12.4\n26.8,8.8\n129.4,11\n213.4,17\n16.9,8.7\n27.5,6.9\n120.5,14.2\n5.4,5.3\n116,11\n76.4,11.8\n239.8,12.3\n75.3,11.3\n68.4,13.6\n213.5,21.7\n193.2,15.2\n76.3,12\n110.7,16\n88.3,12.9\n109.8,16.7\n134.3,11.2\n28.6,7.3\n217.7,19.4\n250.9,22.2\n107.4,11.5\n163.3,16.9\n197.6,11.7\n184.9,15.5\n289.7,25.4\n135.2,17.2\n222.4,11.7\n296.4,23.8\n280.2,14.8\n187.9,14.7\n238.2,20.7\n137.9,19.2\n25,7.2\n90.4,8.7\n13.1,5.3\n255.4,19.8\n225.8,13.4\n241.7,21.8\n175.7,14.1\n209.6,15.9\n78.2,14.6\n75.1,12.6\n139.2,12.2\n76.4,9.4\n125.7,15.9\n19.4,6.6\n141.3,15.5\n18.8,7\n224,11.6\n123.1,15.2\n229.5,19.7\n87.2,10.6\n7.8,6.6\n80.2,8.8\n220.3,24.7\n59.6,9.7\n0.7,1.6\n265.2,12.7\n8.4,5.7\n219.8,19.6\n36.9,10.8\n48.3,11.6\n25.6,9.5\n273.7,20.8\n43,9.6\n184.9,20.7\n73.4,10.9\n193.7,19.2\n220.5,20.1\n104.6,10.4\n96.2,11.4\n140.3,10.3\n240.1,13.2\n243.2,25.4\n38,10.9\n44.7,10.1\n280.7,16.1\n121,11.6\n197.6,16.6\n171.3,19\n187.8,15.6\n4.1,3.2\n93.9,15.3\n149.8,10.1\n11.7,7.3\n131.7,12.9\n172.5,14.4\n85.7,13.3\n188.4,14.9\n163.5,18\n117.2,11.9\n234.5,11.9\n17.9,8\n206.8,12.2\n215.4,17.1\n284.3,15\n50,8.4\n164.5,14.5\n19.6,7.6\n168.4,11.7\n222.4,11.5\n276.9,27\n248.4,20.2\n170.2,11.7\n276.7,11.8\n165.6,12.6\n156.6,10.5\n218.5,12.2\n56.2,8.7\n287.6,26.2\n253.8,17.6\n205,22.6\n139.5,10.3\n191.1,17.3\n286,15.9\n18.7,6.7\n39.5,10.8\n75.5,9.9\n17.2,5.9\n166.8,19.6\n149.7,17.3\n38.2,7.6\n94.2,9.7\n177,12.8\n283.6,25.5\n232.1,13.4"
    },
    {
      "name": ".0/model_prediction1",
      "format": {
        "type": "csv",
        "parse": {
          "pred_": "number",
          "resp_": "number"
        }
      },
      "values": "\"pred_\",\"resp_\"\n0.7,7.06586919743081\n4.44303797468354,7.24380064776048\n8.18607594936709,7.42173209809015\n11.9291139240506,7.59966354841982\n15.6721518987342,7.77759499874949\n19.4151898734177,7.95552644907916\n23.1582278481013,8.13345789940883\n26.9012658227848,8.3113893497385\n30.6443037974684,8.48932080006817\n34.3873417721519,8.66725225039784\n38.1303797468354,8.84518370072751\n41.873417721519,9.02311515105718\n45.6164556962025,9.20104660138685\n49.3594936708861,9.37897805171652\n53.1025316455696,9.55690950204619\n56.8455696202532,9.73484095237586\n60.5886075949367,9.91277240270554\n64.3316455696202,10.0907038530352\n68.0746835443038,10.2686353033649\n71.8177215189873,10.4465667536945\n75.5607594936709,10.6244982040242\n79.3037974683544,10.8024296543539\n83.046835443038,10.9803611046836\n86.7898734177215,11.1582925550132\n90.5329113924051,11.3362240053429\n94.2759493670886,11.5141554556726\n98.0189873417722,11.6920869060022\n101.762025316456,11.8700183563319\n105.505063291139,12.0479498066616\n109.248101265823,12.2258812569912\n112.991139240506,12.4038127073209\n116.73417721519,12.5817441576506\n120.477215189873,12.7596756079803\n124.220253164557,12.9376070583099\n127.963291139241,13.1155385086396\n131.706329113924,13.2934699589693\n135.449367088608,13.4714014092989\n139.192405063291,13.6493328596286\n142.935443037975,13.8272643099583\n146.678481012658,14.0051957602879\n150.421518987342,14.1831272106176\n154.164556962025,14.3610586609473\n157.907594936709,14.538990111277\n161.650632911392,14.7169215616066\n165.393670886076,14.8948530119363\n169.136708860759,15.072784462266\n172.879746835443,15.2507159125956\n176.622784810127,15.4286473629253\n180.36582278481,15.606578813255\n184.108860759494,15.7845102635846\n187.851898734177,15.9624417139143\n191.594936708861,16.140373164244\n195.337974683544,16.3183046145737\n199.081012658228,16.4962360649033\n202.824050632911,16.674167515233\n206.567088607595,16.8520989655627\n210.310126582278,17.0300304158923\n214.053164556962,17.207961866222\n217.796202531646,17.3858933165517\n221.539240506329,17.5638247668813\n225.282278481013,17.741756217211\n229.025316455696,17.9196876675407\n232.76835443038,18.0976191178704\n236.511392405063,18.2755505682\n240.254430379747,18.4534820185297\n243.99746835443,18.6314134688594\n247.740506329114,18.809344919189\n251.483544303797,18.9872763695187\n255.226582278481,19.1652078198484\n258.969620253165,19.343139270178\n262.712658227848,19.5210707205077\n266.455696202532,19.6990021708374\n270.198734177215,19.8769336211671\n273.941772151899,20.0548650714967\n277.684810126582,20.2327965218264\n281.427848101266,20.4107279721561\n285.170886075949,20.5886594224857\n288.913924050633,20.7665908728154\n292.656962025316,20.9445223231451\n296.4,21.1224537734748"
    },
    {
      "name": ".0/model_prediction2",
      "format": {
        "type": "csv",
        "parse": {
          "pred_": "number",
          "resp_": "number"
        }
      },
      "values": "\"pred_\",\"resp_\"\n0.7,6.91869596631972\n4.44303797468354,7.1024988103251\n8.18607594936709,7.28630165433049\n11.9291139240506,7.47010449833587\n15.6721518987342,7.65390734234125\n19.4151898734177,7.83771018634663\n23.1582278481013,8.02151303035201\n26.9012658227848,8.2053158743574\n30.6443037974684,8.38911871836278\n34.3873417721519,8.57292156236816\n38.1303797468354,8.75672440637354\n41.873417721519,8.94052725037893\n45.6164556962025,9.12433009438431\n49.3594936708861,9.30813293838969\n53.1025316455696,9.49193578239507\n56.8455696202532,9.67573862640045\n60.5886075949367,9.85954147040584\n64.3316455696202,10.0433443144112\n68.0746835443038,10.2271471584166\n71.8177215189873,10.410950002422\n75.5607594936709,10.5947528464274\n79.3037974683544,10.7785556904327\n83.046835443038,10.9623585344381\n86.7898734177215,11.1461613784435\n90.5329113924051,11.3299642224489\n94.2759493670886,11.5137670664543\n98.0189873417722,11.6975699104597\n101.762025316456,11.881372754465\n105.505063291139,12.0651755984704\n109.248101265823,12.2489784424758\n112.991139240506,12.4327812864812\n116.73417721519,12.6165841304866\n120.477215189873,12.800386974492\n124.220253164557,12.9841898184973\n127.963291139241,13.1679926625027\n131.706329113924,13.3517955065081\n135.449367088608,13.5355983505135\n139.192405063291,13.7194011945189\n142.935443037975,13.9032040385242\n146.678481012658,14.0870068825296\n150.421518987342,14.270809726535\n154.164556962025,14.4546125705404\n157.907594936709,14.6384154145458\n161.650632911392,14.8222182585512\n165.393670886076,15.0060211025565\n169.136708860759,15.1898239465619\n172.879746835443,15.3736267905673\n176.622784810127,15.5574296345727\n180.36582278481,15.7412324785781\n184.108860759494,15.9250353225834\n187.851898734177,16.1088381665888\n191.594936708861,16.2926410105942\n195.337974683544,16.4764438545996\n199.081012658228,16.660246698605\n202.824050632911,16.8440495426104\n206.567088607595,17.0278523866157\n210.310126582278,17.2116552306211\n214.053164556962,17.3954580746265\n217.796202531646,17.5792609186319\n221.539240506329,17.7630637626373\n225.282278481013,17.9468666066427\n229.025316455696,18.130669450648\n232.76835443038,18.3144722946534\n236.511392405063,18.4982751386588\n240.254430379747,18.6820779826642\n243.99746835443,18.8658808266696\n247.740506329114,19.0496836706749\n251.483544303797,19.2334865146803\n255.226582278481,19.4172893586857\n258.969620253165,19.6010922026911\n262.712658227848,19.7848950466965\n266.455696202532,19.9686978907019\n270.198734177215,20.1525007347072\n273.941772151899,20.3363035787126\n277.684810126582,20.520106422718\n281.427848101266,20.7039092667234\n285.170886075949,20.8877121107288\n288.913924050633,21.0715149547341\n292.656962025316,21.2553177987395\n296.4,21.4391206427449"
    },
    {
      "name": ".0/model_prediction3",
      "format": {
        "type": "csv",
        "parse": {
          "pred_": "number",
          "resp_": "number"
        }
      },
      "values": "\"pred_\",\"resp_\"\n0.7,5.51731358643158\n4.44303797468354,5.8645911489541\n8.18607594936709,6.20601766810242\n11.9291139240506,6.54099540113886\n15.6721518987342,6.86892660532573\n19.4151898734177,7.18921353792535\n23.1582278481013,7.50125845620005\n26.9012658227848,7.80446361741213\n30.6443037974684,8.09867719888885\n34.3873417721519,8.38464800043307\n38.1303797468354,8.66275580278697\n41.873417721519,8.93336833521294\n45.6164556962025,9.1968533269734\n49.3594936708861,9.45357850733075\n53.1025316455696,9.7039116055474\n56.8455696202532,9.94822035088576\n60.5886075949367,10.1868724726082\n64.3316455696202,10.4202356999772\n68.0746835443038,10.6486777622551\n71.8177215189873,10.8725663887044\n75.5607594936709,11.0894277593658\n79.3037974683544,11.2882286357326\n83.046835443038,11.4708257844813\n86.7898734177215,11.6406921860126\n90.5329113924051,11.801300820727\n94.2759493670886,11.9561246690251\n98.0189873417722,12.1086367113075\n101.762025316456,12.2623099279749\n105.505063291139,12.4206172994278\n109.248101265823,12.5870318060668\n112.991139240506,12.7617863869025\n116.73417721519,12.9403217484381\n120.477215189873,13.1217394186302\n124.220253164557,13.3052222927054\n127.963291139241,13.4899532658899\n131.706329113924,13.6751152334104\n135.449367088608,13.8598910904931\n139.192405063291,14.0434637323645\n142.935443037975,14.225016054251\n146.678481012658,14.4037309513791\n150.421518987342,14.5788722272756\n154.164556962025,14.7525886154557\n157.907594936709,14.9258982728726\n161.650632911392,15.0984511980742\n165.393670886076,15.2698973896086\n169.136708860759,15.4398868460239\n172.879746835443,15.608069565868\n176.622784810127,15.774095547689\n180.36582278481,15.9376147900349\n184.108860759494,16.0982772914537\n187.851898734177,16.2557330504935\n191.594936708861,16.4096320657023\n195.337974683544,16.5589877750364\n199.081012658228,16.701670176177\n202.824050632911,16.8396254815227\n206.567088607595,16.9752426150115\n210.310126582278,17.1109105005816\n214.053164556962,17.2490180621711\n217.796202531646,17.3919542237182\n221.539240506329,17.539002210639\n225.282278481013,17.6852308062787\n229.025316455696,17.8307347687084\n232.76835443038,17.9757627870795\n236.511392405063,18.1205635505432\n240.254430379747,18.2653857482508\n243.99746835443,18.4104780693536\n247.740506329114,18.5560892030028\n251.483544303797,18.7022985204439\n255.226582278481,18.8488783686474\n258.969620253165,18.995792573424\n262.712658227848,19.1430112643754\n266.455696202532,19.290504571103\n270.198734177215,19.4382426232085\n273.941772151899,19.5861955502936\n277.684810126582,19.7343334819597\n281.427848101266,19.8826265478084\n285.170886075949,20.0310448774414\n288.913924050633,20.1795586004602\n292.656962025316,20.3281378464665\n296.4,20.4767527450618"
    },
    {
      "name": "scale/x",
      "format": {
        "type": "csv",
        "parse": {
          "domain": "number"
        }
      },
      "values": "\"domain\"\n-14.085\n311.185"
    },
    {
      "name": "scale/y",
      "format": {
        "type": "csv",
        "parse": {
          "domain": "number"
        }
      },
      "values": "\"domain\"\n0.33\n28.27"
    }
  ],
  "scales": [
    {
      "name": "x",
      "domain": {
        "data": "scale/x",
        "field": "data.domain"
      },
      "zero": false,
      "nice": false,
      "clamp": false,
      "range": "width"
    },
    {
      "name": "y",
      "domain": {
        "data": "scale/y",
        "field": "data.domain"
      },
      "zero": false,
      "nice": false,
      "clamp": false,
      "range": "height"
    }
  ],
  "marks": [
    {
      "type": "symbol",
      "properties": {
        "update": {
          "fill": {
            "value": "#000000"
          },
          "size": {
            "value": 50
          },
          "x": {
            "scale": "x",
            "field": "data.TV"
          },
          "y": {
            "scale": "y",
            "field": "data.sales"
          }
        },
        "ggvis": {
          "data": {
            "value": ".0"
          }
        }
      },
      "from": {
        "data": ".0"
      }
    },
    {
      "type": "line",
      "properties": {
        "update": {
          "stroke": {
            "value": "#000000"
          },
          "strokeWidth": {
            "value": 2
          },
          "x": {
            "scale": "x",
            "field": "data.pred_"
          },
          "y": {
            "scale": "y",
            "field": "data.resp_"
          },
          "fill": {
            "value": "transparent"
          }
        },
        "ggvis": {
          "data": {
            "value": ".0/model_prediction1"
          }
        }
      },
      "from": {
        "data": ".0/model_prediction1"
      }
    },
    {
      "type": "line",
      "properties": {
        "update": {
          "strokeWidth": {
            "value": 2
          },
          "x": {
            "scale": "x",
            "field": "data.pred_"
          },
          "y": {
            "scale": "y",
            "field": "data.resp_"
          },
          "stroke": {
            "value": "blue"
          },
          "fill": {
            "value": "transparent"
          }
        },
        "ggvis": {
          "data": {
            "value": ".0/model_prediction2"
          }
        }
      },
      "from": {
        "data": ".0/model_prediction2"
      }
    },
    {
      "type": "line",
      "properties": {
        "update": {
          "strokeWidth": {
            "value": 2
          },
          "x": {
            "scale": "x",
            "field": "data.pred_"
          },
          "y": {
            "scale": "y",
            "field": "data.resp_"
          },
          "stroke": {
            "value": "red"
          },
          "fill": {
            "value": "transparent"
          }
        },
        "ggvis": {
          "data": {
            "value": ".0/model_prediction3"
          }
        }
      },
      "from": {
        "data": ".0/model_prediction3"
      }
    }
  ],
  "legends": [],
  "axes": [
    {
      "type": "x",
      "scale": "x",
      "orient": "bottom",
      "layer": "back",
      "grid": true,
      "title": "TV"
    },
    {
      "type": "y",
      "scale": "y",
      "orient": "left",
      "layer": "back",
      "grid": true,
      "title": "sales"
    }
  ],
  "padding": null,
  "ggvis_opts": {
    "keep_aspect": false,
    "resizable": true,
    "padding": {},
    "duration": 250,
    "renderer": "svg",
    "hover_duration": 0,
    "width": 480,
    "height": 480
  },
  "handlers": null
};
ggvis.getPlot("plot_id358819767").parseSpec(plot_id358819767_spec);
</script>
</div>
</div>
</section>
<section id="using-plotly" class="level2">
<h2 class="anchored" data-anchor-id="using-plotly">Using <code>plotly</code></h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>p11 <span class="ot">&lt;-</span> <span class="fu">ggplotly</span>(p)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>p11</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-f30d7598595affc4f25a" style="width:100%;height:650px;"></div>
<script type="application/json" data-for="htmlwidget-f30d7598595affc4f25a">{"x":{"data":[{"x":[230.09999999999999,44.5,17.199999999999999,151.5,180.80000000000001,8.6999999999999993,57.5,120.2,8.5999999999999996,199.80000000000001,66.099999999999994,214.69999999999999,23.800000000000001,97.5,204.09999999999999,195.40000000000001,67.799999999999997,281.39999999999998,69.200000000000003,147.30000000000001,218.40000000000001,237.40000000000001,13.199999999999999,228.30000000000001,62.299999999999997,262.89999999999998,142.90000000000001,240.09999999999999,248.80000000000001,70.599999999999994,292.89999999999998,112.90000000000001,97.200000000000003,265.60000000000002,95.700000000000003,290.69999999999999,266.89999999999998,74.700000000000003,43.100000000000001,228,202.5,177,293.60000000000002,206.90000000000001,25.100000000000001,175.09999999999999,89.700000000000003,239.90000000000001,227.19999999999999,66.900000000000006,199.80000000000001,100.40000000000001,216.40000000000001,182.59999999999999,262.69999999999999,198.90000000000001,7.2999999999999998,136.19999999999999,210.80000000000001,210.69999999999999,53.5,261.30000000000001,239.30000000000001,102.7,131.09999999999999,69,31.5,139.30000000000001,237.40000000000001,216.80000000000001,199.09999999999999,109.8,26.800000000000001,129.40000000000001,213.40000000000001,16.899999999999999,27.5,120.5,5.4000000000000004,116,76.400000000000006,239.80000000000001,75.299999999999997,68.400000000000006,213.5,193.19999999999999,76.299999999999997,110.7,88.299999999999997,109.8,134.30000000000001,28.600000000000001,217.69999999999999,250.90000000000001,107.40000000000001,163.30000000000001,197.59999999999999,184.90000000000001,289.69999999999999,135.19999999999999,222.40000000000001,296.39999999999998,280.19999999999999,187.90000000000001,238.19999999999999,137.90000000000001,25,90.400000000000006,13.1,255.40000000000001,225.80000000000001,241.69999999999999,175.69999999999999,209.59999999999999,78.200000000000003,75.099999999999994,139.19999999999999,76.400000000000006,125.7,19.399999999999999,141.30000000000001,18.800000000000001,224,123.09999999999999,229.5,87.200000000000003,7.7999999999999998,80.200000000000003,220.30000000000001,59.600000000000001,0.69999999999999996,265.19999999999999,8.4000000000000004,219.80000000000001,36.899999999999999,48.299999999999997,25.600000000000001,273.69999999999999,43,184.90000000000001,73.400000000000006,193.69999999999999,220.5,104.59999999999999,96.200000000000003,140.30000000000001,240.09999999999999,243.19999999999999,38,44.700000000000003,280.69999999999999,121,197.59999999999999,171.30000000000001,187.80000000000001,4.0999999999999996,93.900000000000006,149.80000000000001,11.699999999999999,131.69999999999999,172.5,85.700000000000003,188.40000000000001,163.5,117.2,234.5,17.899999999999999,206.80000000000001,215.40000000000001,284.30000000000001,50,164.5,19.600000000000001,168.40000000000001,222.40000000000001,276.89999999999998,248.40000000000001,170.19999999999999,276.69999999999999,165.59999999999999,156.59999999999999,218.5,56.200000000000003,287.60000000000002,253.80000000000001,205,139.5,191.09999999999999,286,18.699999999999999,39.5,75.5,17.199999999999999,166.80000000000001,149.69999999999999,38.200000000000003,94.200000000000003,177,283.60000000000002,232.09999999999999],"y":[22.100000000000001,10.4,9.3000000000000007,18.5,12.9,7.2000000000000002,11.800000000000001,13.199999999999999,4.7999999999999998,10.6,8.5999999999999996,17.399999999999999,9.1999999999999993,9.6999999999999993,19,22.399999999999999,12.5,24.399999999999999,11.300000000000001,14.6,18,12.5,5.5999999999999996,15.5,9.6999999999999993,12,15,15.9,18.899999999999999,10.5,21.399999999999999,11.9,9.5999999999999996,17.399999999999999,9.5,12.800000000000001,25.399999999999999,14.699999999999999,10.1,21.5,16.600000000000001,17.100000000000001,20.699999999999999,12.9,8.5,14.9,10.6,23.199999999999999,14.800000000000001,9.6999999999999993,11.4,10.699999999999999,22.600000000000001,21.199999999999999,20.199999999999999,23.699999999999999,5.5,13.199999999999999,23.800000000000001,18.399999999999999,8.0999999999999996,24.199999999999999,15.699999999999999,14,18,9.3000000000000007,9.5,13.4,18.899999999999999,22.300000000000001,18.300000000000001,12.4,8.8000000000000007,11,17,8.6999999999999993,6.9000000000000004,14.199999999999999,5.2999999999999998,11,11.800000000000001,12.300000000000001,11.300000000000001,13.6,21.699999999999999,15.199999999999999,12,16,12.9,16.699999999999999,11.199999999999999,7.2999999999999998,19.399999999999999,22.199999999999999,11.5,16.899999999999999,11.699999999999999,15.5,25.399999999999999,17.199999999999999,11.699999999999999,23.800000000000001,14.800000000000001,14.699999999999999,20.699999999999999,19.199999999999999,7.2000000000000002,8.6999999999999993,5.2999999999999998,19.800000000000001,13.4,21.800000000000001,14.1,15.9,14.6,12.6,12.199999999999999,9.4000000000000004,15.9,6.5999999999999996,15.5,7,11.6,15.199999999999999,19.699999999999999,10.6,6.5999999999999996,8.8000000000000007,24.699999999999999,9.6999999999999993,1.6000000000000001,12.699999999999999,5.7000000000000002,19.600000000000001,10.800000000000001,11.6,9.5,20.800000000000001,9.5999999999999996,20.699999999999999,10.9,19.199999999999999,20.100000000000001,10.4,11.4,10.300000000000001,13.199999999999999,25.399999999999999,10.9,10.1,16.100000000000001,11.6,16.600000000000001,19,15.6,3.2000000000000002,15.300000000000001,10.1,7.2999999999999998,12.9,14.4,13.300000000000001,14.9,18,11.9,11.9,8,12.199999999999999,17.100000000000001,15,8.4000000000000004,14.5,7.5999999999999996,11.699999999999999,11.5,27,20.199999999999999,11.699999999999999,11.800000000000001,12.6,10.5,12.199999999999999,8.6999999999999993,26.199999999999999,17.600000000000001,22.600000000000001,10.300000000000001,17.300000000000001,15.9,6.7000000000000002,10.800000000000001,9.9000000000000004,5.9000000000000004,19.600000000000001,17.300000000000001,7.5999999999999996,9.6999999999999993,12.800000000000001,25.5,13.4],"text":["TV: 230.1<br />sales: 22.1","TV:  44.5<br />sales: 10.4","TV:  17.2<br />sales:  9.3","TV: 151.5<br />sales: 18.5","TV: 180.8<br />sales: 12.9","TV:   8.7<br />sales:  7.2","TV:  57.5<br />sales: 11.8","TV: 120.2<br />sales: 13.2","TV:   8.6<br />sales:  4.8","TV: 199.8<br />sales: 10.6","TV:  66.1<br />sales:  8.6","TV: 214.7<br />sales: 17.4","TV:  23.8<br />sales:  9.2","TV:  97.5<br />sales:  9.7","TV: 204.1<br />sales: 19.0","TV: 195.4<br />sales: 22.4","TV:  67.8<br />sales: 12.5","TV: 281.4<br />sales: 24.4","TV:  69.2<br />sales: 11.3","TV: 147.3<br />sales: 14.6","TV: 218.4<br />sales: 18.0","TV: 237.4<br />sales: 12.5","TV:  13.2<br />sales:  5.6","TV: 228.3<br />sales: 15.5","TV:  62.3<br />sales:  9.7","TV: 262.9<br />sales: 12.0","TV: 142.9<br />sales: 15.0","TV: 240.1<br />sales: 15.9","TV: 248.8<br />sales: 18.9","TV:  70.6<br />sales: 10.5","TV: 292.9<br />sales: 21.4","TV: 112.9<br />sales: 11.9","TV:  97.2<br />sales:  9.6","TV: 265.6<br />sales: 17.4","TV:  95.7<br />sales:  9.5","TV: 290.7<br />sales: 12.8","TV: 266.9<br />sales: 25.4","TV:  74.7<br />sales: 14.7","TV:  43.1<br />sales: 10.1","TV: 228.0<br />sales: 21.5","TV: 202.5<br />sales: 16.6","TV: 177.0<br />sales: 17.1","TV: 293.6<br />sales: 20.7","TV: 206.9<br />sales: 12.9","TV:  25.1<br />sales:  8.5","TV: 175.1<br />sales: 14.9","TV:  89.7<br />sales: 10.6","TV: 239.9<br />sales: 23.2","TV: 227.2<br />sales: 14.8","TV:  66.9<br />sales:  9.7","TV: 199.8<br />sales: 11.4","TV: 100.4<br />sales: 10.7","TV: 216.4<br />sales: 22.6","TV: 182.6<br />sales: 21.2","TV: 262.7<br />sales: 20.2","TV: 198.9<br />sales: 23.7","TV:   7.3<br />sales:  5.5","TV: 136.2<br />sales: 13.2","TV: 210.8<br />sales: 23.8","TV: 210.7<br />sales: 18.4","TV:  53.5<br />sales:  8.1","TV: 261.3<br />sales: 24.2","TV: 239.3<br />sales: 15.7","TV: 102.7<br />sales: 14.0","TV: 131.1<br />sales: 18.0","TV:  69.0<br />sales:  9.3","TV:  31.5<br />sales:  9.5","TV: 139.3<br />sales: 13.4","TV: 237.4<br />sales: 18.9","TV: 216.8<br />sales: 22.3","TV: 199.1<br />sales: 18.3","TV: 109.8<br />sales: 12.4","TV:  26.8<br />sales:  8.8","TV: 129.4<br />sales: 11.0","TV: 213.4<br />sales: 17.0","TV:  16.9<br />sales:  8.7","TV:  27.5<br />sales:  6.9","TV: 120.5<br />sales: 14.2","TV:   5.4<br />sales:  5.3","TV: 116.0<br />sales: 11.0","TV:  76.4<br />sales: 11.8","TV: 239.8<br />sales: 12.3","TV:  75.3<br />sales: 11.3","TV:  68.4<br />sales: 13.6","TV: 213.5<br />sales: 21.7","TV: 193.2<br />sales: 15.2","TV:  76.3<br />sales: 12.0","TV: 110.7<br />sales: 16.0","TV:  88.3<br />sales: 12.9","TV: 109.8<br />sales: 16.7","TV: 134.3<br />sales: 11.2","TV:  28.6<br />sales:  7.3","TV: 217.7<br />sales: 19.4","TV: 250.9<br />sales: 22.2","TV: 107.4<br />sales: 11.5","TV: 163.3<br />sales: 16.9","TV: 197.6<br />sales: 11.7","TV: 184.9<br />sales: 15.5","TV: 289.7<br />sales: 25.4","TV: 135.2<br />sales: 17.2","TV: 222.4<br />sales: 11.7","TV: 296.4<br />sales: 23.8","TV: 280.2<br />sales: 14.8","TV: 187.9<br />sales: 14.7","TV: 238.2<br />sales: 20.7","TV: 137.9<br />sales: 19.2","TV:  25.0<br />sales:  7.2","TV:  90.4<br />sales:  8.7","TV:  13.1<br />sales:  5.3","TV: 255.4<br />sales: 19.8","TV: 225.8<br />sales: 13.4","TV: 241.7<br />sales: 21.8","TV: 175.7<br />sales: 14.1","TV: 209.6<br />sales: 15.9","TV:  78.2<br />sales: 14.6","TV:  75.1<br />sales: 12.6","TV: 139.2<br />sales: 12.2","TV:  76.4<br />sales:  9.4","TV: 125.7<br />sales: 15.9","TV:  19.4<br />sales:  6.6","TV: 141.3<br />sales: 15.5","TV:  18.8<br />sales:  7.0","TV: 224.0<br />sales: 11.6","TV: 123.1<br />sales: 15.2","TV: 229.5<br />sales: 19.7","TV:  87.2<br />sales: 10.6","TV:   7.8<br />sales:  6.6","TV:  80.2<br />sales:  8.8","TV: 220.3<br />sales: 24.7","TV:  59.6<br />sales:  9.7","TV:   0.7<br />sales:  1.6","TV: 265.2<br />sales: 12.7","TV:   8.4<br />sales:  5.7","TV: 219.8<br />sales: 19.6","TV:  36.9<br />sales: 10.8","TV:  48.3<br />sales: 11.6","TV:  25.6<br />sales:  9.5","TV: 273.7<br />sales: 20.8","TV:  43.0<br />sales:  9.6","TV: 184.9<br />sales: 20.7","TV:  73.4<br />sales: 10.9","TV: 193.7<br />sales: 19.2","TV: 220.5<br />sales: 20.1","TV: 104.6<br />sales: 10.4","TV:  96.2<br />sales: 11.4","TV: 140.3<br />sales: 10.3","TV: 240.1<br />sales: 13.2","TV: 243.2<br />sales: 25.4","TV:  38.0<br />sales: 10.9","TV:  44.7<br />sales: 10.1","TV: 280.7<br />sales: 16.1","TV: 121.0<br />sales: 11.6","TV: 197.6<br />sales: 16.6","TV: 171.3<br />sales: 19.0","TV: 187.8<br />sales: 15.6","TV:   4.1<br />sales:  3.2","TV:  93.9<br />sales: 15.3","TV: 149.8<br />sales: 10.1","TV:  11.7<br />sales:  7.3","TV: 131.7<br />sales: 12.9","TV: 172.5<br />sales: 14.4","TV:  85.7<br />sales: 13.3","TV: 188.4<br />sales: 14.9","TV: 163.5<br />sales: 18.0","TV: 117.2<br />sales: 11.9","TV: 234.5<br />sales: 11.9","TV:  17.9<br />sales:  8.0","TV: 206.8<br />sales: 12.2","TV: 215.4<br />sales: 17.1","TV: 284.3<br />sales: 15.0","TV:  50.0<br />sales:  8.4","TV: 164.5<br />sales: 14.5","TV:  19.6<br />sales:  7.6","TV: 168.4<br />sales: 11.7","TV: 222.4<br />sales: 11.5","TV: 276.9<br />sales: 27.0","TV: 248.4<br />sales: 20.2","TV: 170.2<br />sales: 11.7","TV: 276.7<br />sales: 11.8","TV: 165.6<br />sales: 12.6","TV: 156.6<br />sales: 10.5","TV: 218.5<br />sales: 12.2","TV:  56.2<br />sales:  8.7","TV: 287.6<br />sales: 26.2","TV: 253.8<br />sales: 17.6","TV: 205.0<br />sales: 22.6","TV: 139.5<br />sales: 10.3","TV: 191.1<br />sales: 17.3","TV: 286.0<br />sales: 15.9","TV:  18.7<br />sales:  6.7","TV:  39.5<br />sales: 10.8","TV:  75.5<br />sales:  9.9","TV:  17.2<br />sales:  5.9","TV: 166.8<br />sales: 19.6","TV: 149.7<br />sales: 17.3","TV:  38.2<br />sales:  7.6","TV:  94.2<br />sales:  9.7","TV: 177.0<br />sales: 12.8","TV: 283.6<br />sales: 25.5","TV: 232.1<br />sales: 13.4"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(173,216,230,1)","opacity":1,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(173,216,230,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.69999999999999996,4.443037974683544,8.1860759493670887,11.929113924050633,15.672151898734176,19.41518987341772,23.158227848101266,26.901265822784808,30.644303797468353,34.387341772151899,38.130379746835445,41.87341772151899,45.616455696202536,49.359493670886081,53.10253164556962,56.845569620253166,60.588607594936711,64.33164556962025,68.074683544303795,71.817721518987341,75.560759493670886,79.303797468354432,83.046835443037978,86.789873417721523,90.532911392405069,94.275949367088614,98.01898734177216,101.76202531645569,105.50506329113924,109.24810126582278,112.99113924050633,116.73417721518987,120.47721518987342,124.22025316455696,127.96329113924051,131.70632911392403,135.44936708860757,139.19240506329112,142.93544303797466,146.67848101265821,150.42151898734176,154.1645569620253,157.90759493670885,161.65063291139239,165.39367088607594,169.13670886075948,172.87974683544303,176.62278481012657,180.36582278481012,184.10886075949367,187.85189873417721,191.59493670886076,195.3379746835443,199.08101265822785,202.82405063291137,206.56708860759491,210.31012658227846,214.053164556962,217.79620253164555,221.53924050632909,225.28227848101264,229.02531645569618,232.76835443037973,236.51139240506328,240.25443037974682,243.99746835443037,247.74050632911391,251.48354430379746,255.226582278481,258.96962025316452,262.71265822784807,266.45569620253161,270.19873417721516,273.9417721518987,277.68481012658225,281.42784810126579,285.17088607594934,288.91392405063289,292.65696202531643,296.39999999999998],"y":[7.0658691974308123,7.2438006477604819,7.4217320980901524,7.5996635484198229,7.7775949987494926,7.9555264490791631,8.1334578994088336,8.3113893497385032,8.4893208000681728,8.6672522503978442,8.8451837007275138,9.0231151510571834,9.201046601386853,9.3789780517165244,9.556909502046194,9.7348409523758637,9.9127724027055351,10.090703853035205,10.268635303364874,10.446566753694544,10.624498204024215,10.802429654353885,10.980361104683555,11.158292555013226,11.336224005342896,11.514155455672565,11.692086906002235,11.870018356331904,12.047949806661576,12.225881256991245,12.403812707320917,12.581744157650586,12.759675607980256,12.937607058309926,13.115538508639597,13.293469958969265,13.471401409298934,13.649332859628606,13.827264309958277,14.005195760287947,14.183127210617616,14.361058660947286,14.538990111276956,14.716921561606627,14.894853011936299,15.072784462265968,15.250715912595638,15.428647362925307,15.606578813254979,15.784510263584648,15.962441713914318,16.140373164243989,16.318304614573659,16.496236064903329,16.674167515232998,16.852098965562668,17.030030415892337,17.207961866222007,17.38589331655168,17.563824766881346,17.741756217211019,17.919687667540689,18.097619117870359,18.275550568200032,18.453482018529698,18.631413468859371,18.809344919189041,18.98727636951871,19.16520781984838,19.34313927017805,19.521070720507719,19.699002170837389,19.876933621167062,20.054865071496728,20.232796521826401,20.410727972156071,20.58865942248574,20.76659087281541,20.94452232314508,21.122453773474753],"text":["TV:   0.700000<br />sales:  7.065869","TV:   4.443038<br />sales:  7.243801","TV:   8.186076<br />sales:  7.421732","TV:  11.929114<br />sales:  7.599664","TV:  15.672152<br />sales:  7.777595","TV:  19.415190<br />sales:  7.955526","TV:  23.158228<br />sales:  8.133458","TV:  26.901266<br />sales:  8.311389","TV:  30.644304<br />sales:  8.489321","TV:  34.387342<br />sales:  8.667252","TV:  38.130380<br />sales:  8.845184","TV:  41.873418<br />sales:  9.023115","TV:  45.616456<br />sales:  9.201047","TV:  49.359494<br />sales:  9.378978","TV:  53.102532<br />sales:  9.556910","TV:  56.845570<br />sales:  9.734841","TV:  60.588608<br />sales:  9.912772","TV:  64.331646<br />sales: 10.090704","TV:  68.074684<br />sales: 10.268635","TV:  71.817722<br />sales: 10.446567","TV:  75.560759<br />sales: 10.624498","TV:  79.303797<br />sales: 10.802430","TV:  83.046835<br />sales: 10.980361","TV:  86.789873<br />sales: 11.158293","TV:  90.532911<br />sales: 11.336224","TV:  94.275949<br />sales: 11.514155","TV:  98.018987<br />sales: 11.692087","TV: 101.762025<br />sales: 11.870018","TV: 105.505063<br />sales: 12.047950","TV: 109.248101<br />sales: 12.225881","TV: 112.991139<br />sales: 12.403813","TV: 116.734177<br />sales: 12.581744","TV: 120.477215<br />sales: 12.759676","TV: 124.220253<br />sales: 12.937607","TV: 127.963291<br />sales: 13.115539","TV: 131.706329<br />sales: 13.293470","TV: 135.449367<br />sales: 13.471401","TV: 139.192405<br />sales: 13.649333","TV: 142.935443<br />sales: 13.827264","TV: 146.678481<br />sales: 14.005196","TV: 150.421519<br />sales: 14.183127","TV: 154.164557<br />sales: 14.361059","TV: 157.907595<br />sales: 14.538990","TV: 161.650633<br />sales: 14.716922","TV: 165.393671<br />sales: 14.894853","TV: 169.136709<br />sales: 15.072784","TV: 172.879747<br />sales: 15.250716","TV: 176.622785<br />sales: 15.428647","TV: 180.365823<br />sales: 15.606579","TV: 184.108861<br />sales: 15.784510","TV: 187.851899<br />sales: 15.962442","TV: 191.594937<br />sales: 16.140373","TV: 195.337975<br />sales: 16.318305","TV: 199.081013<br />sales: 16.496236","TV: 202.824051<br />sales: 16.674168","TV: 206.567089<br />sales: 16.852099","TV: 210.310127<br />sales: 17.030030","TV: 214.053165<br />sales: 17.207962","TV: 217.796203<br />sales: 17.385893","TV: 221.539241<br />sales: 17.563825","TV: 225.282278<br />sales: 17.741756","TV: 229.025316<br />sales: 17.919688","TV: 232.768354<br />sales: 18.097619","TV: 236.511392<br />sales: 18.275551","TV: 240.254430<br />sales: 18.453482","TV: 243.997468<br />sales: 18.631413","TV: 247.740506<br />sales: 18.809345","TV: 251.483544<br />sales: 18.987276","TV: 255.226582<br />sales: 19.165208","TV: 258.969620<br />sales: 19.343139","TV: 262.712658<br />sales: 19.521071","TV: 266.455696<br />sales: 19.699002","TV: 270.198734<br />sales: 19.876934","TV: 273.941772<br />sales: 20.054865","TV: 277.684810<br />sales: 20.232797","TV: 281.427848<br />sales: 20.410728","TV: 285.170886<br />sales: 20.588659","TV: 288.913924<br />sales: 20.766591","TV: 292.656962<br />sales: 20.944522","TV: 296.400000<br />sales: 21.122454"],"type":"scatter","mode":"lines","name":"fitted values","line":{"width":3.7795275590551185,"color":"rgba(0,0,255,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.69999999999999996,4.443037974683544,8.1860759493670887,11.929113924050633,15.672151898734176,19.41518987341772,23.158227848101266,26.901265822784808,30.644303797468353,34.387341772151899,38.130379746835445,41.87341772151899,45.616455696202536,49.359493670886081,53.10253164556962,56.845569620253166,60.588607594936711,64.33164556962025,68.074683544303795,71.817721518987341,75.560759493670886,79.303797468354432,83.046835443037978,86.789873417721523,90.532911392405069,94.275949367088614,98.01898734177216,101.76202531645569,105.50506329113924,109.24810126582278,112.99113924050633,116.73417721518987,120.47721518987342,124.22025316455696,127.96329113924051,131.70632911392403,135.44936708860757,139.19240506329112,142.93544303797466,146.67848101265821,150.42151898734176,154.1645569620253,157.90759493670885,161.65063291139239,165.39367088607594,169.13670886075948,172.87974683544303,176.62278481012657,180.36582278481012,184.10886075949367,187.85189873417721,191.59493670886076,195.3379746835443,199.08101265822785,202.82405063291137,206.56708860759491,210.31012658227846,214.053164556962,217.79620253164555,221.53924050632909,225.28227848101264,229.02531645569618,232.76835443037973,236.51139240506328,240.25443037974682,243.99746835443037,247.74050632911391,251.48354430379746,255.226582278481,258.96962025316452,262.71265822784807,266.45569620253161,270.19873417721516,273.9417721518987,277.68481012658225,281.42784810126579,285.17088607594934,288.91392405063289,292.65696202531643,296.39999999999998],"y":[5.5173135864315759,5.8645911489540978,6.2060176681024188,6.5409954011388578,6.8689266053257292,7.1892135379253528,7.5012584562000466,7.804463617412126,8.0986771988888506,8.3846480004330743,8.66275580278697,8.9333683352129434,9.1968533269734003,9.4535785073307501,9.7039116055474004,9.948220350885757,10.186872472608226,10.420235699977214,10.648677762255133,10.872566388704385,11.089427759365838,11.288228635732617,11.470825784481335,11.640692186012584,11.80130082072697,11.956124669025083,12.108636711307522,12.262309927974883,12.420617299427763,12.587031806066756,12.761786386902495,12.940321748438068,13.121739418630218,13.305222292705368,13.48995326588995,13.675115233410375,13.859891090493083,14.043463732364486,14.225016054251018,14.403730951379096,14.578872227275589,14.752588615455711,14.925898272872573,15.098451198074212,15.269897389608644,15.439886846023899,15.608069565868011,15.774095547688997,15.937614790034891,16.098277291453716,16.255733050493504,16.409632065702272,16.558987775036353,16.70167017617705,16.83962548152272,16.975242615011513,17.110910500581589,17.249018062171089,17.391954223718155,17.539002210639001,17.685230806278703,17.830734768708439,17.975762787079507,18.120563550543189,18.265385748250779,18.410478069353569,18.556089203002845,18.7022985204439,18.848878368647394,18.995792573424019,19.143011264375357,19.290504571103007,19.438242623208545,19.586195550293567,19.734333481959659,19.88262654780841,20.031044877441403,20.179558600460236,20.328137846466486,20.476752745061752],"text":["TV:   0.700000<br />sales:  5.517314","TV:   4.443038<br />sales:  5.864591","TV:   8.186076<br />sales:  6.206018","TV:  11.929114<br />sales:  6.540995","TV:  15.672152<br />sales:  6.868927","TV:  19.415190<br />sales:  7.189214","TV:  23.158228<br />sales:  7.501258","TV:  26.901266<br />sales:  7.804464","TV:  30.644304<br />sales:  8.098677","TV:  34.387342<br />sales:  8.384648","TV:  38.130380<br />sales:  8.662756","TV:  41.873418<br />sales:  8.933368","TV:  45.616456<br />sales:  9.196853","TV:  49.359494<br />sales:  9.453579","TV:  53.102532<br />sales:  9.703912","TV:  56.845570<br />sales:  9.948220","TV:  60.588608<br />sales: 10.186872","TV:  64.331646<br />sales: 10.420236","TV:  68.074684<br />sales: 10.648678","TV:  71.817722<br />sales: 10.872566","TV:  75.560759<br />sales: 11.089428","TV:  79.303797<br />sales: 11.288229","TV:  83.046835<br />sales: 11.470826","TV:  86.789873<br />sales: 11.640692","TV:  90.532911<br />sales: 11.801301","TV:  94.275949<br />sales: 11.956125","TV:  98.018987<br />sales: 12.108637","TV: 101.762025<br />sales: 12.262310","TV: 105.505063<br />sales: 12.420617","TV: 109.248101<br />sales: 12.587032","TV: 112.991139<br />sales: 12.761786","TV: 116.734177<br />sales: 12.940322","TV: 120.477215<br />sales: 13.121739","TV: 124.220253<br />sales: 13.305222","TV: 127.963291<br />sales: 13.489953","TV: 131.706329<br />sales: 13.675115","TV: 135.449367<br />sales: 13.859891","TV: 139.192405<br />sales: 14.043464","TV: 142.935443<br />sales: 14.225016","TV: 146.678481<br />sales: 14.403731","TV: 150.421519<br />sales: 14.578872","TV: 154.164557<br />sales: 14.752589","TV: 157.907595<br />sales: 14.925898","TV: 161.650633<br />sales: 15.098451","TV: 165.393671<br />sales: 15.269897","TV: 169.136709<br />sales: 15.439887","TV: 172.879747<br />sales: 15.608070","TV: 176.622785<br />sales: 15.774096","TV: 180.365823<br />sales: 15.937615","TV: 184.108861<br />sales: 16.098277","TV: 187.851899<br />sales: 16.255733","TV: 191.594937<br />sales: 16.409632","TV: 195.337975<br />sales: 16.558988","TV: 199.081013<br />sales: 16.701670","TV: 202.824051<br />sales: 16.839625","TV: 206.567089<br />sales: 16.975243","TV: 210.310127<br />sales: 17.110911","TV: 214.053165<br />sales: 17.249018","TV: 217.796203<br />sales: 17.391954","TV: 221.539241<br />sales: 17.539002","TV: 225.282278<br />sales: 17.685231","TV: 229.025316<br />sales: 17.830735","TV: 232.768354<br />sales: 17.975763","TV: 236.511392<br />sales: 18.120564","TV: 240.254430<br />sales: 18.265386","TV: 243.997468<br />sales: 18.410478","TV: 247.740506<br />sales: 18.556089","TV: 251.483544<br />sales: 18.702299","TV: 255.226582<br />sales: 18.848878","TV: 258.969620<br />sales: 18.995793","TV: 262.712658<br />sales: 19.143011","TV: 266.455696<br />sales: 19.290505","TV: 270.198734<br />sales: 19.438243","TV: 273.941772<br />sales: 19.586196","TV: 277.684810<br />sales: 19.734333","TV: 281.427848<br />sales: 19.882627","TV: 285.170886<br />sales: 20.031045","TV: 288.913924<br />sales: 20.179559","TV: 292.656962<br />sales: 20.328138","TV: 296.400000<br />sales: 20.476753"],"type":"scatter","mode":"lines","name":"fitted values","line":{"width":3.7795275590551185,"color":"rgba(255,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.69999999999999996,4.443037974683544,8.1860759493670887,11.929113924050633,15.672151898734176,19.41518987341772,23.158227848101266,26.901265822784808,30.644303797468353,34.387341772151899,38.130379746835445,41.87341772151899,45.616455696202536,49.359493670886081,53.10253164556962,56.845569620253166,60.588607594936711,64.33164556962025,68.074683544303795,71.817721518987341,75.560759493670886,79.303797468354432,83.046835443037978,86.789873417721523,90.532911392405069,94.275949367088614,98.01898734177216,101.76202531645569,105.50506329113924,109.24810126582278,112.99113924050633,116.73417721518987,120.47721518987342,124.22025316455696,127.96329113924051,131.70632911392403,135.44936708860757,139.19240506329112,142.93544303797466,146.67848101265821,150.42151898734176,154.1645569620253,157.90759493670885,161.65063291139239,165.39367088607594,169.13670886075948,172.87974683544303,176.62278481012657,180.36582278481012,184.10886075949367,187.85189873417721,191.59493670886076,195.3379746835443,199.08101265822785,202.82405063291137,206.56708860759491,210.31012658227846,214.053164556962,217.79620253164555,221.53924050632909,225.28227848101264,229.02531645569618,232.76835443037973,236.51139240506328,240.25443037974682,243.99746835443037,247.74050632911391,251.48354430379746,255.226582278481,258.96962025316452,262.71265822784807,266.45569620253161,270.19873417721516,273.9417721518987,277.68481012658225,281.42784810126579,285.17088607594934,288.91392405063289,292.65696202531643,296.39999999999998],"y":[6.9186959663197225,7.1024988103251046,7.2863016543304866,7.4701044983358686,7.6539073423412507,7.8377101863466327,8.0215130303520148,8.2053158743573977,8.3891187183627789,8.5729215623681618,8.756724406373543,8.9405272503789259,9.1243300943843089,9.30813293838969,9.491935782395073,9.6757386264004541,9.8595414704058371,10.043344314411218,10.227147158416601,10.410950002421984,10.594752846427365,10.778555690432748,10.962358534438131,11.146161378443512,11.329964222448893,11.513767066454276,11.697569910459659,11.88137275446504,12.065175598470422,12.248978442475805,12.432781286481188,12.616584130486569,12.800386974491952,12.984189818497335,13.167992662502716,13.351795506508097,13.535598350513478,13.719401194518861,13.903204038524244,14.087006882529625,14.270809726535008,14.454612570540391,14.638415414545772,14.822218258551153,15.006021102556536,15.189823946561919,15.3736267905673,15.557429634572683,15.741232478578066,15.925035322583447,16.108838166588832,16.29264101059421,16.476443854599594,16.660246698604979,16.844049542610357,17.027852386615741,17.211655230621123,17.395458074626504,17.579260918631888,17.763063762637266,17.946866606642651,18.130669450648035,18.314472294653413,18.498275138658798,18.682077982664179,18.86588082666956,19.049683670674945,19.233486514680326,19.417289358685707,19.601092202691092,19.784895046696469,19.968697890701854,20.152500734707235,20.336303578712617,20.520106422718001,20.703909266723382,20.887712110728764,21.071514954734148,21.255317798739529,21.439120642744911],"text":["TV:   0.700000<br />sales:  6.918696","TV:   4.443038<br />sales:  7.102499","TV:   8.186076<br />sales:  7.286302","TV:  11.929114<br />sales:  7.470104","TV:  15.672152<br />sales:  7.653907","TV:  19.415190<br />sales:  7.837710","TV:  23.158228<br />sales:  8.021513","TV:  26.901266<br />sales:  8.205316","TV:  30.644304<br />sales:  8.389119","TV:  34.387342<br />sales:  8.572922","TV:  38.130380<br />sales:  8.756724","TV:  41.873418<br />sales:  8.940527","TV:  45.616456<br />sales:  9.124330","TV:  49.359494<br />sales:  9.308133","TV:  53.102532<br />sales:  9.491936","TV:  56.845570<br />sales:  9.675739","TV:  60.588608<br />sales:  9.859541","TV:  64.331646<br />sales: 10.043344","TV:  68.074684<br />sales: 10.227147","TV:  71.817722<br />sales: 10.410950","TV:  75.560759<br />sales: 10.594753","TV:  79.303797<br />sales: 10.778556","TV:  83.046835<br />sales: 10.962359","TV:  86.789873<br />sales: 11.146161","TV:  90.532911<br />sales: 11.329964","TV:  94.275949<br />sales: 11.513767","TV:  98.018987<br />sales: 11.697570","TV: 101.762025<br />sales: 11.881373","TV: 105.505063<br />sales: 12.065176","TV: 109.248101<br />sales: 12.248978","TV: 112.991139<br />sales: 12.432781","TV: 116.734177<br />sales: 12.616584","TV: 120.477215<br />sales: 12.800387","TV: 124.220253<br />sales: 12.984190","TV: 127.963291<br />sales: 13.167993","TV: 131.706329<br />sales: 13.351796","TV: 135.449367<br />sales: 13.535598","TV: 139.192405<br />sales: 13.719401","TV: 142.935443<br />sales: 13.903204","TV: 146.678481<br />sales: 14.087007","TV: 150.421519<br />sales: 14.270810","TV: 154.164557<br />sales: 14.454613","TV: 157.907595<br />sales: 14.638415","TV: 161.650633<br />sales: 14.822218","TV: 165.393671<br />sales: 15.006021","TV: 169.136709<br />sales: 15.189824","TV: 172.879747<br />sales: 15.373627","TV: 176.622785<br />sales: 15.557430","TV: 180.365823<br />sales: 15.741232","TV: 184.108861<br />sales: 15.925035","TV: 187.851899<br />sales: 16.108838","TV: 191.594937<br />sales: 16.292641","TV: 195.337975<br />sales: 16.476444","TV: 199.081013<br />sales: 16.660247","TV: 202.824051<br />sales: 16.844050","TV: 206.567089<br />sales: 17.027852","TV: 210.310127<br />sales: 17.211655","TV: 214.053165<br />sales: 17.395458","TV: 217.796203<br />sales: 17.579261","TV: 221.539241<br />sales: 17.763064","TV: 225.282278<br />sales: 17.946867","TV: 229.025316<br />sales: 18.130669","TV: 232.768354<br />sales: 18.314472","TV: 236.511392<br />sales: 18.498275","TV: 240.254430<br />sales: 18.682078","TV: 243.997468<br />sales: 18.865881","TV: 247.740506<br />sales: 19.049684","TV: 251.483544<br />sales: 19.233487","TV: 255.226582<br />sales: 19.417289","TV: 258.969620<br />sales: 19.601092","TV: 262.712658<br />sales: 19.784895","TV: 266.455696<br />sales: 19.968698","TV: 270.198734<br />sales: 20.152501","TV: 273.941772<br />sales: 20.336304","TV: 277.684810<br />sales: 20.520106","TV: 281.427848<br />sales: 20.703909","TV: 285.170886<br />sales: 20.887712","TV: 288.913924<br />sales: 21.071515","TV: 292.656962<br />sales: 21.255318","TV: 296.400000<br />sales: 21.439121"],"type":"scatter","mode":"lines","name":"fitted values","line":{"width":3.7795275590551185,"color":"rgba(160,32,240,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":23.305936073059364,"r":7.3059360730593621,"b":37.260273972602747,"l":37.260273972602747},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-14.085000000000001,311.185],"tickmode":"array","ticktext":["0","100","200","300"],"tickvals":[0,100.00000000000003,200,300],"categoryorder":"array","categoryarray":["0","100","200","300"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"TV","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.33000000000000007,28.27],"tickmode":"array","ticktext":["10","20"],"tickvals":[10,20],"categoryorder":"array","categoryarray":["10","20"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"sales","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(51,51,51,1)","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"ad2b679745128":{"x":{},"y":{},"type":"scatter"},"ad2b63bc4c8c2":{"x":{},"y":{}},"ad2b61ec2bc67":{"x":{},"y":{}},"ad2b679426504":{"x":{},"y":{}}},"cur_data":"ad2b679745128","visdat":{"ad2b679745128":["function (y) ","x"],"ad2b63bc4c8c2":["function (y) ","x"],"ad2b61ec2bc67":["function (y) ","x"],"ad2b679426504":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="scatterplot-matrices" class="level2">
<h2 class="anchored" data-anchor-id="scatterplot-matrices">Scatterplot Matrices</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">scatterplotMatrix</span>(<span class="sc">~</span> sales <span class="sc">+</span> TV <span class="sc">+</span> radio <span class="sc">+</span> newspaper, <span class="at">data =</span> AD)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="MiscRegression_files/figure-html/SPM-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="basic-regression" class="level1">
<h1>Basic Regression</h1>
<p>Recall <code>mod1</code></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(sales <span class="sc">~</span> TV, <span class="at">data =</span> AD)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = sales ~ TV, data = AD)

Residuals:
    Min      1Q  Median      3Q     Max 
-8.3860 -1.9545 -0.1913  2.0671  7.2124 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 7.032594   0.457843   15.36   &lt;2e-16 ***
TV          0.047537   0.002691   17.67   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.259 on 198 degrees of freedom
Multiple R-squared:  0.6119,    Adjusted R-squared:  0.6099 
F-statistic: 312.1 on 1 and 198 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p><span id="eq-residual"><span class="math display">\[\text{Residual}\equiv e_i = y_i - \hat{y_i} \tag{1}\]</span></span></p>
<p>To obtain the residuals for <code>mod1</code> use the function <code>resid</code> on a linear model object which uses the definition in <a href="#eq-residual">Equation&nbsp;1</a>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>eis <span class="ot">&lt;-</span> <span class="fu">resid</span>(mod1)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>RSS <span class="ot">&lt;-</span> <span class="fu">sum</span>(eis<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>RSS</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2102.531</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>RSE <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(RSS<span class="sc">/</span>(<span class="fu">dim</span>(AD)[<span class="dv">1</span>]<span class="sc">-</span><span class="dv">2</span>))</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>RSE</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.258656</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Or</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod1)<span class="sc">$</span>sigma</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.258656</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Or</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>NDF <span class="ot">&lt;-</span> <span class="fu">augment</span>(mod1)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(NDF<span class="sc">$</span>.resid<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2102.531</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>RSE <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>(NDF<span class="sc">$</span>.resid<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">df.residual</span>(mod1))</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>RSE</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.258656</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(moderndive)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">get_regression_table</span>(mod1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2  7
  term      estimate std_error statistic p_value lower_ci upper_ci
  &lt;chr&gt;        &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
1 intercept    7.03      0.458      15.4       0    6.13     7.94 
2 TV           0.048     0.003      17.7       0    0.042    0.053</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>MDDF <span class="ot">&lt;-</span> <span class="fu">get_regression_points</span>(mod1)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>MDDF</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 200  5
      ID sales    TV sales_hat residual
   &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
 1     1  22.1 230.      18.0     4.13 
 2     2  10.4  44.5      9.15    1.25 
 3     3   9.3  17.2      7.85    1.45 
 4     4  18.5 152.      14.2     4.27 
 5     5  12.9 181.      15.6    -2.73 
 6     6   7.2   8.7      7.45   -0.246
 7     7  11.8  57.5      9.77    2.03 
 8     8  13.2 120.      12.7     0.454
 9     9   4.8   8.6      7.44   -2.64 
10    10  10.6 200.      16.5    -5.93 
#  190 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>MDDF <span class="sc">%&gt;%</span> </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">RSS =</span> <span class="fu">sum</span>(residual<span class="sc">^</span><span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1  1
    RSS
  &lt;dbl&gt;
1 2102.</code></pre>
</div>
</div>
<p>The least squares estimators of <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> are given in <a href="#eq-b0">Equation&nbsp;2</a> and <a href="#eq-b1">Equation&nbsp;3</a>, respectively.</p>
<p><span id="eq-b0"><span class="math display">\[b_0 = \hat{\beta_0} = \bar{y} - b_1\bar{x} \tag{2}\]</span></span> <span id="eq-b1"><span class="math display">\[b_1 = \hat{\beta_1} = \frac{\sum_{i = 1}^n(x_i - \bar{x})(y_i - \bar{y})}{\sum_{i=1}^n(x_i-\bar{x})^2} \tag{3}\]</span></span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> AD<span class="sc">$</span>sales</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> AD<span class="sc">$</span>TV</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="fu">sum</span>( (x <span class="sc">-</span> <span class="fu">mean</span>(x))<span class="sc">*</span>(y <span class="sc">-</span> <span class="fu">mean</span>(y)) ) <span class="sc">/</span> <span class="fu">sum</span>((x <span class="sc">-</span> <span class="fu">mean</span>(x))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>b0 <span class="ot">&lt;-</span> <span class="fu">mean</span>(y) <span class="sc">-</span> b1<span class="sc">*</span><span class="fu">mean</span>(x)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(b0, b1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7.03259355 0.04753664</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Design Matrix</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">model.matrix</span>(mod1) <span class="ot">-&gt;</span> X</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(X)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  (Intercept)    TV
1           1 230.1
2           1  44.5
3           1  17.2
4           1 151.5
5           1 180.8
6           1   8.7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>(X)<span class="sc">%*%</span>X <span class="ot">-&gt;</span> XTX <span class="co"># p*n times n*p = p*p</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>XTX</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            (Intercept)        TV
(Intercept)       200.0   29408.5
TV              29408.5 5791118.4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>XTXI <span class="ot">&lt;-</span> <span class="fu">solve</span>(XTX)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>XTXI</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              (Intercept)            TV
(Intercept)  0.0197403984 -1.002458e-04
TV          -0.0001002458  6.817474e-07</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>betahat <span class="ot">&lt;-</span> XTXI <span class="sc">%*%</span><span class="fu">t</span>(X)<span class="sc">%*%</span>y</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>betahat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  [,1]
(Intercept) 7.03259355
TV          0.04753664</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: sales
           Df Sum Sq Mean Sq F value    Pr(&gt;F)    
TV          1 3314.6  3314.6  312.14 &lt; 2.2e-16 ***
Residuals 198 2102.5    10.6                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>MSE <span class="ot">&lt;-</span> <span class="fu">anova</span>(mod1)[<span class="dv">2</span>, <span class="dv">3</span>]</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>MSE</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 10.61884</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Or using</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(mod1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)          TV 
 7.03259355  0.04753664 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = sales ~ TV, data = AD)

Residuals:
    Min      1Q  Median      3Q     Max 
-8.3860 -1.9545 -0.1913  2.0671  7.2124 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 7.032594   0.457843   15.36   &lt;2e-16 ***
TV          0.047537   0.002691   17.67   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.259 on 198 degrees of freedom
Multiple R-squared:  0.6119,    Adjusted R-squared:  0.6099 
F-statistic: 312.1 on 1 and 198 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>XTXI <span class="ot">&lt;-</span> <span class="fu">summary</span>(mod1)<span class="sc">$</span>cov.unscaled <span class="co"># preferred way to compute!</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>MSE <span class="ot">&lt;-</span> <span class="fu">summary</span>(mod1)<span class="sc">$</span>sigma<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>MSE</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 10.61884</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>var.cov.b <span class="ot">&lt;-</span> MSE<span class="sc">*</span>XTXI</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>var.cov.b</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             (Intercept)            TV
(Intercept)  0.209620158 -1.064495e-03
TV          -0.001064495  7.239367e-06</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>seb0 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(var.cov.b[<span class="dv">1</span>, <span class="dv">1</span>])</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>seb1 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(var.cov.b[<span class="dv">2</span>, <span class="dv">2</span>])</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(seb0, seb1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.457842940 0.002690607</code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(<span class="fu">summary</span>(mod1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              Estimate  Std. Error  t value    Pr(&gt;|t|)
(Intercept) 7.03259355 0.457842940 15.36028 1.40630e-35
TV          0.04753664 0.002690607 17.66763 1.46739e-42</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(<span class="fu">summary</span>(mod1))[<span class="dv">1</span>, <span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4578429</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(<span class="fu">summary</span>(mod1))[<span class="dv">2</span>, <span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.002690607</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>tb0 <span class="ot">&lt;-</span> b0<span class="sc">/</span>seb0</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>tb1 <span class="ot">&lt;-</span> b1<span class="sc">/</span>seb1</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(tb0, tb1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 15.36028 17.66763</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>pvalues <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">pt</span>(tb0, <span class="dv">198</span>, <span class="at">lower =</span> <span class="cn">FALSE</span>)<span class="sc">*</span><span class="dv">2</span>, <span class="fu">pt</span>(tb1, <span class="dv">198</span>, <span class="at">lower =</span> <span class="cn">FALSE</span>)<span class="sc">*</span><span class="dv">2</span>)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>pvalues</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.40630e-35 1.46739e-42</code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(<span class="fu">summary</span>(mod1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              Estimate  Std. Error  t value    Pr(&gt;|t|)
(Intercept) 7.03259355 0.457842940 15.36028 1.40630e-35
TV          0.04753664 0.002690607 17.66763 1.46739e-42</code></pre>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>TSS <span class="ot">&lt;-</span> <span class="fu">sum</span>((y <span class="sc">-</span> <span class="fu">mean</span>(y))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(RSS, TSS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2102.531 5417.149</code></pre>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>R2 <span class="ot">&lt;-</span> (TSS <span class="sc">-</span> RSS)<span class="sc">/</span>TSS</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>R2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6118751</code></pre>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Or</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod1)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6118751</code></pre>
</div>
</div>
<section id="confidence-interval-for-beta_1" class="level2">
<h2 class="anchored" data-anchor-id="confidence-interval-for-beta_1">Confidence Interval for <span class="math inline">\(\beta_1\)</span></h2>
<p><span id="eq-CIb1"><span class="math display">\[
\text{CI}_{1 - \alpha}(\beta_1) = \left[b_1 - t_{1- \alpha/2, n - p - 1}SE(b1), b_1 + t_{1- \alpha/2, n - p - 1}SE(b1) \right]
\tag{4}\]</span></span></p>
<p><strong>Example:</strong> Use <a href="#eq-CIb1">Equation&nbsp;4</a> to construct a 90% confidence interval for <span class="math inline">\(\beta_1\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.10</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>ct <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>, <span class="fu">df.residual</span>(mod1))</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>ct</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.652586</code></pre>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>b1 <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)<span class="sc">*</span>ct<span class="sc">*</span>seb1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.04309018 0.05198310</code></pre>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Or</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(mod1, <span class="at">parm =</span> <span class="st">"TV"</span>, <span class="at">level =</span> <span class="fl">0.90</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          5 %      95 %
TV 0.04309018 0.0519831</code></pre>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(mod1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 2.5 %     97.5 %
(Intercept) 6.12971927 7.93546783
TV          0.04223072 0.05284256</code></pre>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Or </span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(moderndive)</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a><span class="fu">get_regression_table</span>(mod1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2  7
  term      estimate std_error statistic p_value lower_ci upper_ci
  &lt;chr&gt;        &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
1 intercept    7.03      0.458      15.4       0    6.13     7.94 
2 TV           0.048     0.003      17.7       0    0.042    0.053</code></pre>
</div>
</div>
<section id="linear-algebra" class="level3">
<h3 class="anchored" data-anchor-id="linear-algebra">Linear Algebra</h3>
<p><strong>Solution of linear systems</strong> Find the solution(s) if any to the following linear equations.</p>
<p><span class="math display">\[2x + y - z = 8\]</span> <span class="math display">\[-3x - y + 2z = -11\]</span> <span class="math display">\[-2x + y + 2z = -3\]</span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="sc">-</span><span class="dv">3</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>), <span class="at">nrow =</span> <span class="dv">3</span>)</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">8</span>, <span class="sc">-</span><span class="dv">11</span>, <span class="sc">-</span><span class="dv">3</span>), <span class="at">nrow =</span> <span class="dv">3</span>)</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">solve</span>(A)<span class="sc">%*%</span>b</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1]
[1,]    2
[2,]    3
[3,]   -1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Or</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="fu">solve</span>(A, b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1]
[1,]    2
[2,]    3
[3,]   -1</code></pre>
</div>
</div>
<p>See <a href="https://en.wikipedia.org/wiki/Matrix_multiplication">wikipedia</a> for a review of matrix multiplication rules and properties.</p>
<p>Consider the 2 <span class="math inline">\(\times\)</span> 2 matrix <span class="math inline">\(A\)</span>.</p>
<p><span class="math display">\[A = \begin{bmatrix}
2 &amp; 4 \\
9 &amp; 5 \\
\end{bmatrix}
\]</span></p>
</section>
<section id="linear-regression-matrix-notation" class="level3">
<h3 class="anchored" data-anchor-id="linear-regression-matrix-notation">Linear Regression Matrix Notation</h3>
<span class="math display">\[\begin{equation}
\mathbf{\hat{\beta}} = (\mathbf{X'X})^{-1}\mathbf{X'Y}
\end{equation}\]</span>
<span class="math display">\[\begin{equation}
\sigma^2_{\hat{\beta}} = \sigma^2(\mathbf{X'X})^{-1}
\end{equation}\]</span>
<span class="math display">\[\begin{equation}
\hat{\sigma}^2_{\hat{\beta}} = MSE(\mathbf{X'X})^{-1}
\end{equation}\]</span>
<p><span class="math display">\[\mathbf{\hat{\beta}} \sim N(\mathbf{\beta}, \sigma^2(\mathbf{X'X})^{-1})\]</span></p>
</section>
<section id="estimation-of-the-mean-response-for-new-values-x_h" class="level3">
<h3 class="anchored" data-anchor-id="estimation-of-the-mean-response-for-new-values-x_h">Estimation of the Mean Response for New Values <span class="math inline">\(X_h\)</span></h3>
<p>Not only is it desirable to create confidence intervals on the parameters of the regression models, bit it is also common to estimate the mean response <span class="math inline">\(\left(E(Y_h)\right)\)</span> for a particular set of <span class="math inline">\(\mathbf{X}\)</span> values.</p>
<p><span class="math display">\[\hat{Y_h} \sim N(Y_h = X_h\beta, \sigma^2\mathbf{X_h}(\mathbf{X'X})^{-1}\mathbf{X_h'})\]</span> For a vector of given values <span class="math inline">\((\mathbf{X_h})\)</span>, a <span class="math inline">\((1 - \alpha)\cdot 100\%\)</span> confidence interval for the mean response <span class="math inline">\(E(Y_h)\)</span> is</p>
<p><span class="math display">\[CI_{1-\alpha}\left[E(Y_h)\right] = \left[\hat{Y_h} - t_{1 - \alpha/2;n - p - 1}\cdot s_{\hat{Y_h}}, \hat{Y_h} + t_{1 - \alpha/2;n - p - 1}\cdot s_{\hat{Y_h}}  \right]\]</span> The function <code>predict()</code> applied to a linear model object will compute <span class="math inline">\(\hat{Y_h}\)</span> and <span class="math inline">\(s_{\hat{Y_h}}\)</span> for a given <span class="math inline">\(\mathbf{X}_h\)</span>. <code>R</code> output has <span class="math inline">\(\hat{Y_h}\)</span> labeled <code>fit</code> and <span class="math inline">\(s_{\hat{Y_h}}\)</span> labeled <code>se.fit</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">9</span>, <span class="dv">4</span>, <span class="dv">5</span>), <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>A</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]
[1,]    2    4
[2,]    9    5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>(A)          <span class="co"># Transpose of A</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]
[1,]    2    9
[2,]    4    5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>(A)<span class="sc">%*%</span>A      <span class="co"># A'A</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]
[1,]   85   53
[2,]   53   41</code></pre>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">solve</span>(A)<span class="sc">%*%</span>A  <span class="co"># I_2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             [,1]          [,2]
[1,] 1.000000e+00 -1.110223e-16
[2,] 1.110223e-16  1.000000e+00</code></pre>
</div>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">zapsmall</span>(<span class="fu">solve</span>(A)<span class="sc">%*%</span>A)  <span class="co"># What you expect I_2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]
[1,]    1    0
[2,]    0    1</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(mod1)</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>XTX <span class="ot">&lt;-</span> <span class="fu">t</span>(X)<span class="sc">%*%</span>X</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(XTX)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>XTXI <span class="ot">&lt;-</span> <span class="fu">solve</span>(XTX)</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>XTXI</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              (Intercept)            TV
(Intercept)  0.0197403984 -1.002458e-04
TV          -0.0001002458  6.817474e-07</code></pre>
</div>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># But it is best to compute this quantity using</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod1)<span class="sc">$</span>cov.unscaled</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              (Intercept)            TV
(Intercept)  0.0197403984 -1.002458e-04
TV          -0.0001002458  6.817474e-07</code></pre>
</div>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>betahat <span class="ot">&lt;-</span> XTXI<span class="sc">%*%</span><span class="fu">t</span>(X)<span class="sc">%*%</span>y</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>betahat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  [,1]
(Intercept) 7.03259355
TV          0.04753664</code></pre>
</div>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(mod1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)          TV 
 7.03259355  0.04753664 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>XTXI <span class="ot">&lt;-</span> <span class="fu">summary</span>(mod1)<span class="sc">$</span>cov.unscaled</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>MSE <span class="ot">&lt;-</span> <span class="fu">summary</span>(mod1)<span class="sc">$</span>sigma<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>var_cov_b <span class="ot">&lt;-</span> MSE<span class="sc">*</span>XTXI</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>var_cov_b</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             (Intercept)            TV
(Intercept)  0.209620158 -1.064495e-03
TV          -0.001064495  7.239367e-06</code></pre>
</div>
</div>
<p><strong>Example</strong> Use the <code>GRADES</code> data set and model <code>gpa</code> as a function of <code>sat</code>. Compute the expected GPA (<code>gpa</code>) for an SAT score (<code>sat</code>) of 1300. Construct a 90% confidence interval for the mean GPA for students scoring 1300 on the SAT.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(PASWR2)</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>mod.lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(gpa <span class="sc">~</span> sat, <span class="at">data =</span> GRADES)</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod.lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = gpa ~ sat, data = GRADES)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.04954 -0.25960 -0.00655  0.26044  1.09328 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -1.1920638  0.2224502  -5.359 2.32e-07 ***
sat          0.0030943  0.0001945  15.912  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.3994 on 198 degrees of freedom
Multiple R-squared:  0.5612,    Adjusted R-squared:  0.5589 
F-statistic: 253.2 on 1 and 198 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>betahat <span class="ot">&lt;-</span> <span class="fu">coef</span>(mod.lm)</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>betahat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)         sat 
-1.19206381  0.00309427 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">tidy</span>(mod.lm))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">std.error</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-1.1920638</td>
<td style="text-align: right;">0.2224502</td>
<td style="text-align: right;">-5.35879</td>
<td style="text-align: right;">2e-07</td>
</tr>
<tr class="even">
<td style="text-align: left;">sat</td>
<td style="text-align: right;">0.0030943</td>
<td style="text-align: right;">0.0001945</td>
<td style="text-align: right;">15.91171</td>
<td style="text-align: right;">0e+00</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>Xh <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1300</span>), <span class="at">nrow =</span> <span class="dv">1</span>)</span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>Yhath <span class="ot">&lt;-</span> Xh<span class="sc">%*%</span>betahat</span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>Yhath</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         [,1]
[1,] 2.830488</code></pre>
</div>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(mod.lm, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">sat =</span> <span class="dv">1300</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1 
2.830488 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Linear Algebra First</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod.lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: gpa
           Df Sum Sq Mean Sq F value    Pr(&gt;F)    
sat         1 40.397  40.397  253.18 &lt; 2.2e-16 ***
Residuals 198 31.592   0.160                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>MSE <span class="ot">&lt;-</span> <span class="fu">anova</span>(mod.lm)[<span class="dv">2</span>, <span class="dv">3</span>]</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>MSE</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1595551</code></pre>
</div>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>XTXI <span class="ot">&lt;-</span> <span class="fu">summary</span>(mod.lm)<span class="sc">$</span>cov.unscaled</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>XTXI</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             (Intercept)           sat
(Intercept)  0.310137964 -2.689270e-04
sat         -0.000268927  2.370131e-07</code></pre>
</div>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>var_cov_b <span class="ot">&lt;-</span> MSE<span class="sc">*</span>XTXI</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>var_cov_b</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              (Intercept)           sat
(Intercept)  4.948408e-02 -4.290866e-05
sat         -4.290866e-05  3.781665e-08</code></pre>
</div>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>s2yhath <span class="ot">&lt;-</span> Xh <span class="sc">%*%</span> var_cov_b <span class="sc">%*%</span> <span class="fu">t</span>(Xh)</span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>s2yhath</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            [,1]
[1,] 0.001831706</code></pre>
</div>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>syhath <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(s2yhath)</span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>syhath</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           [,1]
[1,] 0.04279843</code></pre>
</div>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>crit_t <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="fl">0.95</span>, <span class="fu">df.residual</span>(mod.lm))</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>crit_t</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.652586</code></pre>
</div>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>CI_EYh <span class="ot">&lt;-</span> <span class="fu">c</span>(Yhath) <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)<span class="sc">*</span><span class="fu">c</span>(crit_t<span class="sc">*</span>syhath)</span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>CI_EYh</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.759760 2.901216</code></pre>
</div>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using the build in function</span></span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(mod.lm, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">sat =</span> <span class="dv">1300</span>), <span class="at">interval =</span> <span class="st">"conf"</span>, <span class="at">level =</span> <span class="fl">0.90</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       fit     lwr      upr
1 2.830488 2.75976 2.901216</code></pre>
</div>
</div>
</section>
</section>
<section id="multiple-linear-regression" class="level2">
<h2 class="anchored" data-anchor-id="multiple-linear-regression">Multiple Linear Regression</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(sales <span class="sc">~</span> TV <span class="sc">+</span> radio, <span class="at">data =</span> AD)</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = sales ~ TV + radio, data = AD)

Residuals:
    Min      1Q  Median      3Q     Max 
-8.7977 -0.8752  0.2422  1.1708  2.8328 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  2.92110    0.29449   9.919   &lt;2e-16 ***
TV           0.04575    0.00139  32.909   &lt;2e-16 ***
radio        0.18799    0.00804  23.382   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.681 on 197 degrees of freedom
Multiple R-squared:  0.8972,    Adjusted R-squared:  0.8962 
F-statistic: 859.6 on 2 and 197 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<section id="graphing-the-plane" class="level3">
<h3 class="anchored" data-anchor-id="graphing-the-plane">Graphing the plane</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scatterplot3d)</span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>s3d <span class="ot">&lt;-</span> <span class="fu">scatterplot3d</span>(<span class="at">x =</span> AD<span class="sc">$</span>TV, <span class="at">y =</span> AD<span class="sc">$</span>radio, </span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">z =</span> AD<span class="sc">$</span>sales, <span class="at">xlab =</span> <span class="st">"TV"</span>, </span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">ylab =</span> <span class="st">"Radio"</span>, <span class="at">zlab =</span> <span class="st">"Sales"</span>,</span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">box =</span> <span class="cn">TRUE</span>, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">color =</span> <span class="st">"white"</span>,</span>
<span id="cb139-6"><a href="#cb139-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">cex.symbols =</span> <span class="fl">0.75</span>, <span class="at">angle =</span> <span class="dv">60</span>, <span class="at">grid =</span> <span class="cn">FALSE</span>)</span>
<span id="cb139-7"><a href="#cb139-7" aria-hidden="true" tabindex="-1"></a>s3d<span class="sc">$</span><span class="fu">plane3d</span>(mod2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(sales <span class="sc">~</span> TV <span class="sc">+</span> radio, <span class="at">data =</span> AD), </span>
<span id="cb139-8"><a href="#cb139-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">lty =</span> <span class="st">"dotted"</span>, <span class="at">lty.box =</span> <span class="st">"solid"</span>)</span>
<span id="cb139-9"><a href="#cb139-9" aria-hidden="true" tabindex="-1"></a>orig <span class="ot">&lt;-</span> s3d<span class="sc">$</span><span class="fu">xyz.convert</span>(<span class="at">x =</span> AD<span class="sc">$</span>TV, <span class="at">y =</span> AD<span class="sc">$</span>radio, </span>
<span id="cb139-10"><a href="#cb139-10" aria-hidden="true" tabindex="-1"></a>                        <span class="at">z =</span> AD<span class="sc">$</span>sales)</span>
<span id="cb139-11"><a href="#cb139-11" aria-hidden="true" tabindex="-1"></a>plane <span class="ot">&lt;-</span> s3d<span class="sc">$</span><span class="fu">xyz.convert</span>(<span class="at">x =</span> AD<span class="sc">$</span>TV, <span class="at">y =</span> AD<span class="sc">$</span>radio,  <span class="fu">fitted</span>(mod2))</span>
<span id="cb139-12"><a href="#cb139-12" aria-hidden="true" tabindex="-1"></a>i.negpos <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="fu">resid</span>(mod2) <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb139-13"><a href="#cb139-13" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(orig<span class="sc">$</span>x, orig<span class="sc">$</span>y, plane<span class="sc">$</span>x, plane<span class="sc">$</span>y,</span>
<span id="cb139-14"><a href="#cb139-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"darkblue"</span>, <span class="st">"lightblue3"</span>)[i.negpos])</span>
<span id="cb139-15"><a href="#cb139-15" aria-hidden="true" tabindex="-1"></a>s3d<span class="sc">$</span><span class="fu">points3d</span>(<span class="at">x =</span> AD<span class="sc">$</span>TV, <span class="at">y =</span> AD<span class="sc">$</span>radio, </span>
<span id="cb139-16"><a href="#cb139-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">z =</span> AD<span class="sc">$</span>sales,</span>
<span id="cb139-17"><a href="#cb139-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"darkblue"</span>, <span class="st">"lightblue3"</span>)[i.negpos],</span>
<span id="cb139-18"><a href="#cb139-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">pch =</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-mucho" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="MiscRegression_files/figure-html/fig-mucho-1.png" class="img-fluid figure-img" width="480"></p>
<figcaption class="figure-caption">Figure&nbsp;5: 3-D residuals and fitted plane</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="using-plotly-1" class="level3">
<h3 class="anchored" data-anchor-id="using-plotly-1">Using <code>plotly</code></h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a><span class="co"># draw the 3D scatterplot</span></span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(<span class="at">data =</span> AD, <span class="at">z =</span> <span class="sc">~</span>sales, <span class="at">x =</span> <span class="sc">~</span>TV, <span class="at">y =</span> <span class="sc">~</span>radio, <span class="at">opacity =</span> <span class="fl">0.5</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a>  add_markers</span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-b85bf888dc62471906a9" style="width:100%;height:650px;"></div>
<script type="application/json" data-for="htmlwidget-b85bf888dc62471906a9">{"x":{"visdat":{"ad2b668df66e2":["function () ","plotlyVisDat"]},"cur_data":"ad2b668df66e2","attrs":{"ad2b668df66e2":{"z":{},"x":{},"y":{},"opacity":0.5,"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","mode":"markers","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"TV"},"yaxis":{"title":"radio"},"zaxis":{"title":"sales"}},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"z":[22.100000000000001,10.4,9.3000000000000007,18.5,12.9,7.2000000000000002,11.800000000000001,13.199999999999999,4.7999999999999998,10.6,8.5999999999999996,17.399999999999999,9.1999999999999993,9.6999999999999993,19,22.399999999999999,12.5,24.399999999999999,11.300000000000001,14.6,18,12.5,5.5999999999999996,15.5,9.6999999999999993,12,15,15.9,18.899999999999999,10.5,21.399999999999999,11.9,9.5999999999999996,17.399999999999999,9.5,12.800000000000001,25.399999999999999,14.699999999999999,10.1,21.5,16.600000000000001,17.100000000000001,20.699999999999999,12.9,8.5,14.9,10.6,23.199999999999999,14.800000000000001,9.6999999999999993,11.4,10.699999999999999,22.600000000000001,21.199999999999999,20.199999999999999,23.699999999999999,5.5,13.199999999999999,23.800000000000001,18.399999999999999,8.0999999999999996,24.199999999999999,15.699999999999999,14,18,9.3000000000000007,9.5,13.4,18.899999999999999,22.300000000000001,18.300000000000001,12.4,8.8000000000000007,11,17,8.6999999999999993,6.9000000000000004,14.199999999999999,5.2999999999999998,11,11.800000000000001,12.300000000000001,11.300000000000001,13.6,21.699999999999999,15.199999999999999,12,16,12.9,16.699999999999999,11.199999999999999,7.2999999999999998,19.399999999999999,22.199999999999999,11.5,16.899999999999999,11.699999999999999,15.5,25.399999999999999,17.199999999999999,11.699999999999999,23.800000000000001,14.800000000000001,14.699999999999999,20.699999999999999,19.199999999999999,7.2000000000000002,8.6999999999999993,5.2999999999999998,19.800000000000001,13.4,21.800000000000001,14.1,15.9,14.6,12.6,12.199999999999999,9.4000000000000004,15.9,6.5999999999999996,15.5,7,11.6,15.199999999999999,19.699999999999999,10.6,6.5999999999999996,8.8000000000000007,24.699999999999999,9.6999999999999993,1.6000000000000001,12.699999999999999,5.7000000000000002,19.600000000000001,10.800000000000001,11.6,9.5,20.800000000000001,9.5999999999999996,20.699999999999999,10.9,19.199999999999999,20.100000000000001,10.4,11.4,10.300000000000001,13.199999999999999,25.399999999999999,10.9,10.1,16.100000000000001,11.6,16.600000000000001,19,15.6,3.2000000000000002,15.300000000000001,10.1,7.2999999999999998,12.9,14.4,13.300000000000001,14.9,18,11.9,11.9,8,12.199999999999999,17.100000000000001,15,8.4000000000000004,14.5,7.5999999999999996,11.699999999999999,11.5,27,20.199999999999999,11.699999999999999,11.800000000000001,12.6,10.5,12.199999999999999,8.6999999999999993,26.199999999999999,17.600000000000001,22.600000000000001,10.300000000000001,17.300000000000001,15.9,6.7000000000000002,10.800000000000001,9.9000000000000004,5.9000000000000004,19.600000000000001,17.300000000000001,7.5999999999999996,9.6999999999999993,12.800000000000001,25.5,13.4],"x":[230.09999999999999,44.5,17.199999999999999,151.5,180.80000000000001,8.6999999999999993,57.5,120.2,8.5999999999999996,199.80000000000001,66.099999999999994,214.69999999999999,23.800000000000001,97.5,204.09999999999999,195.40000000000001,67.799999999999997,281.39999999999998,69.200000000000003,147.30000000000001,218.40000000000001,237.40000000000001,13.199999999999999,228.30000000000001,62.299999999999997,262.89999999999998,142.90000000000001,240.09999999999999,248.80000000000001,70.599999999999994,292.89999999999998,112.90000000000001,97.200000000000003,265.60000000000002,95.700000000000003,290.69999999999999,266.89999999999998,74.700000000000003,43.100000000000001,228,202.5,177,293.60000000000002,206.90000000000001,25.100000000000001,175.09999999999999,89.700000000000003,239.90000000000001,227.19999999999999,66.900000000000006,199.80000000000001,100.40000000000001,216.40000000000001,182.59999999999999,262.69999999999999,198.90000000000001,7.2999999999999998,136.19999999999999,210.80000000000001,210.69999999999999,53.5,261.30000000000001,239.30000000000001,102.7,131.09999999999999,69,31.5,139.30000000000001,237.40000000000001,216.80000000000001,199.09999999999999,109.8,26.800000000000001,129.40000000000001,213.40000000000001,16.899999999999999,27.5,120.5,5.4000000000000004,116,76.400000000000006,239.80000000000001,75.299999999999997,68.400000000000006,213.5,193.19999999999999,76.299999999999997,110.7,88.299999999999997,109.8,134.30000000000001,28.600000000000001,217.69999999999999,250.90000000000001,107.40000000000001,163.30000000000001,197.59999999999999,184.90000000000001,289.69999999999999,135.19999999999999,222.40000000000001,296.39999999999998,280.19999999999999,187.90000000000001,238.19999999999999,137.90000000000001,25,90.400000000000006,13.1,255.40000000000001,225.80000000000001,241.69999999999999,175.69999999999999,209.59999999999999,78.200000000000003,75.099999999999994,139.19999999999999,76.400000000000006,125.7,19.399999999999999,141.30000000000001,18.800000000000001,224,123.09999999999999,229.5,87.200000000000003,7.7999999999999998,80.200000000000003,220.30000000000001,59.600000000000001,0.69999999999999996,265.19999999999999,8.4000000000000004,219.80000000000001,36.899999999999999,48.299999999999997,25.600000000000001,273.69999999999999,43,184.90000000000001,73.400000000000006,193.69999999999999,220.5,104.59999999999999,96.200000000000003,140.30000000000001,240.09999999999999,243.19999999999999,38,44.700000000000003,280.69999999999999,121,197.59999999999999,171.30000000000001,187.80000000000001,4.0999999999999996,93.900000000000006,149.80000000000001,11.699999999999999,131.69999999999999,172.5,85.700000000000003,188.40000000000001,163.5,117.2,234.5,17.899999999999999,206.80000000000001,215.40000000000001,284.30000000000001,50,164.5,19.600000000000001,168.40000000000001,222.40000000000001,276.89999999999998,248.40000000000001,170.19999999999999,276.69999999999999,165.59999999999999,156.59999999999999,218.5,56.200000000000003,287.60000000000002,253.80000000000001,205,139.5,191.09999999999999,286,18.699999999999999,39.5,75.5,17.199999999999999,166.80000000000001,149.69999999999999,38.200000000000003,94.200000000000003,177,283.60000000000002,232.09999999999999],"y":[37.799999999999997,39.299999999999997,45.899999999999999,41.299999999999997,10.800000000000001,48.899999999999999,32.799999999999997,19.600000000000001,2.1000000000000001,2.6000000000000001,5.7999999999999998,24,35.100000000000001,7.5999999999999996,32.899999999999999,47.700000000000003,36.600000000000001,39.600000000000001,20.5,23.899999999999999,27.699999999999999,5.0999999999999996,15.9,16.899999999999999,12.6,3.5,29.300000000000001,16.699999999999999,27.100000000000001,16,28.300000000000001,17.399999999999999,1.5,20,1.3999999999999999,4.0999999999999996,43.799999999999997,49.399999999999999,26.699999999999999,37.700000000000003,22.300000000000001,33.399999999999999,27.699999999999999,8.4000000000000004,25.699999999999999,22.5,9.9000000000000004,41.5,15.800000000000001,11.699999999999999,3.1000000000000001,9.5999999999999996,41.700000000000003,46.200000000000003,28.800000000000001,49.399999999999999,28.100000000000001,19.199999999999999,49.600000000000001,29.5,2,42.700000000000003,15.5,29.600000000000001,42.799999999999997,9.3000000000000007,24.600000000000001,14.5,27.5,43.899999999999999,30.600000000000001,14.300000000000001,33,5.7000000000000002,24.600000000000001,43.700000000000003,1.6000000000000001,28.5,29.899999999999999,7.7000000000000002,26.699999999999999,4.0999999999999996,20.300000000000001,44.5,43,18.399999999999999,27.5,40.600000000000001,25.5,47.799999999999997,4.9000000000000004,1.5,33.5,36.5,14,31.600000000000001,3.5,21,42.299999999999997,41.700000000000003,4.2999999999999998,36.299999999999997,10.1,17.199999999999999,34.299999999999997,46.399999999999999,11,0.29999999999999999,0.40000000000000002,26.899999999999999,8.1999999999999993,38,15.4,20.600000000000001,46.799999999999997,35,14.300000000000001,0.80000000000000004,36.899999999999999,16,26.800000000000001,21.699999999999999,2.3999999999999999,34.600000000000001,32.299999999999997,11.800000000000001,38.899999999999999,0,49,12,39.600000000000001,2.8999999999999999,27.199999999999999,33.5,38.600000000000001,47,39,28.899999999999999,25.899999999999999,43.899999999999999,17,35.399999999999999,33.200000000000003,5.7000000000000002,14.800000000000001,1.8999999999999999,7.2999999999999998,49,40.299999999999997,25.800000000000001,13.9,8.4000000000000004,23.300000000000001,39.700000000000003,21.100000000000001,11.6,43.5,1.3,36.899999999999999,18.399999999999999,18.100000000000001,35.799999999999997,18.100000000000001,36.799999999999997,14.699999999999999,3.3999999999999999,37.600000000000001,5.2000000000000002,23.600000000000001,10.6,11.6,20.899999999999999,20.100000000000001,7.0999999999999996,3.3999999999999999,48.899999999999999,30.199999999999999,7.7999999999999998,2.2999999999999998,10,2.6000000000000001,5.4000000000000004,5.7000000000000002,43,21.300000000000001,45.100000000000001,2.1000000000000001,28.699999999999999,13.9,12.1,41.100000000000001,10.800000000000001,4.0999999999999996,42,35.600000000000001,3.7000000000000002,4.9000000000000004,9.3000000000000007,42,8.5999999999999996],"opacity":0.5,"type":"scatter3d","mode":"markers","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">300</span>, <span class="at">length =</span> <span class="dv">70</span>)</span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">50</span>, <span class="at">length =</span> <span class="dv">70</span>)</span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>plane <span class="ot">&lt;-</span> <span class="fu">outer</span>(x, y, <span class="cf">function</span>(a, b){<span class="fu">summary</span>(mod2)<span class="sc">$</span>coef[<span class="dv">1</span>, <span class="dv">1</span>] <span class="sc">+</span> <span class="fu">summary</span>(mod2)<span class="sc">$</span>coef[<span class="dv">2</span>, <span class="dv">1</span>]<span class="sc">*</span>a <span class="sc">+</span> <span class="fu">summary</span>(mod2)<span class="sc">$</span>coef[<span class="dv">3</span>, <span class="dv">1</span>]<span class="sc">*</span>b})</span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a><span class="co"># draw the plane</span></span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a>p <span class="sc">%&gt;%</span> </span>
<span id="cb141-6"><a href="#cb141-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_surface</span>(<span class="at">x =</span> <span class="sc">~</span>x, <span class="at">y =</span> <span class="sc">~</span>y, <span class="at">z =</span> <span class="sc">~</span>plane, <span class="at">showscale =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-88fdd2a34d502a66744b" style="width:100%;height:650px;"></div>
<script type="application/json" data-for="htmlwidget-88fdd2a34d502a66744b">{"x":{"visdat":{"ad2b668df66e2":["function () ","plotlyVisDat"]},"cur_data":"ad2b668df66e2","attrs":{"ad2b668df66e2":{"z":{},"x":{},"y":{},"opacity":0.5,"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","mode":"markers","inherit":true},"ad2b668df66e2.1":{"z":{},"x":{},"y":{},"opacity":0.5,"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"surface","showscale":false,"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"TV"},"yaxis":{"title":"radio"},"zaxis":{"title":"sales"}},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"z":[22.100000000000001,10.4,9.3000000000000007,18.5,12.9,7.2000000000000002,11.800000000000001,13.199999999999999,4.7999999999999998,10.6,8.5999999999999996,17.399999999999999,9.1999999999999993,9.6999999999999993,19,22.399999999999999,12.5,24.399999999999999,11.300000000000001,14.6,18,12.5,5.5999999999999996,15.5,9.6999999999999993,12,15,15.9,18.899999999999999,10.5,21.399999999999999,11.9,9.5999999999999996,17.399999999999999,9.5,12.800000000000001,25.399999999999999,14.699999999999999,10.1,21.5,16.600000000000001,17.100000000000001,20.699999999999999,12.9,8.5,14.9,10.6,23.199999999999999,14.800000000000001,9.6999999999999993,11.4,10.699999999999999,22.600000000000001,21.199999999999999,20.199999999999999,23.699999999999999,5.5,13.199999999999999,23.800000000000001,18.399999999999999,8.0999999999999996,24.199999999999999,15.699999999999999,14,18,9.3000000000000007,9.5,13.4,18.899999999999999,22.300000000000001,18.300000000000001,12.4,8.8000000000000007,11,17,8.6999999999999993,6.9000000000000004,14.199999999999999,5.2999999999999998,11,11.800000000000001,12.300000000000001,11.300000000000001,13.6,21.699999999999999,15.199999999999999,12,16,12.9,16.699999999999999,11.199999999999999,7.2999999999999998,19.399999999999999,22.199999999999999,11.5,16.899999999999999,11.699999999999999,15.5,25.399999999999999,17.199999999999999,11.699999999999999,23.800000000000001,14.800000000000001,14.699999999999999,20.699999999999999,19.199999999999999,7.2000000000000002,8.6999999999999993,5.2999999999999998,19.800000000000001,13.4,21.800000000000001,14.1,15.9,14.6,12.6,12.199999999999999,9.4000000000000004,15.9,6.5999999999999996,15.5,7,11.6,15.199999999999999,19.699999999999999,10.6,6.5999999999999996,8.8000000000000007,24.699999999999999,9.6999999999999993,1.6000000000000001,12.699999999999999,5.7000000000000002,19.600000000000001,10.800000000000001,11.6,9.5,20.800000000000001,9.5999999999999996,20.699999999999999,10.9,19.199999999999999,20.100000000000001,10.4,11.4,10.300000000000001,13.199999999999999,25.399999999999999,10.9,10.1,16.100000000000001,11.6,16.600000000000001,19,15.6,3.2000000000000002,15.300000000000001,10.1,7.2999999999999998,12.9,14.4,13.300000000000001,14.9,18,11.9,11.9,8,12.199999999999999,17.100000000000001,15,8.4000000000000004,14.5,7.5999999999999996,11.699999999999999,11.5,27,20.199999999999999,11.699999999999999,11.800000000000001,12.6,10.5,12.199999999999999,8.6999999999999993,26.199999999999999,17.600000000000001,22.600000000000001,10.300000000000001,17.300000000000001,15.9,6.7000000000000002,10.800000000000001,9.9000000000000004,5.9000000000000004,19.600000000000001,17.300000000000001,7.5999999999999996,9.6999999999999993,12.800000000000001,25.5,13.4],"x":[230.09999999999999,44.5,17.199999999999999,151.5,180.80000000000001,8.6999999999999993,57.5,120.2,8.5999999999999996,199.80000000000001,66.099999999999994,214.69999999999999,23.800000000000001,97.5,204.09999999999999,195.40000000000001,67.799999999999997,281.39999999999998,69.200000000000003,147.30000000000001,218.40000000000001,237.40000000000001,13.199999999999999,228.30000000000001,62.299999999999997,262.89999999999998,142.90000000000001,240.09999999999999,248.80000000000001,70.599999999999994,292.89999999999998,112.90000000000001,97.200000000000003,265.60000000000002,95.700000000000003,290.69999999999999,266.89999999999998,74.700000000000003,43.100000000000001,228,202.5,177,293.60000000000002,206.90000000000001,25.100000000000001,175.09999999999999,89.700000000000003,239.90000000000001,227.19999999999999,66.900000000000006,199.80000000000001,100.40000000000001,216.40000000000001,182.59999999999999,262.69999999999999,198.90000000000001,7.2999999999999998,136.19999999999999,210.80000000000001,210.69999999999999,53.5,261.30000000000001,239.30000000000001,102.7,131.09999999999999,69,31.5,139.30000000000001,237.40000000000001,216.80000000000001,199.09999999999999,109.8,26.800000000000001,129.40000000000001,213.40000000000001,16.899999999999999,27.5,120.5,5.4000000000000004,116,76.400000000000006,239.80000000000001,75.299999999999997,68.400000000000006,213.5,193.19999999999999,76.299999999999997,110.7,88.299999999999997,109.8,134.30000000000001,28.600000000000001,217.69999999999999,250.90000000000001,107.40000000000001,163.30000000000001,197.59999999999999,184.90000000000001,289.69999999999999,135.19999999999999,222.40000000000001,296.39999999999998,280.19999999999999,187.90000000000001,238.19999999999999,137.90000000000001,25,90.400000000000006,13.1,255.40000000000001,225.80000000000001,241.69999999999999,175.69999999999999,209.59999999999999,78.200000000000003,75.099999999999994,139.19999999999999,76.400000000000006,125.7,19.399999999999999,141.30000000000001,18.800000000000001,224,123.09999999999999,229.5,87.200000000000003,7.7999999999999998,80.200000000000003,220.30000000000001,59.600000000000001,0.69999999999999996,265.19999999999999,8.4000000000000004,219.80000000000001,36.899999999999999,48.299999999999997,25.600000000000001,273.69999999999999,43,184.90000000000001,73.400000000000006,193.69999999999999,220.5,104.59999999999999,96.200000000000003,140.30000000000001,240.09999999999999,243.19999999999999,38,44.700000000000003,280.69999999999999,121,197.59999999999999,171.30000000000001,187.80000000000001,4.0999999999999996,93.900000000000006,149.80000000000001,11.699999999999999,131.69999999999999,172.5,85.700000000000003,188.40000000000001,163.5,117.2,234.5,17.899999999999999,206.80000000000001,215.40000000000001,284.30000000000001,50,164.5,19.600000000000001,168.40000000000001,222.40000000000001,276.89999999999998,248.40000000000001,170.19999999999999,276.69999999999999,165.59999999999999,156.59999999999999,218.5,56.200000000000003,287.60000000000002,253.80000000000001,205,139.5,191.09999999999999,286,18.699999999999999,39.5,75.5,17.199999999999999,166.80000000000001,149.69999999999999,38.200000000000003,94.200000000000003,177,283.60000000000002,232.09999999999999],"y":[37.799999999999997,39.299999999999997,45.899999999999999,41.299999999999997,10.800000000000001,48.899999999999999,32.799999999999997,19.600000000000001,2.1000000000000001,2.6000000000000001,5.7999999999999998,24,35.100000000000001,7.5999999999999996,32.899999999999999,47.700000000000003,36.600000000000001,39.600000000000001,20.5,23.899999999999999,27.699999999999999,5.0999999999999996,15.9,16.899999999999999,12.6,3.5,29.300000000000001,16.699999999999999,27.100000000000001,16,28.300000000000001,17.399999999999999,1.5,20,1.3999999999999999,4.0999999999999996,43.799999999999997,49.399999999999999,26.699999999999999,37.700000000000003,22.300000000000001,33.399999999999999,27.699999999999999,8.4000000000000004,25.699999999999999,22.5,9.9000000000000004,41.5,15.800000000000001,11.699999999999999,3.1000000000000001,9.5999999999999996,41.700000000000003,46.200000000000003,28.800000000000001,49.399999999999999,28.100000000000001,19.199999999999999,49.600000000000001,29.5,2,42.700000000000003,15.5,29.600000000000001,42.799999999999997,9.3000000000000007,24.600000000000001,14.5,27.5,43.899999999999999,30.600000000000001,14.300000000000001,33,5.7000000000000002,24.600000000000001,43.700000000000003,1.6000000000000001,28.5,29.899999999999999,7.7000000000000002,26.699999999999999,4.0999999999999996,20.300000000000001,44.5,43,18.399999999999999,27.5,40.600000000000001,25.5,47.799999999999997,4.9000000000000004,1.5,33.5,36.5,14,31.600000000000001,3.5,21,42.299999999999997,41.700000000000003,4.2999999999999998,36.299999999999997,10.1,17.199999999999999,34.299999999999997,46.399999999999999,11,0.29999999999999999,0.40000000000000002,26.899999999999999,8.1999999999999993,38,15.4,20.600000000000001,46.799999999999997,35,14.300000000000001,0.80000000000000004,36.899999999999999,16,26.800000000000001,21.699999999999999,2.3999999999999999,34.600000000000001,32.299999999999997,11.800000000000001,38.899999999999999,0,49,12,39.600000000000001,2.8999999999999999,27.199999999999999,33.5,38.600000000000001,47,39,28.899999999999999,25.899999999999999,43.899999999999999,17,35.399999999999999,33.200000000000003,5.7000000000000002,14.800000000000001,1.8999999999999999,7.2999999999999998,49,40.299999999999997,25.800000000000001,13.9,8.4000000000000004,23.300000000000001,39.700000000000003,21.100000000000001,11.6,43.5,1.3,36.899999999999999,18.399999999999999,18.100000000000001,35.799999999999997,18.100000000000001,36.799999999999997,14.699999999999999,3.3999999999999999,37.600000000000001,5.2000000000000002,23.600000000000001,10.6,11.6,20.899999999999999,20.100000000000001,7.0999999999999996,3.3999999999999999,48.899999999999999,30.199999999999999,7.7999999999999998,2.2999999999999998,10,2.6000000000000001,5.4000000000000004,5.7000000000000002,43,21.300000000000001,45.100000000000001,2.1000000000000001,28.699999999999999,13.9,12.1,41.100000000000001,10.800000000000001,4.0999999999999996,42,35.600000000000001,3.7000000000000002,4.9000000000000004,9.3000000000000007,42,8.5999999999999996],"opacity":0.5,"type":"scatter3d","mode":"markers","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"frame":null},{"colorbar":{"title":"sales<br />plane","ticklen":2},"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666667","rgba(70,19,97,1)"],["0.0833333333333333","rgba(72,32,111,1)"],["0.125","rgba(71,45,122,1)"],["0.166666666666667","rgba(68,58,128,1)"],["0.208333333333333","rgba(64,70,135,1)"],["0.25","rgba(60,82,138,1)"],["0.291666666666667","rgba(56,93,140,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(46,114,142,1)"],["0.416666666666667","rgba(42,123,142,1)"],["0.458333333333333","rgba(38,133,141,1)"],["0.5","rgba(37,144,140,1)"],["0.541666666666667","rgba(33,154,138,1)"],["0.583333333333333","rgba(39,164,133,1)"],["0.625","rgba(47,174,127,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(79,191,110,1)"],["0.75","rgba(98,199,98,1)"],["0.791666666666667","rgba(119,207,85,1)"],["0.833333333333333","rgba(147,214,70,1)"],["0.875","rgba(172,220,52,1)"],["0.916666666666667","rgba(199,225,42,1)"],["0.958333333333333","rgba(226,228,40,1)"],["1","rgba(253,231,37,1)"]],"showscale":false,"z":[[2.9210999124051433,3.0573276128546425,3.1935553133041421,3.3297830137536413,3.4660107142031409,3.6022384146526401,3.7384661151021397,3.8746938155516393,4.0109215160011384,4.1471492164506376,4.2833769169001368,4.4196046173496368,4.555832317799136,4.6920600182486352,4.8282877186981352,4.9645154191476344,5.1007431195971336,5.2369708200466327,5.3731985204961319,5.5094262209456319,5.6456539213951311,5.7818816218446303,5.9181093222941303,6.0543370227436295,6.1905647231931287,6.3267924236426278,6.463020124092127,6.5992478245416262,6.7354755249911262,6.8717032254406254,7.0079309258901246,7.1441586263396237,7.2803863267891238,7.416614027238623,7.5528417276881221,7.6890694281376222,7.8252971285871213,7.9615248290366205,8.0977525294861206,8.233980229935618,8.3702079303851189,8.5064356308346181,8.6426633312841172,8.7788910317336182,8.9151187321831173,9.0513464326326165,9.1875741330821157,9.3238018335316148,9.460029533981114,9.5962572344306132,9.7324849348801123,9.8687126353296115,10.004940335779111,10.14116803622861,10.277395736678109,10.41362343712761,10.549851137577109,10.686078838026607,10.822306538476107,10.958534238925607,11.094761939375106,11.230989639824607,11.367217340274104,11.503445040723605,11.639672741173104,11.775900441622603,11.912128142072103,12.048355842521602,12.184583542971101,12.3208112434206],[3.1200338911054746,3.2562615915549742,3.3924892920044734,3.5287169924539725,3.6649446929034721,3.8011723933529717,3.9374000938024709,4.0736277942519701,4.2098554947014701,4.3460831951509693,4.4823108956004685,4.6185385960499676,4.7547662964994668,4.890993996948966,5.027221697398466,5.1634493978479652,5.2996770982974652,5.4359047987469644,5.5721324991964636,5.7083601996459628,5.8445879000954619,5.9808156005449611,6.1170433009944611,6.2532710014439612,6.3894987018934595,6.5257264023429595,6.6619541027924587,6.7981818032419579,6.934409503691457,7.0706372041409562,7.2068649045904554,7.3430926050399545,7.4793203054894555,7.6155480059389546,7.7517757063884538,7.888003406837953,8.0242311072874521,8.1604588077369513,8.2966865081864523,8.4329142086359496,8.5691419090854506,8.7053696095349498,8.8415973099844489,8.9778250104339481,9.1140527108834473,9.2502804113329464,9.3865081117824474,9.5227358122319448,9.6589635126814439,9.7951912131309449,9.931418913580444,10.067646614029943,10.203874314479442,10.340102014928942,10.476329715378441,10.612557415827942,10.748785116277441,10.885012816726938,11.021240517176439,11.157468217625938,11.293695918075437,11.429923618524938,11.566151318974436,11.702379019423937,11.838606719873436,11.974834420322935,12.111062120772434,12.247289821221933,12.383517521671433,12.519745222120932],[3.3189678698058054,3.455195570255305,3.5914232707048042,3.7276509711543033,3.8638786716038029,4.0001063720533026,4.1363340725028017,4.2725617729523009,4.4087894734018001,4.5450171738513001,4.6812448743007993,4.8174725747502984,4.9537002751997976,5.0899279756492977,5.2261556760987968,5.362383376548296,5.4986110769977952,5.6348387774472943,5.7710664778967944,5.9072941783462944,6.0435218787957936,6.1797495792452928,6.3159772796947919,6.4522049801442911,6.5884326805937903,6.7246603810432894,6.8608880814927886,6.9971157819422887,7.1333434823917887,7.2695711828412879,7.4057988832907871,7.5420265837402862,7.6782542841897854,7.8144819846392846,7.9507096850887837,8.0869373855382847,8.2231650859877838,8.359392786437283,8.4956204868867822,8.6318481873362813,8.7680758877857805,8.9043035882352797,9.0405312886847788,9.1767589891342798,9.312986689583779,9.4492143900332781,9.5854420904827773,9.7216697909322765,9.8578974913817756,9.9941251918312748,10.130352892280774,10.266580592730275,10.402808293179772,10.539035993629273,10.675263694078772,10.811491394528272,10.947719094977771,11.08394679542727,11.220174495876769,11.356402196326268,11.492629896775767,11.628857597225268,11.765085297674766,11.901312998124267,12.037540698573766,12.173768399023265,12.309996099472764,12.446223799922263,12.582451500371763,12.718679200821262],[3.5179018485061366,3.6541295489556358,3.7903572494051354,3.9265849498546346,4.0628126503041342,4.1990403507536334,4.3352680512031325,4.4714957516526326,4.6077234521021317,4.7439511525516309,4.8801788530011301,5.0164065534506301,5.1526342539001293,5.2888619543496285,5.4250896547991285,5.5613173552486277,5.6975450556981269,5.833772756147626,5.9700004565971252,6.1062281570466252,6.2424558574961244,6.3786835579456236,6.5149112583951236,6.6511389588446228,6.787366659294122,6.9235943597436211,7.0598220601931203,7.1960497606426195,7.3322774610921195,7.4685051615416187,7.6047328619911179,7.740960562440617,7.8771882628901171,8.0134159633396163,8.1496436637891154,8.2858713642386164,8.4220990646881155,8.5583267651376147,8.6945544655871139,8.830782166036613,8.9670098664861122,9.1032375669356114,9.2394652673851105,9.3756929678346097,9.5119206682841089,9.648148368733608,9.784376069183109,9.9206037696326064,10.056831470082106,10.193059170531606,10.329286870981106,10.465514571430607,10.601742271880104,10.737969972329605,10.874197672779104,11.010425373228603,11.146653073678102,11.282880774127602,11.419108474577101,11.5553361750266,11.691563875476099,11.8277915759256,11.964019276375097,12.100246976824598,12.236474677274098,12.372702377723597,12.508930078173096,12.645157778622595,12.781385479072094,12.917613179521593],[3.7168358272064674,3.8530635276559666,3.9892912281054662,4.1255189285549658,4.261746629004465,4.3979743294539642,4.5342020299034633,4.6704297303529634,4.8066574308024625,4.9428851312519617,5.0791128317014618,5.2153405321509609,5.3515682326004601,5.4877959330499593,5.6240236334994584,5.7602513339489576,5.8964790343984577,6.0327067348479568,6.1689344352974569,6.3051621357469561,6.4413898361964552,6.5776175366459544,6.7138452370954536,6.8500729375449536,6.9863006379944519,7.1225283384439519,7.2587560388934511,7.3949837393429512,7.5312114397924503,7.6674391402419495,7.8036668406914487,7.9398945411409478,8.076122241590447,8.2123499420399462,8.3485776424894453,8.4848053429389463,8.6210330433884454,8.7572607438379446,8.8934884442874456,9.029716144736943,9.1659438451864439,9.3021715456359431,9.4383992460854422,9.5746269465349414,9.7108546469844406,9.8470823474339397,9.9833100478834389,10.119537748332938,10.255765448782437,10.391993149231936,10.528220849681436,10.664448550130937,10.800676250580434,10.936903951029935,11.073131651479434,11.209359351928935,11.345587052378434,11.481814752827932,11.618042453277432,11.754270153726932,11.890497854176431,12.02672555462593,12.162953255075429,12.299180955524928,12.435408655974427,12.571636356423927,12.707864056873426,12.844091757322925,12.980319457772424,13.116547158221923],[3.9157698059067987,4.0519975063562983,4.1882252068057975,4.3244529072552966,4.4606806077047967,4.5969083081542959,4.733136008603795,4.8693637090532942,5.0055914095027934,5.1418191099522934,5.2780468104017926,5.4142745108512917,5.5505022113007909,5.686729911750291,5.8229576121997901,5.9591853126492893,6.0954130130987885,6.2316407135482876,6.3678684139977877,6.5040961144472877,6.6403238148967869,6.7765515153462861,6.9127792157957852,7.0490069162452844,7.1852346166947836,7.3214623171442827,7.4576900175937819,7.593917718043282,7.730145418492782,7.8663731189422812,8.0026008193917804,8.1388285198412795,8.2750562202907787,8.4112839207402779,8.547511621189777,8.683739321639278,8.8199670220887771,8.9561947225382763,9.0924224229877755,9.2286501234372746,9.3648778238867738,9.501105524336273,9.6373332247857721,9.7735609252352731,9.9097886256847723,10.046016326134271,10.182244026583771,10.31847172703327,10.454699427482769,10.590927127932268,10.727154828381767,10.863382528831268,10.999610229280766,11.135837929730267,11.272065630179766,11.408293330629265,11.544521031078764,11.680748731528263,11.816976431977762,11.953204132427262,12.089431832876761,12.225659533326262,12.361887233775759,12.49811493422526,12.634342634674759,12.770570335124258,12.906798035573757,13.043025736023257,13.179253436472756,13.315481136922255],[4.1147037846071299,4.2509314850566291,4.3871591855061283,4.5233868859556283,4.6596145864051275,4.7958422868546267,4.9320699873041258,5.0682976877536259,5.204525388203125,5.3407530886526242,5.4769807891021234,5.6132084895516234,5.7494361900011226,5.8856638904506218,6.0218915909001218,6.158119291349621,6.2943469917991202,6.4305746922486193,6.5668023926981185,6.7030300931476186,6.8392577935971177,6.9754854940466169,7.1117131944961169,7.2479408949456161,7.3841685953951153,7.5203962958446144,7.6566239962941136,7.7928516967436128,7.9290793971931128,8.0653070976426129,8.2015347980921121,8.3377624985416112,8.4739901989911104,8.6102178994406096,8.7464455998901087,8.8826733003396079,9.0189010007891071,9.1551287012386062,9.2913564016881072,9.4275841021376046,9.5638118025871055,9.7000395030366047,9.8362672034861038,9.9724949039356048,10.108722604385104,10.244950304834603,10.381178005284102,10.517405705733601,10.653633406183101,10.7898611066326,10.926088807082099,11.062316507531598,11.198544207981097,11.334771908430596,11.470999608880096,11.607227309329597,11.743455009779096,11.879682710228593,12.015910410678094,12.152138111127593,12.288365811577092,12.424593512026593,12.560821212476091,12.697048912925592,12.833276613375091,12.96950431382459,13.105732014274089,13.241959714723588,13.378187415173088,13.514415115622587],[4.3136377633074607,4.4498654637569599,4.58609316420646,4.7223208646559591,4.8585485651054583,4.9947762655549575,5.1310039660044566,5.2672316664539567,5.4034593669034559,5.539687067352955,5.6759147678024551,5.8121424682519542,5.9483701687014534,6.0845978691509526,6.2208255696004517,6.3570532700499509,6.493280970499451,6.6295086709489501,6.7657363713984502,6.9019640718479494,7.0381917722974485,7.1744194727469477,7.3106471731964469,7.4468748736459469,7.5831025740954452,7.7193302745449452,7.8555579749944444,7.9917856754439445,8.1280133758934436,8.2642410763429428,8.400468776792442,8.5366964772419411,8.6729241776914421,8.8091518781409412,8.9453795785904404,9.0816072790399396,9.2178349794894388,9.3540626799389379,9.4902903803884371,9.6265180808379363,9.7627457812874354,9.8989734817369346,10.035201182186434,10.171428882635935,10.307656583085434,10.443884283534933,10.580111983984434,10.716339684433931,10.852567384883431,10.988795085332931,11.125022785782431,11.26125048623193,11.397478186681429,11.533705887130928,11.669933587580427,11.806161288029926,11.942388988479426,12.078616688928925,12.214844389378424,12.351072089827923,12.487299790277422,12.623527490726925,12.759755191176421,12.895982891625923,13.032210592075423,13.168438292524922,13.304665992974421,13.44089369342392,13.577121393873419,13.713349094322918],[4.5125717420077915,4.6487994424572907,4.7850271429067899,4.9212548433562899,5.0574825438057891,5.1937102442552883,5.3299379447047874,5.4661656451542875,5.6023933456037867,5.7386210460532858,5.874848746502785,6.011076446952285,6.1473041474017842,6.2835318478512834,6.4197595483007834,6.5559872487502826,6.6922149491997818,6.8284426496492809,6.9646703500987801,7.1008980505482802,7.2371257509977793,7.3733534514472785,7.5095811518967786,7.6458088523462777,7.7820365527957769,7.9182642532452761,8.0544919536947752,8.1907196541442744,8.3269473545937736,8.4631750550432727,8.5994027554927719,8.7356304559422711,8.871858156391772,9.0080858568412712,9.1443135572907703,9.2805412577402713,9.4167689581897704,9.5529966586392696,9.6892243590887688,9.8254520595382679,9.9616797599877671,10.097907460437266,10.234135160886765,10.370362861336265,10.506590561785764,10.642818262235263,10.779045962684764,10.915273663134261,11.05150136358376,11.187729064033261,11.323956764482761,11.460184464932262,11.596412165381759,11.73263986583126,11.868867566280759,12.005095266730258,12.141322967179757,12.277550667629257,12.413778368078756,12.550006068528255,12.686233768977754,12.822461469427255,12.958689169876752,13.094916870326253,13.231144570775752,13.367372271225252,13.503599971674751,13.63982767212425,13.776055372573749,13.912283073023248],[4.7115057207081232,4.8477334211576224,4.9839611216071216,5.1201888220566216,5.2564165225061208,5.39264422295562,5.5288719234051191,5.6650996238546192,5.8013273243041183,5.9375550247536175,6.0737827252031167,6.2100104256526167,6.3462381261021159,6.4824658265516151,6.6186935270011151,6.7549212274506143,6.8911489279001135,7.0273766283496126,7.1636043287991118,7.2998320292486119,7.436059729698111,7.5722874301476102,7.7085151305971102,7.8447428310466094,7.9809705314961086,8.1171982319456077,8.2534259323951069,8.3896536328446061,8.5258813332941052,8.6621090337436044,8.7983367341931036,8.9345644346426027,9.0707921350921037,9.2070198355416029,9.343247535991102,9.479475236440603,9.6157029368901021,9.7519306373396013,9.8881583377891005,10.0243860382386,10.160613738688099,10.296841439137598,10.433069139587097,10.569296840036596,10.705524540486095,10.841752240935595,10.977979941385096,11.114207641834593,11.250435342284092,11.386663042733593,11.522890743183092,11.659118443632593,11.795346144082091,11.931573844531592,12.067801544981091,12.20402924543059,12.340256945880089,12.476484646329588,12.612712346779087,12.748940047228587,12.885167747678086,13.021395448127587,13.157623148577084,13.293850849026585,13.430078549476084,13.566306249925583,13.702533950375082,13.838761650824582,13.974989351274081,14.11121705172358],[4.910439699408454,5.0466673998579532,5.1828951003074533,5.3191228007569524,5.4553505012064516,5.5915782016559508,5.7278059021054499,5.86403360255495,6.0002613030044492,6.1364890034539483,6.2727167039034484,6.4089444043529475,6.5451721048024467,6.6813998052519459,6.817627505701445,6.9538552061509442,7.0900829066004443,7.2263106070499434,7.3625383074994435,7.4987660079489427,7.6349937083984418,7.771221408847941,7.9074491092974402,8.0436768097469411,8.1799045101964385,8.3161322106459394,8.4523599110954386,8.5885876115449378,8.7248153119944369,8.8610430124439361,8.9972707128934353,9.1334984133429344,9.2697261137924336,9.4059538142419328,9.5421815146914319,9.6784092151409329,9.8146369155904321,9.9508646160399312,10.087092316489432,10.22332001693893,10.35954771738843,10.49577541783793,10.632003118287429,10.768230818736928,10.904458519186427,11.040686219635926,11.176913920085426,11.313141620534925,11.449369320984424,11.585597021433923,11.721824721883422,11.858052422332923,11.994280122782421,12.130507823231921,12.266735523681421,12.402963224130922,12.539190924580421,12.675418625029918,12.811646325479419,12.947874025928918,13.084101726378417,13.220329426827917,13.356557127277416,13.492784827726915,13.629012528176414,13.765240228625913,13.901467929075412,14.037695629524912,14.173923329974411,14.31015103042391],[5.1093736781087848,5.245601378558284,5.3818290790077832,5.5180567794572832,5.6542844799067824,5.7905121803562816,5.9267398808057807,6.0629675812552808,6.19919528170478,6.3354229821542791,6.4716506826037783,6.6078783830532783,6.7441060835027775,6.8803337839522767,7.0165614844017767,7.1527891848512759,7.2890168853007751,7.4252445857502742,7.5614722861997734,7.6976999866492735,7.8339276870987726,7.9701553875482718,8.1063830879977719,8.242610788447271,8.3788384888967702,8.5150661893462694,8.6512938897957685,8.7875215902452677,8.9237492906947686,9.0599769911442678,9.196204691593767,9.3324323920432661,9.4686600924927653,9.6048877929422645,9.7411154933917636,9.8773431938412628,10.013570894290762,10.149798594740261,10.286026295189762,10.422253995639259,10.55848169608876,10.69470939653826,10.830937096987759,10.96716479743726,11.103392497886759,11.239620198336258,11.375847898785757,11.512075599235256,11.648303299684756,11.784531000134255,11.920758700583754,12.056986401033253,12.193214101482752,12.329441801932251,12.465669502381751,12.601897202831251,12.738124903280751,12.874352603730248,13.010580304179749,13.146808004629248,13.283035705078747,13.419263405528248,13.555491105977746,13.691718806427247,13.827946506876746,13.964174207326245,14.100401907775744,14.236629608225243,14.372857308674742,14.509085009124242],[5.3083076568091165,5.4445353572586157,5.5807630577081149,5.7169907581576149,5.8532184586071141,5.9894461590566133,6.1256738595061124,6.2619015599556125,6.3981292604051117,6.5343569608546108,6.67058466130411,6.80681236175361,6.9430400622031092,7.0792677626526084,7.2154954631021084,7.3517231635516076,7.4879508640011068,7.6241785644506059,7.7604062649001051,7.8966339653496052,8.0328616657991034,8.1690893662486026,8.3053170666981035,8.4415447671476027,8.5777724675971019,8.714000168046601,8.8502278684961002,8.9864555689455994,9.1226832693951003,9.2589109698445995,9.3951386702940987,9.5313663707435978,9.667594071193097,9.8038217716425962,9.9400494720920953,10.076277172541594,10.212504872991094,10.348732573440593,10.484960273890094,10.621187974339591,10.757415674789092,10.893643375238591,11.02987107568809,11.166098776137591,11.302326476587091,11.43855417703659,11.574781877486089,11.711009577935588,11.847237278385087,11.983464978834586,12.119692679284086,12.255920379733585,12.392148080183084,12.528375780632583,12.664603481082082,12.800831181531583,12.937058881981082,13.07328658243058,13.209514282880081,13.34574198332958,13.481969683779079,13.61819738422858,13.754425084678077,13.890652785127578,14.026880485577077,14.163108186026577,14.299335886476076,14.435563586925575,14.571791287375074,14.708018987824573],[5.5072416355094465,5.6434693359589456,5.7796970364084448,5.9159247368579448,6.052152437307444,6.1883801377569432,6.3246078382064423,6.4608355386559424,6.5970632391054416,6.7332909395549407,6.8695186400044399,7.00574634045394,7.1419740409034391,7.2782017413529383,7.4144294418024383,7.5506571422519375,7.6868848427014367,7.8231125431509358,7.959340243600435,8.095567944049936,8.2317956444994351,8.3680233449489343,8.5042510453984335,8.6404787458479326,8.7767064462974318,8.912934146746931,9.0491618471964301,9.1853895476459293,9.3216172480954285,9.4578449485449276,9.5940726489944268,9.730300349443926,9.8665280498934269,10.002755750342926,10.138983450792425,10.275211151241926,10.411438851691425,10.547666552140925,10.683894252590424,10.820121953039923,10.956349653489422,11.092577353938921,11.22880505438842,11.36503275483792,11.501260455287419,11.637488155736918,11.773715856186419,11.909943556635916,12.046171257085415,12.182398957534916,12.318626657984415,12.454854358433916,12.591082058883414,12.727309759332915,12.863537459782414,12.999765160231913,13.135992860681412,13.272220561130911,13.408448261580411,13.54467596202991,13.680903662479409,13.81713136292891,13.953359063378407,14.089586763827908,14.225814464277407,14.362042164726907,14.498269865176406,14.634497565625905,14.770725266075404,14.906952966524903],[5.7061756142097781,5.8424033146592773,5.9786310151087765,6.1148587155582765,6.2510864160077757,6.3873141164572749,6.523541816906774,6.6597695173562741,6.7959972178057733,6.9322249182552724,7.0684526187047716,7.2046803191542717,7.3409080196037708,7.47713572005327,7.61336342050277,7.7495911209522692,7.8858188214017684,8.0220465218512675,8.1582742223007667,8.2945019227502677,8.4307296231997668,8.566957323649266,8.7031850240987652,8.8394127245482643,8.9756404249977635,9.1118681254472627,9.2480958258967618,9.384323526346261,9.5205512267957602,9.6567789272452593,9.7930066276947585,9.9292343281442577,10.065462028593759,10.201689729043258,10.337917429492757,10.474145129942258,10.610372830391757,10.746600530841256,10.882828231290755,11.019055931740255,11.155283632189754,11.291511332639253,11.427739033088752,11.563966733538251,11.70019443398775,11.83642213443725,11.97264983488675,12.108877535336248,12.245105235785747,12.381332936235248,12.517560636684747,12.653788337134248,12.790016037583746,12.926243738033246,13.062471438482746,13.198699138932245,13.334926839381744,13.471154539831243,13.607382240280742,13.743609940730241,13.879837641179741,14.016065341629242,14.152293042078739,14.28852074252824,14.424748442977739,14.560976143427238,14.697203843876737,14.833431544326237,14.969659244775736,15.105886945225235],[5.9051095929101098,6.041337293359609,6.1775649938091082,6.3137926942586082,6.4500203947081074,6.5862480951576066,6.7224757956071057,6.8587034960566058,6.994931196506105,7.1311588969556041,7.2673865974051033,7.4036142978546033,7.5398419983041025,7.6760696987536017,7.8122973992031017,7.9485250996526009,8.0847528001021001,8.2209805005515992,8.3572082010010984,8.4934359014505993,8.6296636019000985,8.7658913023495977,8.9021190027990968,9.038346703248596,9.1745744036980952,9.3108021041475943,9.4470298045970935,9.5832575050465927,9.7194852054960919,9.855712905945591,9.9919406063950902,10.128168306844589,10.26439600729409,10.400623707743589,10.536851408193089,10.67307910864259,10.809306809092089,10.945534509541588,11.081762209991087,11.217989910440586,11.354217610890085,11.490445311339585,11.626673011789084,11.762900712238583,11.899128412688082,12.035356113137581,12.171583813587082,12.30781151403658,12.444039214486079,12.58026691493558,12.716494615385079,12.85272231583458,12.988950016284077,13.125177716733578,13.261405417183077,13.397633117632576,13.533860818082076,13.670088518531575,13.806316218981074,13.942543919430573,14.078771619880072,14.214999320329573,14.351227020779071,14.487454721228572,14.623682421678071,14.75991012212757,14.896137822577069,15.032365523026568,15.168593223476067,15.304820923925567],[6.1040435716104398,6.2402712720599389,6.3764989725094381,6.5127266729589381,6.6489543734084373,6.7851820738579365,6.9214097743074356,7.0576374747569357,7.1938651752064349,7.330092875655934,7.4663205761054332,7.6025482765549333,7.7387759770044324,7.8750036774539316,8.0112313779034316,8.1474590783529308,8.28368677880243,8.4199144792519292,8.5561421797014283,8.6923698801509275,8.8285975806004267,8.9648252810499258,9.1010529814994268,9.2372806819489259,9.3735083823984251,9.5097360828479243,9.6459637832974234,9.7821914837469226,9.9184191841964235,10.054646884645923,10.190874585095422,10.327102285544921,10.46332998599442,10.599557686443919,10.735785386893419,10.872013087342918,11.008240787792417,11.144468488241916,11.280696188691417,11.416923889140914,11.553151589590415,11.689379290039914,11.825606990489414,11.961834690938915,12.098062391388414,12.234290091837913,12.370517792287412,12.506745492736911,12.64297319318641,12.77920089363591,12.915428594085409,13.051656294534908,13.187883994984407,13.324111695433906,13.460339395883405,13.596567096332906,13.732794796782406,13.869022497231903,14.005250197681404,14.141477898130903,14.277705598580402,14.413933299029903,14.550160999479401,14.686388699928902,14.822616400378401,14.9588441008279,15.095071801277399,15.231299501726898,15.367527202176397,15.503754902625897],[6.3029775503107714,6.4392052507602706,6.5754329512097698,6.7116606516592698,6.847888352108769,6.9841160525582682,7.1203437530077673,7.2565714534572674,7.3927991539067666,7.5290268543562657,7.6652545548057649,7.801482255255265,7.9377099557047641,8.0739376561542642,8.2101653566037633,8.3463930570532625,8.4826207575027617,8.6188484579522608,8.75507615840176,8.8913038588512592,9.0275315593007583,9.1637592597502575,9.2999869601997585,9.4362146606492576,9.5724423610987568,9.708670061548256,9.8448977619977551,9.9811254624472543,10.117353162896755,10.253580863346254,10.389808563795754,10.526036264245253,10.662263964694752,10.798491665144251,10.93471936559375,11.070947066043249,11.207174766492749,11.343402466942248,11.479630167391749,11.615857867841246,11.752085568290747,11.888313268740246,12.024540969189745,12.160768669639246,12.296996370088745,12.433224070538245,12.569451770987744,12.705679471437243,12.841907171886742,12.978134872336241,13.11436257278574,13.25059027323524,13.386817973684739,13.523045674134238,13.659273374583737,13.795501075033238,13.931728775482737,14.067956475932235,14.204184176381736,14.340411876831235,14.476639577280734,14.612867277730235,14.749094978179732,14.885322678629233,15.021550379078732,15.157778079528232,15.294005779977731,15.43023348042723,15.566461180876729,15.702688881326228],[6.5019115290111023,6.6381392294606014,6.7743669299101015,6.9105946303596006,7.0468223308090998,7.183050031258599,7.3192777317080981,7.4555054321575982,7.5917331326070974,7.7279608330565965,7.8641885335060966,8.0004162339555958,8.1366439344050949,8.2728716348545941,8.4090993353040933,8.5453270357535924,8.6815547362030934,8.8177824366525925,8.9540101371020917,9.0902378375515909,9.22646553800109,9.3626932384505892,9.4989209389000884,9.6351486393495875,9.7713763397990867,9.9076040402485859,10.043831740698085,10.180059441147586,10.316287141597085,10.452514842046584,10.588742542496083,10.724970242945583,10.861197943395084,10.997425643844583,11.133653344294082,11.269881044743581,11.40610874519308,11.542336445642579,11.678564146092079,11.814791846541578,11.951019546991077,12.087247247440576,12.223474947890075,12.359702648339576,12.495930348789075,12.632158049238575,12.768385749688075,12.904613450137573,13.040841150587072,13.177068851036573,13.313296551486072,13.449524251935571,13.58575195238507,13.72197965283457,13.858207353284069,13.994435053733568,14.130662754183067,14.266890454632566,14.403118155082065,14.539345855531565,14.675573555981064,14.811801256430567,14.948028956880062,15.084256657329565,15.220484357779064,15.356712058228563,15.492939758678062,15.629167459127562,15.765395159577061,15.90162286002656],[6.7008455077114331,6.8370732081609322,6.9733009086104314,7.1095286090599314,7.2457563095094306,7.3819840099589298,7.5182117104084289,7.654439410857929,7.7906671113074282,7.9268948117569273,8.0631225122064265,8.1993502126559257,8.3355779131054248,8.471805613554924,8.608033314004425,8.7442610144539241,8.8804887149034233,9.0167164153529225,9.1529441158024216,9.2891718162519226,9.4253995167014217,9.5616272171509209,9.6978549176004201,9.8340826180499192,9.9703103184994184,10.106538018948918,10.242765719398417,10.378993419847916,10.515221120297415,10.651448820746914,10.787676521196413,10.923904221645913,11.060131922095414,11.196359622544913,11.332587322994412,11.468815023443913,11.605042723893412,11.741270424342911,11.87749812479241,12.013725825241909,12.149953525691409,12.286181226140908,12.422408926590407,12.558636627039906,12.694864327489405,12.831092027938904,12.967319728388405,13.103547428837903,13.239775129287402,13.376002829736903,13.512230530186402,13.648458230635903,13.7846859310854,13.920913631534901,14.057141331984401,14.1933690324339,14.329596732883399,14.465824433332898,14.602052133782397,14.738279834231896,14.874507534681396,15.010735235130896,15.146962935580394,15.283190636029895,15.419418336479394,15.555646036928893,15.691873737378392,15.828101437827891,15.964329138277391,16.100556838726888],[6.8997794864117648,7.0360071868612639,7.1722348873107631,7.3084625877602631,7.4446902882097623,7.5809179886592615,7.7171456891087606,7.8533733895582607,7.9896010900077599,8.125828790457259,8.2620564909067582,8.3982841913562574,8.5345118918057565,8.6707395922552557,8.8069672927047566,8.9431949931542558,9.079422693603755,9.2156503940532541,9.3518780945027533,9.4881057949522543,9.6243334954017534,9.7605611958512526,9.8967888963007518,10.033016596750251,10.16924429719975,10.305471997649249,10.441699698098748,10.577927398548248,10.714155098997747,10.850382799447246,10.986610499896745,11.122838200346244,11.259065900795745,11.395293601245244,11.531521301694744,11.667749002144244,11.803976702593744,11.940204403043243,12.076432103492742,12.212659803942241,12.34888750439174,12.485115204841239,12.621342905290739,12.757570605740238,12.893798306189737,13.030026006639236,13.166253707088737,13.302481407538234,13.438709107987734,13.574936808437235,13.711164508886734,13.847392209336235,13.983619909785732,14.119847610235233,14.256075310684732,14.392303011134231,14.528530711583731,14.66475841203323,14.800986112482729,14.937213812932228,15.073441513381727,15.209669213831228,15.345896914280726,15.482124614730226,15.618352315179726,15.754580015629225,15.890807716078724,16.027035416528221,16.163263116977724,16.29949081742722],[7.0987134651120956,7.2349411655615947,7.3711688660110948,7.5073965664605939,7.6436242669100931,7.7798519673595923,7.9160796678090914,8.0523073682585906,8.1885350687080916,8.3247627691575907,8.4609904696070899,8.5972181700565891,8.7334458705060882,8.8696735709555874,9.0059012714050866,9.1421289718545857,9.2783566723040849,9.4145843727535841,9.550812073203085,9.6870397736525842,9.8232674741020833,9.9594951745515825,10.095722875001082,10.231950575450583,10.36817827590008,10.504405976349581,10.64063367679908,10.776861377248579,10.913089077698078,11.049316778147578,11.185544478597077,11.321772179046576,11.457999879496075,11.594227579945574,11.730455280395073,11.866682980844574,12.002910681294074,12.139138381743573,12.275366082193074,12.411593782642571,12.547821483092072,12.684049183541571,12.82027688399107,12.95650458444057,13.092732284890069,13.228959985339568,13.365187685789067,13.501415386238566,13.637643086688065,13.773870787137565,13.910098487587064,14.046326188036565,14.182553888486062,14.318781588935563,14.455009289385062,14.591236989834563,14.727464690284062,14.86369239073356,14.999920091183061,15.13614779163256,15.272375492082059,15.408603192531558,15.544830892981057,15.681058593430556,15.817286293880056,15.953513994329555,16.089741694779054,16.225969395228553,16.362197095678052,16.498424796127551],[7.2976474438124264,7.4338751442619255,7.5701028447114247,7.7063305451609247,7.8425582456104239,7.9787859460599231,8.1150136465094231,8.2512413469589223,8.3874690474084215,8.5236967478579206,8.6599244483074198,8.796152148756919,8.9323798492064181,9.0686075496559191,9.2048352501054183,9.3410629505549174,9.4772906510044166,9.6135183514539158,9.7497460519034149,9.8859737523529141,10.022201452802413,10.158429153251912,10.294656853701413,10.430884554150913,10.567112254600412,10.703339955049911,10.83956765549941,10.975795355948909,11.11202305639841,11.248250756847909,11.384478457297408,11.520706157746908,11.656933858196407,11.793161558645906,11.929389259095405,12.065616959544904,12.201844659994403,12.338072360443903,12.474300060893404,12.610527761342901,12.746755461792402,12.882983162241901,13.0192108626914,13.155438563140901,13.2916662635904,13.4278939640399,13.564121664489399,13.700349364938898,13.836577065388397,13.972804765837896,14.109032466287395,14.245260166736895,14.381487867186394,14.517715567635893,14.653943268085392,14.790170968534893,14.926398668984392,15.06262636943389,15.19885406988339,15.33508177033289,15.471309470782389,15.60753717123189,15.743764871681387,15.879992572130888,16.016220272580387,16.152447973029886,16.288675673479386,16.424903373928885,16.561131074378384,16.697358774827883],[7.4965814225127581,7.6328091229622572,7.7690368234117564,7.9052645238612564,8.0414922243107547,8.1777199247602557,8.3139476252097548,8.450175325659254,8.5864030261087532,8.7226307265582523,8.8588584270077515,8.9950861274572507,9.1313138279067498,9.2675415283562508,9.4037692288057499,9.5399969292552491,9.6762246297047483,9.8124523301542474,9.9486800306037466,10.084907731053246,10.221135431502745,10.357363131952244,10.493590832401745,10.629818532851244,10.766046233300743,10.902273933750243,11.038501634199742,11.174729334649241,11.310957035098742,11.447184735548241,11.58341243599774,11.719640136447239,11.855867836896739,11.992095537346238,12.128323237795737,12.264550938245236,12.400778638694735,12.537006339144234,12.673234039593735,12.809461740043233,12.945689440492734,13.081917140942233,13.218144841391732,13.354372541841233,13.490600242290732,13.626827942740231,13.76305564318973,13.89928334363923,14.035511044088729,14.171738744538228,14.307966444987727,14.444194145437226,14.580421845886725,14.716649546336225,14.852877246785724,14.989104947235225,15.125332647684724,15.261560348134221,15.397788048583722,15.534015749033221,15.670243449482721,15.806471149932221,15.942698850381719,16.07892655083122,16.215154251280719,16.351381951730218,16.487609652179717,16.623837352629216,16.760065053078716,16.896292753528215],[7.6955154012130889,7.831743101662588,7.9679708021120881,8.1041985025615872,8.2404262030110864,8.3766539034605856,8.5128816039100847,8.6491093043595839,8.7853370048090831,8.921564705258584,9.0577924057080832,9.1940201061575824,9.3302478066070815,9.4664755070565807,9.6027032075060799,9.738930907955579,9.87515860840508,10.011386308854579,10.147614009304078,10.283841709753577,10.420069410203077,10.556297110652576,10.692524811102075,10.828752511551574,10.964980212001073,11.101207912450572,11.237435612900072,11.373663313349573,11.509891013799072,11.646118714248571,11.78234641469807,11.918574115147569,12.05480181559707,12.191029516046569,12.327257216496069,12.463484916945568,12.599712617395067,12.735940317844566,12.872168018294065,13.008395718743564,13.144623419193064,13.280851119642563,13.417078820092062,13.553306520541563,13.689534220991062,13.825761921440561,13.961989621890062,14.098217322339559,14.234445022789059,14.37067272323856,14.506900423688059,14.643128124137558,14.779355824587057,14.915583525036556,15.051811225486055,15.188038925935555,15.324266626385054,15.460494326834553,15.596722027284052,15.732949727733551,15.86917742818305,16.005405128632553,16.141632829082049,16.277860529531551,16.414088229981051,16.55031593043055,16.686543630880049,16.822771331329548,16.958999031779047,17.095226732228546],[7.8944493799134197,8.0306770803629188,8.166904780812418,8.3031324812619172,8.4393601817114181,8.5755878821609173,8.7118155826104164,8.8480432830599156,8.9842709835094148,9.1204986839589139,9.2567263844084131,9.3929540848579123,9.5291817853074114,9.6654094857569106,9.8016371862064116,9.9378648866559107,10.07409258710541,10.210320287554909,10.346547988004408,10.482775688453909,10.619003388903408,10.755231089352908,10.891458789802407,11.027686490251906,11.163914190701405,11.300141891150904,11.436369591600403,11.572597292049903,11.708824992499402,11.845052692948901,11.9812803933984,12.117508093847899,12.2537357942974,12.389963494746899,12.526191195196398,12.662418895645899,12.798646596095399,12.934874296544898,13.071101996994397,13.207329697443896,13.343557397893395,13.479785098342894,13.616012798792394,13.752240499241893,13.888468199691392,14.024695900140891,14.160923600590392,14.297151301039889,14.433379001489389,14.56960670193889,14.705834402388389,14.84206210283789,14.978289803287387,15.114517503736888,15.250745204186387,15.386972904635886,15.523200605085385,15.659428305534885,15.795656005984384,15.931883706433883,16.068111406883382,16.204339107332885,16.34056680778238,16.476794508231883,16.613022208681379,16.749249909130882,16.885477609580377,17.02170531002988,17.157933010479375,17.294160710928878],[8.0933833586137496,8.2296110590632487,8.3658387595127479,8.5020664599622471,8.6382941604117462,8.7745218608612472,8.9107495613107464,9.0469772617602455,9.1832049622097447,9.3194326626592439,9.455660363108743,9.5918880635582422,9.7281157640077414,9.8643434644572423,10.000571164906741,10.136798865356241,10.27302656580574,10.409254266255239,10.545481966704738,10.681709667154237,10.817937367603736,10.954165068053236,11.090392768502737,11.226620468952236,11.362848169401735,11.499075869851234,11.635303570300733,11.771531270750232,11.907758971199733,12.043986671649233,12.180214372098732,12.316442072548231,12.45266977299773,12.588897473447229,12.725125173896728,12.861352874346228,12.997580574795727,13.133808275245226,13.270035975694727,13.406263676144224,13.542491376593725,13.678719077043224,13.814946777492723,13.951174477942224,14.087402178391724,14.223629878841223,14.359857579290722,14.496085279740221,14.63231298018972,14.768540680639219,14.904768381088719,15.040996081538218,15.177223781987717,15.313451482437216,15.449679182886715,15.585906883336216,15.722134583785715,15.858362284235213,15.994589984684714,16.130817685134211,16.267045385583714,16.403273086033213,16.539500786482712,16.675728486932211,16.81195618738171,16.94818388783121,17.084411588280709,17.220639288730208,17.356866989179707,17.493094689629206],[8.2923173373140813,8.4285450377635804,8.5647727382130796,8.7010004386625788,8.8372281391120779,8.9734558395615789,9.1096835400110781,9.2459112404605772,9.3821389409100764,9.5183666413595756,9.6545943418090747,9.7908220422585739,9.9270497427080731,10.063277443157574,10.199505143607073,10.335732844056572,10.471960544506071,10.608188244955571,10.74441594540507,10.880643645854569,11.016871346304068,11.153099046753567,11.289326747203068,11.425554447652567,11.561782148102067,11.698009848551566,11.834237549001065,11.970465249450564,12.106692949900065,12.242920650349564,12.379148350799063,12.515376051248563,12.651603751698062,12.787831452147561,12.92405915259706,13.060286853046559,13.196514553496058,13.332742253945558,13.468969954395059,13.605197654844556,13.741425355294057,13.877653055743556,14.013880756193055,14.150108456642556,14.286336157092055,14.422563857541554,14.558791557991054,14.695019258440553,14.831246958890052,14.967474659339551,15.10370235978905,15.239930060238549,15.376157760688049,15.512385461137548,15.648613161587047,15.784840862036548,15.921068562486047,16.057296262935544,16.193523963385047,16.329751663834543,16.465979364284046,16.602207064733545,16.738434765183044,16.874662465632543,17.010890166082042,17.147117866531541,17.283345566981041,17.41957326743054,17.555800967880039,17.692028668329538],[8.491251316014413,8.6274790164639121,8.7637067169134113,8.8999344173629105,9.0361621178124096,9.1723898182619106,9.3086175187114097,9.4448452191609089,9.5810729196104081,9.7173006200599072,9.8535283205094064,9.9897560209589056,10.125983721408405,10.262211421857906,10.398439122307405,10.534666822756904,10.670894523206403,10.807122223655902,10.943349924105402,11.079577624554901,11.2158053250044,11.352033025453899,11.4882607259034,11.624488426352899,11.760716126802398,11.896943827251897,12.033171527701397,12.169399228150896,12.305626928600397,12.441854629049896,12.578082329499395,12.714310029948894,12.850537730398393,12.986765430847893,13.122993131297392,13.259220831746891,13.39544853219639,13.531676232645889,13.66790393309539,13.804131633544888,13.940359333994389,14.076587034443888,14.212814734893387,14.349042435342888,14.485270135792387,14.621497836241886,14.757725536691385,14.893953237140884,15.030180937590384,15.166408638039883,15.302636338489382,15.438864038938881,15.57509173938838,15.711319439837879,15.847547140287379,15.98377484073688,16.120002541186381,16.256230241635876,16.392457942085379,16.528685642534874,16.664913342984377,16.801141043433876,16.937368743883376,17.073596444332875,17.209824144782374,17.346051845231873,17.482279545681372,17.618507246130871,17.754734946580371,17.89096264702987],[8.6901852947147447,8.8264129951642438,8.962640695613743,9.0988683960632422,9.2350960965127413,9.3713237969622423,9.5075514974117414,9.6437791978612406,9.7800068983107398,9.9162345987602389,10.052462299209738,10.188689999659237,10.324917700108736,10.461145400558237,10.597373101007737,10.733600801457236,10.869828501906735,11.006056202356234,11.142283902805733,11.278511603255232,11.414739303704732,11.550967004154231,11.687194704603732,11.823422405053231,11.95965010550273,12.095877805952229,12.232105506401728,12.368333206851228,12.504560907300728,12.640788607750228,12.777016308199727,12.913244008649226,13.049471709098725,13.185699409548224,13.321927109997723,13.458154810447223,13.594382510896722,13.730610211346221,13.866837911795722,14.003065612245219,14.13929331269472,14.275521013144219,14.411748713593719,14.54797641404322,14.684204114492719,14.820431814942218,14.956659515391717,15.092887215841216,15.229114916290715,15.365342616740215,15.501570317189714,15.637798017639213,15.774025718088712,15.910253418538211,16.04648111898771,16.18270881943721,16.318936519886712,16.455164220336208,16.591391920785711,16.727619621235206,16.863847321684709,17.000075022134208,17.136302722583707,17.272530423033206,17.408758123482706,17.544985823932205,17.681213524381704,17.817441224831203,17.953668925280702,18.089896625730201],[8.8891192734150763,9.0253469738645755,9.1615746743140747,9.2978023747635739,9.434030075213073,9.570257775662574,9.7064854761120731,9.8427131765615723,9.9789408770110715,10.115168577460571,10.25139627791007,10.387623978359569,10.523851678809068,10.660079379258569,10.796307079708068,10.932534780157567,11.068762480607067,11.204990181056566,11.341217881506065,11.477445581955564,11.613673282405063,11.749900982854562,11.886128683304063,12.022356383753563,12.158584084203062,12.294811784652561,12.43103948510206,12.567267185551559,12.70349488600106,12.839722586450559,12.975950286900058,13.112177987349558,13.248405687799057,13.384633388248556,13.520861088698055,13.657088789147554,13.793316489597053,13.929544190046553,14.065771890496054,14.201999590945551,14.338227291395052,14.474454991844551,14.61068269229405,14.746910392743551,14.88313809319305,15.01936579364255,15.155593494092049,15.291821194541548,15.428048894991047,15.564276595440546,15.700504295890045,15.836731996339545,15.972959696789044,16.109187397238543,16.245415097688042,16.381642798137541,16.517870498587044,16.65409819903654,16.790325899486042,16.926553599935538,17.062781300385041,17.19900900083454,17.335236701284039,17.471464401733538,17.607692102183037,17.743919802632536,17.880147503082036,18.016375203531535,18.152602903981034,18.288830604430533],[9.0880532521154045,9.2242809525649037,9.3605086530144028,9.496736353463902,9.6329640539134012,9.7691917543629021,9.9054194548124013,10.0416471552619,10.1778748557114,10.314102556160899,10.450330256610398,10.586557957059897,10.722785657509396,10.859013357958897,10.995241058408396,11.131468758857896,11.267696459307395,11.403924159756894,11.540151860206393,11.676379560655892,11.812607261105391,11.948834961554891,12.085062662004391,12.221290362453891,12.35751806290339,12.493745763352889,12.629973463802388,12.766201164251887,12.902428864701388,13.038656565150887,13.174884265600387,13.311111966049886,13.447339666499385,13.583567366948884,13.719795067398383,13.856022767847882,13.992250468297382,14.128478168746881,14.264705869196382,14.400933569645879,14.53716127009538,14.673388970544879,14.809616670994378,14.945844371443879,15.082072071893379,15.218299772342878,15.354527472792377,15.490755173241876,15.626982873691375,15.763210574140874,15.899438274590374,16.035665975039873,16.171893675489372,16.308121375938871,16.44434907638837,16.580576776837873,16.716804477287369,16.853032177736868,16.989259878186367,17.12548757863587,17.261715279085365,17.397942979534868,17.534170679984364,17.670398380433866,17.806626080883365,17.942853781332865,18.079081481782364,18.215309182231863,18.351536882681362,18.487764583130861],[9.2869872308157362,9.4232149312652354,9.5594426317147345,9.6956703321642337,9.8318980326137329,9.9681257330632338,10.104353433512733,10.240581133962232,10.376808834411731,10.51303653486123,10.64926423531073,10.785491935760229,10.921719636209728,11.057947336659229,11.194175037108728,11.330402737558227,11.466630438007726,11.602858138457226,11.739085838906725,11.875313539356224,12.011541239805723,12.147768940255222,12.283996640704723,12.420224341154222,12.556452041603722,12.692679742053221,12.82890744250272,12.965135142952219,13.10136284340172,13.237590543851219,13.373818244300718,13.510045944750217,13.646273645199717,13.782501345649216,13.918729046098715,14.054956746548214,14.191184446997713,14.327412147447212,14.463639847896713,14.599867548346211,14.736095248795712,14.872322949245211,15.00855064969471,15.144778350144211,15.28100605059371,15.417233751043209,15.553461451492709,15.689689151942208,15.825916852391707,15.962144552841206,16.098372253290705,16.234599953740204,16.370827654189704,16.507055354639203,16.643283055088702,16.779510755538205,16.9157384559877,17.051966156437199,17.188193856886699,17.324421557336201,17.460649257785697,17.5968769582352,17.733104658684695,17.869332359134198,18.005560059583697,18.141787760033196,18.278015460482695,18.414243160932195,18.550470861381694,18.686698561831193],[9.4859212095160679,9.622148909965567,9.7583766104150662,9.8946043108645654,10.030832011314065,10.167059711763565,10.303287412213065,10.439515112662564,10.575742813112063,10.711970513561562,10.848198214011061,10.98442591446056,11.12065361491006,11.256881315359561,11.39310901580906,11.529336716258559,11.665564416708058,11.801792117157557,11.938019817607056,12.074247518056556,12.210475218506055,12.346702918955554,12.482930619405055,12.619158319854554,12.755386020304053,12.891613720753552,13.027841421203052,13.164069121652551,13.300296822102052,13.436524522551551,13.57275222300105,13.708979923450549,13.845207623900048,13.981435324349547,14.117663024799047,14.253890725248546,14.390118425698045,14.526346126147544,14.662573826597045,14.798801527046543,14.935029227496043,15.071256927945543,15.207484628395042,15.343712328844543,15.479940029294042,15.616167729743541,15.75239543019304,15.888623130642539,16.024850831092039,16.161078531541538,16.297306231991037,16.433533932440536,16.569761632890035,16.705989333339534,16.842217033789034,16.978444734238536,17.114672434688032,17.250900135137531,17.38712783558703,17.523355536036533,17.659583236486029,17.795810936935531,17.932038637385027,18.06826633783453,18.204494038284029,18.340721738733528,18.476949439183027,18.613177139632526,18.749404840082025,18.885632540531525],[9.6848551882163996,9.8210828886658987,9.9573105891153979,10.093538289564897,10.229765990014396,10.365993690463897,10.502221390913396,10.638449091362896,10.774676791812395,10.910904492261894,11.047132192711393,11.183359893160892,11.319587593610391,11.455815294059892,11.592042994509391,11.728270694958891,11.86449839540839,12.000726095857889,12.136953796307388,12.273181496756887,12.409409197206386,12.545636897655886,12.681864598105387,12.818092298554886,12.954319999004385,13.090547699453884,13.226775399903383,13.363003100352882,13.499230800802383,13.635458501251883,13.771686201701382,13.907913902150881,14.04414160260038,14.180369303049879,14.316597003499378,14.452824703948878,14.589052404398377,14.725280104847876,14.861507805297377,14.997735505746874,15.133963206196375,15.270190906645874,15.406418607095373,15.542646307544874,15.678874007994374,15.815101708443873,15.951329408893372,16.087557109342871,16.22378480979237,16.360012510241869,16.496240210691369,16.632467911140868,16.768695611590367,16.904923312039866,17.041151012489365,17.177378712938868,17.313606413388364,17.449834113837863,17.586061814287362,17.722289514736865,17.85851721518636,17.994744915635863,18.130972616085359,18.267200316534861,18.40342801698436,18.53965571743386,18.675883417883359,18.812111118332858,18.948338818782357,19.084566519231856],[9.8837891669167313,10.02001686736623,10.15624456781573,10.292472268265229,10.428699968714728,10.564927669164229,10.701155369613728,10.837383070063227,10.973610770512726,11.109838470962226,11.246066171411725,11.382293871861224,11.518521572310723,11.654749272760224,11.790976973209723,11.927204673659222,12.063432374108721,12.199660074558221,12.33588777500772,12.472115475457219,12.608343175906718,12.744570876356217,12.880798576805718,13.017026277255217,13.153253977704717,13.289481678154216,13.425709378603715,13.561937079053214,13.698164779502715,13.834392479952214,13.970620180401713,14.106847880851213,14.243075581300712,14.379303281750211,14.51553098219971,14.651758682649209,14.787986383098708,14.924214083548208,15.060441783997708,15.196669484447206,15.332897184896707,15.469124885346206,15.605352585795705,15.741580286245206,15.877807986694705,16.014035687144204,16.150263387593704,16.286491088043203,16.422718788492702,16.558946488942201,16.6951741893917,16.831401889841199,16.967629590290699,17.103857290740198,17.240084991189697,17.3763126916392,17.512540392088695,17.648768092538194,17.784995792987694,17.921223493437196,18.057451193886692,18.193678894336195,18.32990659478569,18.466134295235193,18.602361995684692,18.738589696134191,18.874817396583691,19.01104509703319,19.147272797482689,19.283500497932188],[10.082723145617061,10.21895084606656,10.35517854651606,10.491406246965559,10.62763394741506,10.763861647864559,10.900089348314058,11.036317048763557,11.172544749213056,11.308772449662555,11.445000150112055,11.581227850561554,11.717455551011053,11.853683251460552,11.989910951910053,12.126138652359552,12.262366352809051,12.398594053258551,12.53482175370805,12.671049454157551,12.80727715460705,12.943504855056549,13.079732555506048,13.215960255955547,13.352187956405047,13.488415656854546,13.624643357304045,13.760871057753544,13.897098758203043,14.033326458652542,14.169554159102042,14.305781859551541,14.442009560001042,14.578237260450541,14.71446496090004,14.850692661349541,14.98692036179904,15.123148062248539,15.259375762698038,15.395603463147538,15.531831163597037,15.668058864046536,15.804286564496035,15.940514264945534,16.076741965395033,16.212969665844533,16.349197366294035,16.485425066743531,16.62165276719303,16.757880467642529,16.894108168092032,17.030335868541531,17.16656356899103,17.302791269440529,17.439018969890029,17.575246670339528,17.711474370789027,17.847702071238526,17.983929771688025,18.120157472137524,18.256385172587024,18.392612873036526,18.528840573486022,18.665068273935525,18.80129597438502,18.937523674834523,19.073751375284019,19.209979075733521,19.346206776183017,19.48243447663252],[10.281657124317391,10.41788482476689,10.554112525216389,10.690340225665889,10.826567926115388,10.962795626564889,11.099023327014388,11.235251027463887,11.371478727913386,11.507706428362885,11.643934128812385,11.780161829261884,11.916389529711383,12.052617230160884,12.188844930610383,12.325072631059882,12.461300331509381,12.59752803195888,12.73375573240838,12.869983432857879,13.006211133307378,13.142438833756877,13.278666534206378,13.414894234655877,13.551121935105376,13.687349635554876,13.823577336004375,13.959805036453874,14.096032736903375,14.232260437352874,14.368488137802373,14.504715838251872,14.640943538701372,14.777171239150871,14.91339893960037,15.049626640049869,15.185854340499368,15.322082040948867,15.458309741398368,15.594537441847866,15.730765142297367,15.866992842746866,16.003220543196363,16.139448243645866,16.275675944095365,16.411903644544864,16.548131344994363,16.684359045443863,16.820586745893362,16.956814446342861,17.09304214679236,17.229269847241859,17.365497547691358,17.501725248140858,17.637952948590357,17.774180649039856,17.910408349489359,18.046636049938854,18.182863750388357,18.319091450837853,18.455319151287355,18.591546851736855,18.727774552186354,18.864002252635853,19.000229953085352,19.136457653534851,19.27268535398435,19.40891305443385,19.545140754883349,19.681368455332848],[10.480591103017723,10.616818803467222,10.753046503916721,10.88927420436622,11.025501904815719,11.16172960526522,11.29795730571472,11.434185006164219,11.570412706613718,11.706640407063217,11.842868107512716,11.979095807962215,12.115323508411715,12.251551208861216,12.387778909310715,12.524006609760214,12.660234310209713,12.796462010659212,12.932689711108711,13.068917411558211,13.20514511200771,13.341372812457209,13.47760051290671,13.613828213356209,13.750055913805708,13.886283614255207,14.022511314704706,14.158739015154206,14.294966715603707,14.431194416053206,14.567422116502705,14.703649816952204,14.839877517401703,14.976105217851202,15.112332918300702,15.248560618750201,15.3847883191997,15.521016019649199,15.6572437200987,15.793471420548197,15.929699120997698,16.065926821447199,16.202154521896695,16.338382222346198,16.474609922795697,16.610837623245196,16.747065323694695,16.883293024144194,17.019520724593693,17.155748425043193,17.291976125492692,17.428203825942191,17.56443152639169,17.700659226841189,17.836886927290688,17.973114627740188,18.10934232818969,18.245570028639186,18.381797729088689,18.518025429538184,18.654253129987687,18.790480830437186,18.926708530886685,19.062936231336185,19.199163931785684,19.335391632235183,19.471619332684682,19.607847033134181,19.74407473358368,19.88030243403318],[10.679525081718054,10.815752782167554,10.951980482617053,11.088208183066552,11.224435883516051,11.360663583965552,11.496891284415051,11.63311898486455,11.76934668531405,11.905574385763549,12.041802086213048,12.178029786662547,12.314257487112046,12.450485187561547,12.586712888011046,12.722940588460546,12.859168288910045,12.995395989359544,13.131623689809043,13.267851390258542,13.404079090708041,13.540306791157541,13.676534491607041,13.812762192056541,13.94898989250604,14.085217592955539,14.221445293405038,14.357672993854537,14.493900694304038,14.630128394753537,14.766356095203037,14.902583795652536,15.038811496102035,15.175039196551534,15.311266897001033,15.447494597450532,15.583722297900032,15.719949998349531,15.856177698799032,15.992405399248529,16.128633099698028,16.264860800147531,16.401088500597027,16.537316201046529,16.673543901496028,16.809771601945528,16.945999302395027,17.082227002844526,17.218454703294025,17.354682403743524,17.490910104193023,17.627137804642523,17.763365505092022,17.899593205541521,18.03582090599102,18.172048606440519,18.308276306890022,18.444504007339518,18.58073170778902,18.716959408238516,18.853187108688019,18.989414809137518,19.125642509587017,19.261870210036516,19.398097910486015,19.534325610935515,19.670553311385014,19.806781011834513,19.943008712284012,20.079236412733511],[10.878459060418386,11.014686760867885,11.150914461317385,11.287142161766884,11.423369862216383,11.559597562665884,11.695825263115383,11.832052963564882,11.968280664014381,12.10450836446388,12.24073606491338,12.376963765362879,12.513191465812378,12.649419166261879,12.785646866711378,12.921874567160877,13.058102267610376,13.194329968059876,13.330557668509375,13.466785368958874,13.603013069408373,13.739240769857872,13.875468470307373,14.011696170756872,14.147923871206372,14.284151571655871,14.42037927210537,14.556606972554869,14.69283467300437,14.829062373453869,14.965290073903368,15.101517774352867,15.237745474802367,15.373973175251866,15.510200875701365,15.646428576150864,15.782656276600363,15.918883977049862,16.055111677499362,16.191339377948861,16.32756707839836,16.463794778847863,16.600022479297358,16.736250179746861,16.87247788019636,17.008705580645859,17.144933281095359,17.281160981544858,17.417388681994357,17.553616382443856,17.689844082893355,17.826071783342854,17.962299483792354,18.098527184241853,18.234754884691352,18.370982585140851,18.507210285590354,18.643437986039849,18.779665686489352,18.915893386938848,19.05212108738835,19.18834878783785,19.324576488287349,19.460804188736848,19.597031889186347,19.733259589635846,19.869487290085345,20.005714990534845,20.141942690984344,20.278170391433843],[11.077393039118716,11.213620739568215,11.349848440017714,11.486076140467214,11.622303840916715,11.758531541366214,11.894759241815713,12.030986942265212,12.167214642714711,12.30344234316421,12.43967004361371,12.575897744063209,12.712125444512708,12.848353144962207,12.984580845411708,13.120808545861207,13.257036246310706,13.393263946760205,13.529491647209705,13.665719347659206,13.801947048108705,13.938174748558204,14.074402449007703,14.210630149457202,14.346857849906701,14.483085550356201,14.6193132508057,14.755540951255199,14.891768651704698,15.027996352154197,15.164224052603696,15.300451753053196,15.436679453502697,15.572907153952196,15.709134854401695,15.845362554851196,15.981590255300695,16.117817955750194,16.254045656199693,16.390273356649192,16.526501057098692,16.662728757548191,16.79895645799769,16.935184158447189,17.071411858896688,17.207639559346187,17.343867259795687,17.480094960245186,17.616322660694685,17.752550361144188,17.888778061593683,18.025005762043186,18.161233462492682,18.297461162942184,18.433688863391684,18.569916563841183,18.706144264290682,18.842371964740181,18.97859966518968,19.114827365639179,19.251055066088679,19.387282766538178,19.523510466987677,19.659738167437176,19.795965867886679,19.932193568336174,20.068421268785677,20.204648969235173,20.340876669684675,20.477104370134171],[11.276327017819048,11.412554718268547,11.548782418718046,11.685010119167545,11.821237819617046,11.957465520066545,12.093693220516045,12.229920920965544,12.366148621415043,12.502376321864542,12.638604022314041,12.77483172276354,12.91105942321304,13.047287123662539,13.18351482411204,13.319742524561539,13.455970225011038,13.592197925460537,13.728425625910036,13.864653326359537,14.000881026809036,14.137108727258536,14.273336427708035,14.409564128157534,14.545791828607033,14.682019529056532,14.818247229506031,14.954474929955531,15.09070263040503,15.226930330854529,15.363158031304028,15.499385731753527,15.635613432203028,15.771841132652527,15.908068833102027,16.044296533551528,16.180524234001027,16.316751934450526,16.452979634900025,16.589207335349524,16.725435035799023,16.861662736248523,16.997890436698022,17.134118137147521,17.27034583759702,17.406573538046519,17.542801238496018,17.679028938945518,17.815256639395017,17.951484339844519,18.087712040294015,18.223939740743518,18.360167441193013,18.496395141642516,18.632622842092015,18.768850542541514,18.905078242991014,19.041305943440513,19.177533643890012,19.313761344339511,19.44998904478901,19.586216745238509,19.722444445688009,19.858672146137508,19.99489984658701,20.131127547036506,20.267355247486009,20.403582947935504,20.539810648385007,20.676038348834503],[11.475260996519379,11.611488696968879,11.747716397418378,11.883944097867877,12.020171798317378,12.156399498766877,12.292627199216376,12.428854899665875,12.565082600115375,12.701310300564874,12.837538001014373,12.973765701463872,13.109993401913371,13.24622110236287,13.382448802812371,13.518676503261871,13.65490420371137,13.791131904160869,13.927359604610368,14.063587305059869,14.199815005509368,14.336042705958867,14.472270406408366,14.608498106857866,14.744725807307365,14.880953507756864,15.017181208206363,15.153408908655862,15.289636609105361,15.425864309554861,15.56209201000436,15.698319710453859,15.83454741090336,15.970775111352859,16.10700281180236,16.243230512251859,16.379458212701358,16.515685913150858,16.651913613600357,16.788141314049856,16.924369014499355,17.060596714948854,17.196824415398353,17.333052115847853,17.469279816297352,17.605507516746851,17.74173521719635,17.877962917645849,18.014190618095348,18.150418318544851,18.286646018994347,18.422873719443849,18.559101419893345,18.695329120342848,18.831556820792347,18.967784521241846,19.104012221691345,19.240239922140844,19.376467622590344,19.512695323039843,19.648923023489342,19.785150723938841,19.92137842438834,20.057606124837839,20.193833825287342,20.330061525736838,20.46628922618634,20.602516926635836,20.738744627085339,20.874972327534834],[11.674194975219709,11.810422675669209,11.946650376118708,12.082878076568207,12.219105777017706,12.355333477467207,12.491561177916706,12.627788878366205,12.764016578815705,12.900244279265204,13.036471979714703,13.172699680164202,13.308927380613701,13.445155081063202,13.581382781512701,13.7176104819622,13.8538381824117,13.990065882861199,14.126293583310698,14.262521283760197,14.398748984209696,14.534976684659195,14.671204385108696,14.807432085558196,14.943659786007695,15.079887486457194,15.216115186906693,15.352342887356192,15.488570587805693,15.624798288255192,15.761025988704692,15.897253689154191,16.03348138960369,16.169709090053189,16.305936790502688,16.442164490952187,16.578392191401687,16.714619891851186,16.850847592300688,16.987075292750184,17.123302993199687,17.259530693649182,17.395758394098685,17.531986094548184,17.668213794997683,17.804441495447183,17.940669195896682,18.076896896346181,18.21312459679568,18.349352297245179,18.485579997694678,18.621807698144178,18.758035398593677,18.894263099043176,19.030490799492675,19.166718499942178,19.302946200391673,19.439173900841173,19.575401601290672,19.711629301740174,19.84785700218967,19.984084702639173,20.120312403088668,20.256540103538171,20.39276780398767,20.528995504437169,20.665223204886669,20.801450905336168,20.937678605785667,21.073906306235166],[11.873128953920041,12.00935665436954,12.145584354819039,12.281812055268539,12.418039755718038,12.554267456167539,12.690495156617038,12.826722857066537,12.962950557516036,13.099178257965535,13.235405958415035,13.371633658864534,13.507861359314033,13.644089059763534,13.780316760213033,13.916544460662532,14.052772161112031,14.18899986156153,14.32522756201103,14.461455262460529,14.597682962910028,14.733910663359527,14.870138363809028,15.006366064258527,15.142593764708026,15.278821465157526,15.415049165607025,15.551276866056524,15.687504566506025,15.823732266955524,15.959959967405023,16.096187667854522,16.232415368304022,16.368643068753521,16.50487076920302,16.641098469652519,16.777326170102018,16.913553870551517,17.04978157100102,17.186009271450516,17.322236971900018,17.458464672349514,17.594692372799017,17.730920073248516,17.867147773698015,18.003375474147514,18.139603174597013,18.275830875046513,18.412058575496012,18.548286275945511,18.68451397639501,18.820741676844509,18.956969377294008,19.093197077743508,19.229424778193007,19.365652478642509,19.501880179092005,19.638107879541504,19.774335579991003,19.910563280440506,20.046790980890002,20.183018681339504,20.319246381789,20.455474082238503,20.591701782688002,20.727929483137501,20.864157183587,21.000384884036499,21.136612584485999,21.272840284935498],[12.072062932620373,12.208290633069872,12.344518333519371,12.48074603396887,12.616973734418369,12.75320143486787,12.88942913531737,13.025656835766869,13.161884536216368,13.298112236665867,13.434339937115366,13.570567637564865,13.706795338014365,13.843023038463866,13.979250738913365,14.115478439362864,14.251706139812363,14.387933840261862,14.524161540711361,14.660389241160861,14.79661694161036,14.932844642059859,15.06907234250936,15.205300042958859,15.341527743408358,15.477755443857857,15.613983144307356,15.750210844756856,15.886438545206357,16.022666245655856,16.158893946105355,16.295121646554854,16.431349347004353,16.567577047453852,16.703804747903352,16.840032448352851,16.97626014880235,17.112487849251849,17.248715549701352,17.384943250150847,17.52117095060035,17.657398651049846,17.793626351499348,17.929854051948848,18.066081752398347,18.202309452847846,18.338537153297345,18.474764853746844,18.610992554196343,18.747220254645843,18.883447955095342,19.019675655544841,19.15590335599434,19.292131056443839,19.428358756893338,19.564586457342841,19.700814157792337,19.837041858241836,19.973269558691335,20.109497259140838,20.245724959590333,20.381952660039836,20.518180360489332,20.654408060938835,20.790635761388334,20.926863461837833,21.063091162287332,21.199318862736831,21.33554656318633,21.47177426363583],[12.270996911320703,12.407224611770202,12.543452312219701,12.6796800126692,12.815907713118701,12.9521354135682,13.088363114017699,13.224590814467199,13.360818514916698,13.497046215366197,13.633273915815696,13.769501616265195,13.905729316714694,14.041957017164194,14.178184717613695,14.314412418063194,14.450640118512693,14.586867818962192,14.723095519411691,14.859323219861192,14.995550920310691,15.131778620760191,15.26800632120969,15.404234021659189,15.540461722108688,15.676689422558187,15.812917123007686,15.949144823457186,16.085372523906685,16.221600224356184,16.357827924805683,16.494055625255182,16.630283325704681,16.766511026154184,16.90273872660368,17.038966427053182,17.175194127502682,17.311421827952181,17.44764952840168,17.583877228851179,17.720104929300678,17.856332629750177,17.992560330199677,18.128788030649176,18.265015731098675,18.401243431548174,18.537471131997677,18.673698832447172,18.809926532896672,18.946154233346171,19.082381933795673,19.218609634245173,19.354837334694672,19.491065035144171,19.62729273559367,19.763520436043169,19.899748136492668,20.035975836942168,20.172203537391667,20.308431237841166,20.444658938290665,20.580886638740168,20.717114339189663,20.853342039639166,20.989569740088662,21.125797440538165,21.26202514098766,21.398252841437163,21.534480541886659,21.670708242336161],[12.469930890021034,12.606158590470534,12.742386290920033,12.878613991369532,13.014841691819033,13.151069392268532,13.287297092718031,13.42352479316753,13.55975249361703,13.695980194066529,13.832207894516028,13.968435594965527,14.104663295415026,14.240890995864525,14.377118696314026,14.513346396763525,14.649574097213025,14.785801797662524,14.922029498112023,15.058257198561524,15.194484899011023,15.330712599460522,15.466940299910021,15.603168000359521,15.73939570080902,15.875623401258519,16.011851101708018,16.148078802157517,16.284306502607016,16.420534203056516,16.556761903506015,16.692989603955514,16.829217304405013,16.965445004854516,17.101672705304011,17.237900405753514,17.374128106203013,17.510355806652512,17.646583507102012,17.782811207551511,17.91903890800101,18.055266608450509,18.191494308900008,18.327722009349507,18.463949709799007,18.600177410248506,18.736405110698009,18.872632811147504,19.008860511597003,19.145088212046502,19.281315912496005,19.417543612945504,19.553771313395004,19.689999013844503,19.826226714294002,19.962454414743501,20.098682115193,20.234909815642499,20.371137516091999,20.507365216541498,20.643592916990997,20.7798206174405,20.916048317889995,21.052276018339498,21.188503718788994,21.324731419238496,21.460959119687992,21.597186820137495,21.73341452058699,21.869642221036493],[12.668864868721366,12.805092569170865,12.941320269620364,13.077547970069864,13.213775670519365,13.350003370968864,13.486231071418363,13.622458771867862,13.758686472317361,13.89491417276686,14.03114187321636,14.167369573665859,14.303597274115358,14.439824974564857,14.576052675014358,14.712280375463857,14.848508075913356,14.984735776362855,15.120963476812355,15.257191177261856,15.393418877711355,15.529646578160854,15.665874278610353,15.802101979059852,15.938329679509351,16.074557379958851,16.21078508040835,16.347012780857849,16.483240481307348,16.619468181756847,16.755695882206346,16.891923582655846,17.028151283105345,17.164378983554847,17.300606684004343,17.436834384453846,17.573062084903345,17.709289785352844,17.845517485802343,17.981745186251842,18.117972886701342,18.254200587150841,18.39042828760034,18.526655988049839,18.662883688499338,18.799111388948837,18.93533908939834,19.071566789847836,19.207794490297335,19.344022190746834,19.480249891196337,19.616477591645836,19.752705292095335,19.888932992544834,20.025160692994334,20.161388393443833,20.297616093893332,20.433843794342831,20.57007149479233,20.706299195241829,20.842526895691329,20.978754596140831,21.114982296590327,21.25120999703983,21.387437697489325,21.523665397938828,21.659893098388324,21.796120798837826,21.932348499287322,22.068576199736825],[12.867798847421696,13.004026547871195,13.140254248320694,13.276481948770193,13.412709649219693,13.548937349669194,13.685165050118693,13.821392750568192,13.957620451017691,14.09384815146719,14.230075851916689,14.366303552366189,14.502531252815688,14.638758953265189,14.774986653714688,14.911214354164187,15.047442054613686,15.183669755063185,15.319897455512685,15.456125155962184,15.592352856411683,15.728580556861182,15.864808257310683,16.00103595776018,16.13726365820968,16.273491358659179,16.409719059108681,16.545946759558181,16.68217446000768,16.818402160457179,16.954629860906678,17.090857561356177,17.227085261805676,17.363312962255176,17.499540662704675,17.635768363154174,17.771996063603673,17.908223764053172,18.044451464502671,18.180679164952171,18.31690686540167,18.453134565851173,18.589362266300668,18.725589966750171,18.86181766719967,18.998045367649169,19.134273068098668,19.270500768548168,19.406728468997667,19.542956169447166,19.679183869896665,19.815411570346164,19.951639270795663,20.087866971245163,20.224094671694662,20.360322372144161,20.496550072593664,20.632777773043159,20.769005473492662,20.905233173942158,21.04146087439166,21.177688574841159,21.313916275290659,21.450143975740158,21.586371676189657,21.722599376639156,21.858827077088655,21.995054777538154,22.131282477987654,22.267510178437153],[13.066732826122028,13.202960526571527,13.339188227021026,13.475415927470525,13.611643627920024,13.747871328369525,13.884099028819024,14.020326729268524,14.156554429718023,14.292782130167522,14.429009830617021,14.56523753106652,14.701465231516019,14.83769293196552,14.97392063241502,15.110148332864519,15.246376033314018,15.382603733763517,15.518831434213016,15.655059134662515,15.791286835112015,15.927514535561514,16.063742236011013,16.199969936460512,16.336197636910011,16.47242533735951,16.608653037809013,16.744880738258512,16.881108438708011,17.017336139157511,17.15356383960701,17.289791540056509,17.426019240506008,17.562246940955507,17.698474641405006,17.834702341854506,17.970930042304005,18.107157742753504,18.243385443203003,18.379613143652502,18.515840844102001,18.652068544551504,18.788296245001,18.924523945450503,19.060751645900002,19.196979346349501,19.333207046799,19.469434747248499,19.605662447697998,19.741890148147498,19.878117848596997,20.014345549046496,20.150573249495995,20.286800949945494,20.423028650394993,20.559256350844493,20.695484051293995,20.831711751743491,20.967939452192994,21.104167152642489,21.240394853091992,21.376622553541491,21.51285025399099,21.649077954440489,21.785305654889989,21.921533355339488,22.057761055788987,22.193988756238486,22.330216456687985,22.466444157137484],[13.265666804822358,13.401894505271857,13.538122205721356,13.674349906170855,13.810577606620356,13.946805307069855,14.083033007519354,14.219260707968854,14.355488408418353,14.491716108867852,14.627943809317351,14.76417150976685,14.900399210216349,15.036626910665849,15.172854611115349,15.309082311564849,15.445310012014348,15.581537712463847,15.717765412913346,15.853993113362847,15.990220813812346,16.126448514261845,16.262676214711345,16.398903915160844,16.535131615610343,16.671359316059842,16.807587016509341,16.94381471695884,17.08004241740834,17.216270117857839,17.352497818307338,17.488725518756837,17.62495321920634,17.761180919655835,17.897408620105338,18.033636320554837,18.169864021004337,18.306091721453836,18.442319421903335,18.578547122352834,18.714774822802333,18.851002523251832,18.987230223701332,19.123457924150831,19.25968562460033,19.395913325049829,19.532141025499328,19.668368725948827,19.804596426398327,19.940824126847829,20.077051827297325,20.213279527746828,20.349507228196323,20.485734928645826,20.621962629095325,20.758190329544824,20.894418029994323,21.030645730443823,21.166873430893322,21.303101131342821,21.43932883179232,21.575556532241819,21.711784232691318,21.848011933140818,21.98423963359032,22.120467334039816,22.256695034489319,22.392922734938814,22.529150435388317,22.665378135837813],[13.464600783522689,13.600828483972188,13.737056184421688,13.873283884871187,14.009511585320688,14.145739285770187,14.281966986219686,14.418194686669185,14.554422387118684,14.690650087568184,14.826877788017683,14.963105488467182,15.099333188916681,15.23556088936618,15.371788589815681,15.50801629026518,15.64424399071468,15.780471691164179,15.916699391613678,16.052927092063179,16.189154792512678,16.325382492962177,16.461610193411676,16.597837893861175,16.734065594310675,16.870293294760174,17.006520995209673,17.142748695659172,17.278976396108671,17.41520409655817,17.55143179700767,17.687659497457169,17.823887197906672,17.960114898356167,18.09634259880567,18.232570299255169,18.368797999704668,18.505025700154167,18.641253400603667,18.777481101053166,18.913708801502665,19.049936501952164,19.186164202401663,19.322391902851162,19.458619603300662,19.594847303750161,19.73107500419966,19.867302704649159,20.003530405098658,20.139758105548161,20.275985805997657,20.412213506447159,20.548441206896655,20.684668907346158,20.820896607795657,20.957124308245156,21.093352008694655,21.229579709144154,21.365807409593653,21.502035110043153,21.638262810492652,21.774490510942151,21.91071821139165,22.046945911841149,22.183173612290652,22.319401312740148,22.45562901318965,22.591856713639146,22.728084414088649,22.864312114538144],[13.663534762223019,13.799762462672518,13.935990163122018,14.072217863571517,14.208445564021016,14.344673264470517,14.480900964920016,14.617128665369515,14.753356365819014,14.889584066268513,15.025811766718013,15.162039467167512,15.298267167617011,15.434494868066512,15.570722568516011,15.70695026896551,15.843177969415009,15.979405669864509,16.115633370314008,16.251861070763507,16.388088771213006,16.524316471662505,16.660544172112004,16.796771872561507,16.932999573011003,17.069227273460506,17.205454973910001,17.341682674359504,17.477910374809003,17.614138075258502,17.750365775708001,17.886593476157501,18.022821176607,18.159048877056499,18.295276577505998,18.431504277955497,18.567731978404996,18.703959678854496,18.840187379303998,18.976415079753494,19.112642780202997,19.248870480652492,19.385098181101995,19.521325881551494,19.657553582000993,19.793781282450492,19.930008982899992,20.066236683349491,20.20246438379899,20.338692084248489,20.474919784697988,20.611147485147487,20.747375185596987,20.883602886046486,21.019830586495985,21.156058286945488,21.292285987394983,21.428513687844482,21.564741388293982,21.700969088743484,21.83719678919298,21.973424489642483,22.109652190091978,22.245879890541481,22.38210759099098,22.518335291440479,22.654562991889978,22.790790692339478,22.927018392788977,23.063246093238476],[13.862468740923351,13.99869644137285,14.134924141822349,14.271151842271848,14.407379542721348,14.543607243170849,14.679834943620348,14.816062644069847,14.952290344519346,15.088518044968845,15.224745745418344,15.360973445867844,15.497201146317343,15.633428846766844,15.769656547216343,15.905884247665842,16.042111948115341,16.17833964856484,16.314567349014339,16.450795049463839,16.587022749913338,16.723250450362837,16.859478150812336,16.995705851261839,17.131933551711334,17.268161252160837,17.404388952610333,17.540616653059836,17.676844353509335,17.813072053958834,17.949299754408333,18.085527454857832,18.221755155307331,18.357982855756831,18.49421055620633,18.630438256655829,18.766665957105328,18.902893657554827,19.03912135800433,19.175349058453826,19.311576758903328,19.447804459352824,19.584032159802327,19.720259860251826,19.856487560701325,19.992715261150824,20.128942961600323,20.265170662049822,20.401398362499322,20.537626062948821,20.67385376339832,20.810081463847819,20.946309164297318,21.082536864746817,21.218764565196317,21.354992265645819,21.491219966095315,21.627447666544814,21.763675366994313,21.899903067443816,22.036130767893312,22.172358468342814,22.30858616879231,22.444813869241813,22.581041569691312,22.717269270140811,22.85349697059031,22.989724671039809,23.125952371489308,23.262180071938808],[14.061402719623681,14.19763042007318,14.333858120522679,14.470085820972178,14.606313521421679,14.742541221871178,14.878768922320678,15.014996622770177,15.151224323219676,15.287452023669175,15.423679724118674,15.559907424568173,15.696135125017673,15.832362825467172,15.968590525916673,16.10481822636617,16.241045926815673,16.377273627265168,16.513501327714671,16.64972902816417,16.785956728613669,16.922184429063169,17.058412129512668,17.194639829962167,17.330867530411666,17.467095230861165,17.603322931310665,17.739550631760164,17.875778332209663,18.012006032659162,18.148233733108661,18.28446143355816,18.42068913400766,18.556916834457162,18.693144534906658,18.829372235356161,18.96559993580566,19.101827636255159,19.238055336704658,19.374283037154157,19.510510737603656,19.646738438053156,19.782966138502655,19.919193838952154,20.055421539401653,20.191649239851152,20.327876940300655,20.464104640750151,20.60033234119965,20.736560041649149,20.872787742098652,21.009015442548151,21.14524314299765,21.281470843447149,21.417698543896648,21.553926244346147,21.690153944795647,21.826381645245146,21.962609345694645,22.098837046144144,22.235064746593643,22.371292447043146,22.507520147492642,22.643747847942144,22.77997554839164,22.916203248841143,23.052430949290638,23.188658649740141,23.324886350189637,23.461114050639139],[14.260336698324013,14.396564398773512,14.532792099223011,14.66901979967251,14.805247500122011,14.94147520057151,15.077702901021009,15.213930601470508,15.350158301920008,15.486386002369507,15.622613702819006,15.758841403268505,15.895069103718004,16.031296804167503,16.167524504617003,16.303752205066502,16.439979905516005,16.5762076059655,16.712435306415003,16.848663006864502,16.984890707314001,17.1211184077635,17.257346108213,17.393573808662499,17.529801509111998,17.666029209561497,17.802256910010996,17.938484610460495,18.074712310909995,18.210940011359494,18.347167711808993,18.483395412258492,18.619623112707991,18.755850813157494,18.89207851360699,19.028306214056492,19.164533914505991,19.300761614955491,19.43698931540499,19.573217015854489,19.709444716303988,19.845672416753487,19.981900117202986,20.118127817652486,20.254355518101985,20.390583218551484,20.526810919000987,20.663038619450482,20.799266319899981,20.935494020349481,21.071721720798983,21.207949421248482,21.344177121697982,21.480404822147481,21.61663252259698,21.752860223046479,21.889087923495978,22.025315623945477,22.161543324394977,22.297771024844476,22.433998725293975,22.570226425743478,22.706454126192973,22.842681826642476,22.978909527091972,23.115137227541474,23.25136492799097,23.387592628440473,23.523820328889968,23.660048029339471],[14.459270677024344,14.595498377473843,14.731726077923343,14.867953778372842,15.004181478822343,15.140409179271842,15.276636879721341,15.41286458017084,15.549092280620339,15.685319981069838,15.821547681519338,15.957775381968837,16.094003082418336,16.230230782867835,16.366458483317334,16.502686183766833,16.638913884216336,16.775141584665832,16.911369285115335,17.047596985564834,17.183824686014333,17.320052386463832,17.456280086913331,17.59250778736283,17.72873548781233,17.864963188261829,18.001190888711328,18.137418589160827,18.273646289610326,18.409873990059825,18.546101690509325,18.682329390958824,18.818557091408323,18.954784791857826,19.091012492307321,19.227240192756824,19.363467893206323,19.499695593655822,19.635923294105321,19.772150994554821,19.90837869500432,20.044606395453819,20.180834095903318,20.317061796352817,20.453289496802316,20.589517197251816,20.725744897701318,20.861972598150814,20.998200298600313,21.134427999049812,21.270655699499315,21.406883399948814,21.543111100398313,21.679338800847813,21.815566501297312,21.951794201746811,22.08802190219631,22.224249602645809,22.360477303095308,22.496705003544808,22.632932703994307,22.769160404443809,22.905388104893305,23.041615805342808,23.177843505792303,23.314071206241806,23.450298906691302,23.586526607140804,23.7227543075903,23.858982008039803],[14.658204655724674,14.794432356174173,14.930660056623672,15.066887757073172,15.203115457522671,15.339343157972172,15.475570858421671,15.61179855887117,15.748026259320669,15.884253959770168,16.020481660219669,16.156709360669169,16.292937061118668,16.429164761568167,16.565392462017666,16.701620162467165,16.837847862916664,16.974075563366164,17.110303263815663,17.246530964265162,17.382758664714661,17.51898636516416,17.655214065613659,17.791441766063159,17.927669466512658,18.063897166962157,18.20012486741166,18.336352567861159,18.472580268310658,18.608807968760157,18.745035669209656,18.881263369659155,19.017491070108655,19.153718770558154,19.289946471007653,19.426174171457152,19.562401871906651,19.69862957235615,19.83485727280565,19.971084973255149,20.107312673704648,20.243540374154151,20.379768074603646,20.515995775053149,20.652223475502648,20.788451175952147,20.924678876401646,21.060906576851146,21.197134277300645,21.333361977750144,21.469589678199643,21.605817378649142,21.742045079098641,21.878272779548141,22.01450047999764,22.150728180447139,22.286955880896642,22.423183581346137,22.55941128179564,22.695638982245136,22.831866682694638,22.968094383144138,23.104322083593637,23.240549784043136,23.376777484492635,23.513005184942134,23.649232885391633,23.785460585841133,23.921688286290632,24.057915986740131],[14.857138634425008,14.993366334874507,15.129594035324006,15.265821735773505,15.402049436223006,15.538277136672505,15.674504837122004,15.810732537571504,15.946960238021003,16.083187938470502,16.219415638920001,16.3556433393695,16.491871039818999,16.628098740268499,16.764326440717998,16.900554141167497,17.036781841617,17.173009542066495,17.309237242515998,17.445464942965497,17.581692643414996,17.717920343864495,17.854148044313995,17.990375744763494,18.126603445212993,18.262831145662492,18.399058846111991,18.53528654656149,18.67151424701099,18.807741947460489,18.943969647909988,19.080197348359487,19.216425048808986,19.352652749258489,19.488880449707985,19.625108150157487,19.761335850606986,19.897563551056486,20.033791251505985,20.170018951955484,20.306246652404983,20.442474352854482,20.578702053303982,20.714929753753481,20.85115745420298,20.987385154652479,21.123612855101982,21.259840555551477,21.396068256000977,21.532295956450476,21.668523656899978,21.804751357349478,21.940979057798977,22.077206758248476,22.213434458697975,22.349662159147474,22.485889859596973,22.622117560046473,22.758345260495972,22.894572960945471,23.03080066139497,23.167028361844473,23.303256062293968,23.439483762743471,23.575711463192967,23.711939163642469,23.848166864091965,23.984394564541468,24.120622264990963,24.256849965440466],[15.056072613125338,15.192300313574837,15.328528014024336,15.464755714473835,15.600983414923334,15.737211115372835,15.873438815822334,16.009666516271832,16.145894216721331,16.282121917170834,16.418349617620333,16.554577318069832,16.690805018519331,16.82703271896883,16.963260419418329,17.099488119867829,17.235715820317328,17.371943520766827,17.508171221216326,17.644398921665825,17.780626622115324,17.916854322564824,18.053082023014323,18.189309723463822,18.325537423913321,18.46176512436282,18.597992824812323,18.734220525261822,18.870448225711321,19.00667592616082,19.14290362661032,19.279131327059819,19.415359027509318,19.551586727958817,19.687814428408316,19.824042128857815,19.960269829307315,20.096497529756814,20.232725230206313,20.368952930655812,20.505180631105311,20.641408331554814,20.77763603200431,20.913863732453812,21.050091432903312,21.186319133352811,21.32254683380231,21.458774534251809,21.595002234701308,21.731229935150807,21.867457635600307,22.003685336049806,22.139913036499305,22.276140736948804,22.412368437398303,22.548596137847802,22.684823838297305,22.821051538746801,22.957279239196303,23.093506939645799,23.229734640095302,23.365962340544801,23.5021900409943,23.638417741443799,23.774645441893298,23.910873142342798,24.047100842792297,24.183328543241796,24.319556243691295,24.455783944140794],[15.255006591825667,15.391234292275167,15.527461992724666,15.663689693174165,15.799917393623666,15.936145094073165,16.072372794522664,16.208600494972163,16.344828195421663,16.481055895871162,16.617283596320661,16.75351129677016,16.889738997219659,17.025966697669158,17.162194398118658,17.298422098568157,17.434649799017656,17.570877499467159,17.707105199916658,17.843332900366157,17.979560600815656,18.115788301265155,18.252016001714654,18.388243702164154,18.524471402613653,18.660699103063152,18.796926803512651,18.93315450396215,19.069382204411649,19.205609904861149,19.341837605310648,19.478065305760147,19.61429300620965,19.750520706659145,19.886748407108648,20.022976107558147,20.159203808007646,20.295431508457145,20.431659208906645,20.567886909356144,20.704114609805643,20.840342310255142,20.976570010704641,21.112797711154141,21.24902541160364,21.385253112053139,21.521480812502638,21.657708512952137,21.793936213401636,21.930163913851139,22.066391614300635,22.202619314750137,22.338847015199633,22.475074715649136,22.611302416098635,22.747530116548134,22.883757816997633,23.019985517447132,23.156213217896632,23.292440918346131,23.42866861879563,23.564896319245129,23.701124019694628,23.837351720144127,23.97357942059363,24.109807121043126,24.246034821492628,24.382262521942124,24.518490222391627,24.654717922841122],[15.453940570526001,15.5901682709755,15.726395971424999,15.862623671874498,15.998851372323998,16.135079072773497,16.271306773222996,16.407534473672495,16.543762174121994,16.679989874571497,16.816217575020996,16.952445275470495,17.088672975919994,17.224900676369494,17.361128376818993,17.497356077268492,17.633583777717991,17.76981147816749,17.906039178616989,18.042266879066489,18.178494579515988,18.314722279965487,18.450949980414986,18.587177680864485,18.723405381313984,18.859633081763484,18.995860782212986,19.132088482662486,19.268316183111985,19.404543883561484,19.540771584010983,19.676999284460482,19.813226984909981,19.949454685359481,20.08568238580898,20.221910086258479,20.358137786707978,20.494365487157477,20.630593187606976,20.766820888056476,20.903048588505975,21.039276288955477,21.175503989404973,21.311731689854476,21.447959390303975,21.584187090753474,21.720414791202973,21.856642491652472,21.992870192101972,22.129097892551471,22.26532559300097,22.401553293450469,22.537780993899968,22.674008694349467,22.810236394798967,22.946464095248466,23.082691795697968,23.218919496147464,23.355147196596967,23.491374897046462,23.627602597495965,23.763830297945464,23.900057998394963,24.036285698844463,24.172513399293962,24.308741099743461,24.44496880019296,24.581196500642459,24.717424201091958,24.853651901541458],[15.652874549226331,15.78910224967583,15.925329950125329,16.06155765057483,16.197785351024329,16.334013051473828,16.470240751923328,16.606468452372827,16.742696152822326,16.878923853271825,17.015151553721324,17.151379254170823,17.287606954620323,17.423834655069822,17.560062355519321,17.69629005596882,17.832517756418319,17.968745456867822,18.104973157317321,18.24120085776682,18.377428558216319,18.513656258665819,18.649883959115318,18.786111659564817,18.922339360014316,19.058567060463815,19.194794760913314,19.331022461362814,19.467250161812313,19.603477862261812,19.739705562711311,19.87593326316081,20.012160963610313,20.148388664059809,20.284616364509311,20.420844064958811,20.55707176540831,20.693299465857809,20.829527166307308,20.965754866756807,21.101982567206306,21.238210267655806,21.374437968105305,21.510665668554804,21.646893369004303,21.783121069453802,21.919348769903301,22.055576470352801,22.1918041708023,22.328031871251802,22.464259571701298,22.600487272150801,22.736714972600296,22.872942673049799,23.009170373499298,23.145398073948797,23.281625774398297,23.417853474847796,23.554081175297295,23.690308875746794,23.826536576196293,23.962764276645792,24.098991977095292,24.235219677544791,24.371447377994294,24.507675078443789,24.643902778893292,24.780130479342787,24.91635817979229,25.052585880241786],[15.851808527926661,15.98803622837616,16.124263928825659,16.260491629275158,16.396719329724657,16.532947030174157,16.669174730623656,16.805402431073155,16.941630131522658,17.077857831972157,17.214085532421656,17.350313232871155,17.486540933320654,17.622768633770153,17.758996334219653,17.895224034669152,18.031451735118651,18.16767943556815,18.303907136017649,18.440134836467148,18.576362536916648,18.712590237366147,18.848817937815646,18.985045638265149,19.121273338714644,19.257501039164147,19.393728739613643,19.529956440063145,19.666184140512645,19.802411840962144,19.938639541411643,20.074867241861142,20.211094942310641,20.34732264276014,20.48355034320964,20.619778043659139,20.756005744108638,20.892233444558137,21.02846114500764,21.164688845457135,21.300916545906638,21.437144246356134,21.573371946805636,21.709599647255136,21.845827347704635,21.982055048154134,22.118282748603633,22.254510449053132,22.390738149502631,22.526965849952131,22.66319355040163,22.799421250851129,22.935648951300628,23.071876651750127,23.208104352199626,23.344332052649129,23.480559753098625,23.616787453548124,23.753015153997623,23.889242854447126,24.025470554896621,24.161698255346124,24.29792595579562,24.434153656245122,24.570381356694622,24.706609057144121,24.84283675759362,24.979064458043119,25.115292158492618,25.251519858942117],[16.050742506626996,16.186970207076495,16.323197907525994,16.459425607975493,16.595653308424993,16.731881008874492,16.868108709323991,17.00433640977349,17.140564110222989,17.276791810672492,17.413019511121991,17.54924721157149,17.68547491202099,17.821702612470489,17.957930312919988,18.094158013369487,18.230385713818986,18.366613414268485,18.502841114717985,18.639068815167484,18.775296515616983,18.911524216066482,19.047751916515981,19.18397961696548,19.32020731741498,19.456435017864479,19.592662718313981,19.728890418763481,19.86511811921298,20.001345819662479,20.137573520111978,20.273801220561477,20.410028921010976,20.546256621460476,20.682484321909975,20.818712022359474,20.954939722808973,21.091167423258472,21.227395123707971,21.363622824157471,21.49985052460697,21.636078225056472,21.772305925505968,21.908533625955471,22.04476132640497,22.180989026854469,22.317216727303968,22.453444427753467,22.589672128202967,22.725899828652466,22.862127529101965,22.998355229551464,23.134582930000963,23.270810630450462,23.407038330899962,23.543266031349461,23.679493731798964,23.815721432248459,23.951949132697962,24.088176833147458,24.22440453359696,24.360632234046459,24.496859934495959,24.633087634945458,24.769315335394957,24.905543035844456,25.041770736293955,25.177998436743454,25.314226137192954,25.450453837642453],[16.249676485327324,16.385904185776823,16.522131886226322,16.658359586675822,16.794587287125321,16.93081498757482,17.067042688024319,17.203270388473818,17.339498088923321,17.47572578937282,17.611953489822319,17.748181190271819,17.884408890721318,18.020636591170817,18.156864291620316,18.293091992069815,18.429319692519314,18.565547392968814,18.701775093418313,18.838002793867812,18.974230494317311,19.11045819476681,19.246685895216309,19.382913595665812,19.519141296115308,19.65536899656481,19.791596697014306,19.927824397463809,20.064052097913308,20.200279798362807,20.336507498812306,20.472735199261805,20.608962899711305,20.745190600160804,20.881418300610303,21.017646001059802,21.153873701509301,21.2901014019588,21.426329102408303,21.562556802857799,21.698784503307301,21.835012203756797,21.9712399042063,22.107467604655799,22.243695305105298,22.379923005554797,22.516150706004296,22.652378406453796,22.788606106903295,22.924833807352794,23.061061507802293,23.197289208251792,23.333516908701291,23.469744609150791,23.60597230960029,23.742200010049793,23.878427710499288,24.014655410948787,24.150883111398286,24.287110811847789,24.423338512297285,24.559566212746788,24.695793913196283,24.832021613645786,24.968249314095285,25.104477014544784,25.240704714994283,25.376932415443783,25.513160115893282,25.649387816342781],[16.448610464027652,16.584838164477151,16.721065864926651,16.85729356537615,16.993521265825649,17.129748966275148,17.265976666724647,17.402204367174146,17.538432067623646,17.674659768073148,17.810887468522647,17.947115168972147,18.083342869421646,18.219570569871145,18.355798270320644,18.492025970770143,18.628253671219642,18.764481371669142,18.900709072118641,19.03693677256814,19.173164473017639,19.309392173467138,19.445619873916637,19.581847574366137,19.718075274815636,19.854302975265135,19.990530675714638,20.126758376164137,20.262986076613636,20.399213777063135,20.535441477512634,20.671669177962134,20.807896878411633,20.944124578861132,21.080352279310631,21.21657997976013,21.352807680209629,21.489035380659129,21.625263081108628,21.761490781558127,21.897718482007626,22.033946182457129,22.170173882906624,22.306401583356127,22.442629283805626,22.578856984255125,22.715084684704625,22.851312385154124,22.987540085603623,23.123767786053122,23.259995486502621,23.39622318695212,23.53245088740162,23.668678587851119,23.804906288300618,23.941133988750117,24.07736168919962,24.213589389649115,24.349817090098618,24.486044790548114,24.622272490997617,24.758500191447116,24.894727891896615,25.030955592346114,25.167183292795613,25.303410993245112,25.439638693694612,25.575866394144111,25.71209409459361,25.848321795043109],[16.647544442727988,16.783772143177487,16.919999843626986,17.056227544076485,17.192455244525984,17.328682944975483,17.464910645424983,17.601138345874482,17.737366046323984,17.873593746773484,18.009821447222983,18.146049147672482,18.282276848121981,18.41850454857148,18.554732249020979,18.690959949470479,18.827187649919978,18.963415350369477,19.099643050818976,19.235870751268475,19.372098451717974,19.508326152167474,19.644553852616973,19.780781553066475,19.917009253515971,20.053236953965474,20.189464654414969,20.325692354864472,20.461920055313971,20.59814775576347,20.73437545621297,20.870603156662469,21.006830857111968,21.143058557561467,21.279286258010966,21.415513958460465,21.551741658909965,21.687969359359464,21.824197059808967,21.960424760258462,22.096652460707965,22.23288016115746,22.369107861606963,22.505335562056462,22.641563262505962,22.777790962955461,22.91401866340496,23.050246363854459,23.186474064303958,23.322701764753457,23.458929465202957,23.595157165652456,23.731384866101955,23.867612566551454,24.003840267000953,24.140067967450456,24.276295667899952,24.412523368349451,24.54875106879895,24.684978769248453,24.821206469697948,24.957434170147451,25.093661870596947,25.229889571046449,25.366117271495948,25.502344971945448,25.638572672394947,25.774800372844446,25.911028073293945,26.047255773743444]],"x":[0,4.3478260869565215,8.695652173913043,13.043478260869565,17.391304347826086,21.739130434782609,26.086956521739129,30.434782608695649,34.782608695652172,39.130434782608695,43.478260869565219,47.826086956521735,52.173913043478258,56.521739130434781,60.869565217391298,65.217391304347828,69.565217391304344,73.91304347826086,78.260869565217391,82.608695652173907,86.956521739130437,91.304347826086953,95.65217391304347,100,104.34782608695652,108.69565217391303,113.04347826086956,117.39130434782608,121.7391304347826,126.08695652173913,130.43478260869566,134.78260869565216,139.13043478260869,143.47826086956522,147.82608695652172,152.17391304347825,156.52173913043478,160.86956521739128,165.21739130434781,169.56521739130434,173.91304347826087,178.26086956521738,182.60869565217391,186.95652173913044,191.30434782608694,195.65217391304347,200,204.3478260869565,208.69565217391303,213.04347826086956,217.39130434782606,221.7391304347826,226.08695652173913,230.43478260869563,234.78260869565216,239.13043478260869,243.47826086956519,247.82608695652172,252.17391304347825,256.52173913043475,260.86956521739131,265.21739130434781,269.56521739130432,273.91304347826087,278.26086956521738,282.60869565217388,286.95652173913044,291.30434782608694,295.65217391304344,300],"y":[0,0.72463768115942029,1.4492753623188406,2.1739130434782608,2.8985507246376812,3.6231884057971016,4.3478260869565215,5.0724637681159424,5.7971014492753623,6.5217391304347823,7.2463768115942031,7.9710144927536231,8.695652173913043,9.420289855072463,10.144927536231885,10.869565217391305,11.594202898550725,12.318840579710145,13.043478260869565,13.768115942028986,14.492753623188406,15.217391304347826,15.942028985507246,16.666666666666668,17.391304347826086,18.115942028985508,18.840579710144926,19.565217391304348,20.289855072463769,21.014492753623188,21.739130434782609,22.463768115942027,23.188405797101449,23.913043478260871,24.637681159420289,25.362318840579711,26.086956521739129,26.811594202898551,27.536231884057973,28.260869565217391,28.985507246376812,29.710144927536231,30.434782608695652,31.159420289855074,31.884057971014492,32.608695652173914,33.333333333333336,34.05797101449275,34.782608695652172,35.507246376811594,36.231884057971016,36.956521739130437,37.681159420289852,38.405797101449274,39.130434782608695,39.855072463768117,40.579710144927539,41.304347826086953,42.028985507246375,42.753623188405797,43.478260869565219,44.20289855072464,44.927536231884055,45.652173913043477,46.376811594202898,47.10144927536232,47.826086956521742,48.550724637681157,49.275362318840578,50],"opacity":0.5,"type":"surface","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
</section>
<section id="is-there-a-relationship-between-the-response-and-predictors" class="level2">
<h2 class="anchored" data-anchor-id="is-there-a-relationship-between-the-response-and-predictors">Is There a Relationship Between the Response and Predictors?</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>mod3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(sales <span class="sc">~</span> TV <span class="sc">+</span> radio <span class="sc">+</span> newspaper, <span class="at">data =</span> AD)</span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = sales ~ TV + radio + newspaper, data = AD)

Residuals:
    Min      1Q  Median      3Q     Max 
-8.8277 -0.8908  0.2418  1.1893  2.8292 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  2.938889   0.311908   9.422   &lt;2e-16 ***
TV           0.045765   0.001395  32.809   &lt;2e-16 ***
radio        0.188530   0.008611  21.893   &lt;2e-16 ***
newspaper   -0.001037   0.005871  -0.177     0.86    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.686 on 196 degrees of freedom
Multiple R-squared:  0.8972,    Adjusted R-squared:  0.8956 
F-statistic: 570.3 on 3 and 196 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p><span class="math display">\[H_0: \beta_1 = \beta_2 = \beta_3 = 0\]</span> versus the alternative <span class="math display">\[H_1: \text{at least one } \beta_j \neq 0\]</span></p>
<p>The test statistic is <span class="math inline">\(F = \frac{(\text{TSS} - \text{RSS})/p}{\text{RSS}/(n-p-1)}\)</span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: sales
           Df Sum Sq Mean Sq   F value Pr(&gt;F)    
TV          1 3314.6  3314.6 1166.7308 &lt;2e-16 ***
radio       1 1545.6  1545.6  544.0501 &lt;2e-16 ***
newspaper   1    0.1     0.1    0.0312 0.8599    
Residuals 196  556.8     2.8                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>SSR <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">anova</span>(mod3)[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">2</span>])</span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>MSR <span class="ot">&lt;-</span> SSR<span class="sc">/</span><span class="dv">3</span></span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>SSE <span class="ot">&lt;-</span> <span class="fu">anova</span>(mod3)[<span class="dv">4</span>, <span class="dv">2</span>]</span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a>MSE <span class="ot">&lt;-</span> SSE<span class="sc">/</span>(<span class="dv">200-3-1</span>)</span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a>Fobs <span class="ot">&lt;-</span> MSR<span class="sc">/</span>MSE</span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a>Fobs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 570.2707</code></pre>
</div>
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>pvalue <span class="ot">&lt;-</span> <span class="fu">pf</span>(Fobs, <span class="dv">3</span>, <span class="dv">196</span>, <span class="at">lower =</span> <span class="cn">FALSE</span>)</span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a>pvalue</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.575227e-96</code></pre>
</div>
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Or</span></span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = sales ~ TV + radio + newspaper, data = AD)

Residuals:
    Min      1Q  Median      3Q     Max 
-8.8277 -0.8908  0.2418  1.1893  2.8292 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  2.938889   0.311908   9.422   &lt;2e-16 ***
TV           0.045765   0.001395  32.809   &lt;2e-16 ***
radio        0.188530   0.008611  21.893   &lt;2e-16 ***
newspaper   -0.001037   0.005871  -0.177     0.86    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.686 on 196 degrees of freedom
Multiple R-squared:  0.8972,    Adjusted R-squared:  0.8956 
F-statistic: 570.3 on 3 and 196 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod3)<span class="sc">$</span>fstatistic</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   value    numdf    dendf 
570.2707   3.0000 196.0000 </code></pre>
</div>
</div>
<p>Suppose we would like to test whether <span class="math inline">\(\beta_2 = \beta_3 = 0\)</span>. The reduced model with <span class="math inline">\(\beta_2 = \beta_3 = 0\)</span> is <code>mod1</code> while the full model is <code>mod3</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = sales ~ TV + radio + newspaper, data = AD)

Residuals:
    Min      1Q  Median      3Q     Max 
-8.8277 -0.8908  0.2418  1.1893  2.8292 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  2.938889   0.311908   9.422   &lt;2e-16 ***
TV           0.045765   0.001395  32.809   &lt;2e-16 ***
radio        0.188530   0.008611  21.893   &lt;2e-16 ***
newspaper   -0.001037   0.005871  -0.177     0.86    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.686 on 196 degrees of freedom
Multiple R-squared:  0.8972,    Adjusted R-squared:  0.8956 
F-statistic: 570.3 on 3 and 196 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod1, mod3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: sales ~ TV
Model 2: sales ~ TV + radio + newspaper
  Res.Df     RSS Df Sum of Sq      F    Pr(&gt;F)    
1    198 2102.53                                  
2    196  556.83  2    1545.7 272.04 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="variable-selection" class="level2">
<h2 class="anchored" data-anchor-id="variable-selection">Variable Selection</h2>
<ul>
<li>Forward selection</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a>mod.fs <span class="ot">&lt;-</span> <span class="fu">lm</span>(sales <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> AD)</span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a>SCOPE <span class="ot">&lt;-</span> (<span class="sc">~</span> TV <span class="sc">+</span> radio <span class="sc">+</span> newspaper)</span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a><span class="fu">add1</span>(mod.fs, <span class="at">scope =</span> SCOPE, <span class="at">test =</span> <span class="st">"F"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Single term additions

Model:
sales ~ 1
          Df Sum of Sq    RSS    AIC F value    Pr(&gt;F)    
&lt;none&gt;                 5417.1 661.80                      
TV         1    3314.6 2102.5 474.52 312.145 &lt; 2.2e-16 ***
radio      1    1798.7 3618.5 583.10  98.422 &lt; 2.2e-16 ***
newspaper  1     282.3 5134.8 653.10  10.887  0.001148 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a>mod.fs <span class="ot">&lt;-</span> <span class="fu">update</span>(mod.fs, .<span class="sc">~</span>. <span class="sc">+</span> TV)</span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a><span class="fu">add1</span>(mod.fs, <span class="at">scope =</span> SCOPE, <span class="at">test =</span> <span class="st">"F"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Single term additions

Model:
sales ~ TV
          Df Sum of Sq     RSS    AIC F value    Pr(&gt;F)    
&lt;none&gt;                 2102.53 474.52                      
radio      1   1545.62  556.91 210.82  546.74 &lt; 2.2e-16 ***
newspaper  1    183.97 1918.56 458.20   18.89 2.217e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a>mod.fs <span class="ot">&lt;-</span> <span class="fu">update</span>(mod.fs, .<span class="sc">~</span>. <span class="sc">+</span> radio)</span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a><span class="fu">add1</span>(mod.fs, <span class="at">scope =</span> SCOPE, <span class="at">test =</span> <span class="st">"F"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Single term additions

Model:
sales ~ TV + radio
          Df Sum of Sq    RSS    AIC F value Pr(&gt;F)
&lt;none&gt;                 556.91 210.82               
newspaper  1  0.088717 556.83 212.79  0.0312 0.8599</code></pre>
</div>
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod.fs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = sales ~ TV + radio, data = AD)

Residuals:
    Min      1Q  Median      3Q     Max 
-8.7977 -0.8752  0.2422  1.1708  2.8328 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  2.92110    0.29449   9.919   &lt;2e-16 ***
TV           0.04575    0.00139  32.909   &lt;2e-16 ***
radio        0.18799    0.00804  23.382   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.681 on 197 degrees of freedom
Multiple R-squared:  0.8972,    Adjusted R-squared:  0.8962 
F-statistic: 859.6 on 2 and 197 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<ul>
<li>Using <code>stepAIC</code></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="fu">stepAIC</span>(<span class="fu">lm</span>(sales <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> AD), <span class="at">scope =</span> (<span class="sc">~</span>TV <span class="sc">+</span> radio <span class="sc">+</span> newspaper), <span class="at">direction =</span> <span class="st">"forward"</span>, <span class="at">test =</span> <span class="st">"F"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=661.8
sales ~ 1

            Df Sum of Sq    RSS    AIC F Value     Pr(F)    
+ TV         1    3314.6 2102.5 474.52 312.145 &lt; 2.2e-16 ***
+ radio      1    1798.7 3618.5 583.10  98.422 &lt; 2.2e-16 ***
+ newspaper  1     282.3 5134.8 653.10  10.887  0.001148 ** 
&lt;none&gt;                   5417.1 661.80                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Step:  AIC=474.52
sales ~ TV

            Df Sum of Sq     RSS    AIC F Value     Pr(F)    
+ radio      1   1545.62  556.91 210.82  546.74 &lt; 2.2e-16 ***
+ newspaper  1    183.97 1918.56 458.20   18.89 2.217e-05 ***
&lt;none&gt;                   2102.53 474.52                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Step:  AIC=210.82
sales ~ TV + radio

            Df Sum of Sq    RSS    AIC  F Value  Pr(F)
&lt;none&gt;                   556.91 210.82                
+ newspaper  1  0.088717 556.83 212.79 0.031228 0.8599</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = sales ~ TV + radio, data = AD)

Coefficients:
(Intercept)           TV        radio  
    2.92110      0.04575      0.18799  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Or</span></span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a>null <span class="ot">&lt;-</span> <span class="fu">lm</span>(sales <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> AD)</span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a>full <span class="ot">&lt;-</span> <span class="fu">lm</span>(sales <span class="sc">~</span> ., <span class="at">data =</span> AD)</span>
<span id="cb169-4"><a href="#cb169-4" aria-hidden="true" tabindex="-1"></a><span class="fu">stepAIC</span>(null, <span class="at">scope =</span> <span class="fu">list</span>(<span class="at">lower =</span> null, <span class="at">upper =</span> full), <span class="at">direction =</span> <span class="st">"forward"</span>, <span class="at">test =</span> <span class="st">"F"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=661.8
sales ~ 1

            Df Sum of Sq    RSS    AIC F Value     Pr(F)    
+ TV         1    3314.6 2102.5 474.52 312.145 &lt; 2.2e-16 ***
+ radio      1    1798.7 3618.5 583.10  98.422 &lt; 2.2e-16 ***
+ newspaper  1     282.3 5134.8 653.10  10.887  0.001148 ** 
&lt;none&gt;                   5417.1 661.80                      
+ X          1      14.4 5402.7 663.27   0.529  0.467917    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Step:  AIC=474.52
sales ~ TV

            Df Sum of Sq     RSS    AIC F Value     Pr(F)    
+ radio      1   1545.62  556.91 210.82  546.74 &lt; 2.2e-16 ***
+ newspaper  1    183.97 1918.56 458.20   18.89 2.217e-05 ***
+ X          1     23.23 2079.30 474.29    2.20    0.1395    
&lt;none&gt;                   2102.53 474.52                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Step:  AIC=210.82
sales ~ TV + radio

            Df Sum of Sq    RSS    AIC  F Value  Pr(F)
&lt;none&gt;                   556.91 210.82                
+ X          1  0.181080 556.73 212.75 0.063750 0.8009
+ newspaper  1  0.088717 556.83 212.79 0.031228 0.8599</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = sales ~ TV + radio, data = AD)

Coefficients:
(Intercept)           TV        radio  
    2.92110      0.04575      0.18799  </code></pre>
</div>
</div>
<ul>
<li>Backward elimination</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a>mod.be <span class="ot">&lt;-</span> <span class="fu">lm</span>(sales <span class="sc">~</span> TV <span class="sc">+</span> radio <span class="sc">+</span> newspaper, <span class="at">data =</span> AD)</span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a><span class="fu">drop1</span>(mod.be, <span class="at">test =</span> <span class="st">"F"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Single term deletions

Model:
sales ~ TV + radio + newspaper
          Df Sum of Sq    RSS    AIC   F value Pr(&gt;F)    
&lt;none&gt;                  556.8 212.79                     
TV         1   3058.01 3614.8 584.90 1076.4058 &lt;2e-16 ***
radio      1   1361.74 1918.6 458.20  479.3252 &lt;2e-16 ***
newspaper  1      0.09  556.9 210.82    0.0312 0.8599    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a>mod.be <span class="ot">&lt;-</span> <span class="fu">update</span>(mod.be, .<span class="sc">~</span>. <span class="sc">-</span> newspaper)</span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a><span class="fu">drop1</span>(mod.be, <span class="at">test =</span> <span class="st">"F"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Single term deletions

Model:
sales ~ TV + radio
       Df Sum of Sq    RSS    AIC F value    Pr(&gt;F)    
&lt;none&gt;               556.9 210.82                      
TV      1    3061.6 3618.5 583.10 1082.98 &lt; 2.2e-16 ***
radio   1    1545.6 2102.5 474.52  546.74 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod.be)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = sales ~ TV + radio, data = AD)

Residuals:
    Min      1Q  Median      3Q     Max 
-8.7977 -0.8752  0.2422  1.1708  2.8328 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  2.92110    0.29449   9.919   &lt;2e-16 ***
TV           0.04575    0.00139  32.909   &lt;2e-16 ***
radio        0.18799    0.00804  23.382   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.681 on 197 degrees of freedom
Multiple R-squared:  0.8972,    Adjusted R-squared:  0.8962 
F-statistic: 859.6 on 2 and 197 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<ul>
<li>Using <code>stepAIC</code></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="fu">stepAIC</span>(<span class="fu">lm</span>(sales <span class="sc">~</span> TV <span class="sc">+</span> radio <span class="sc">+</span> newspaper, <span class="at">data =</span> AD), <span class="at">scope =</span> (<span class="sc">~</span>TV <span class="sc">+</span> radio <span class="sc">+</span> newspaper), <span class="at">direction =</span> <span class="st">"backward"</span>, <span class="at">test =</span> <span class="st">"F"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=212.79
sales ~ TV + radio + newspaper

            Df Sum of Sq    RSS    AIC F Value  Pr(F)    
- newspaper  1      0.09  556.9 210.82    0.03 0.8599    
&lt;none&gt;                    556.8 212.79                   
- radio      1   1361.74 1918.6 458.20  479.33 &lt;2e-16 ***
- TV         1   3058.01 3614.8 584.90 1076.41 &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Step:  AIC=210.82
sales ~ TV + radio

        Df Sum of Sq    RSS    AIC F Value     Pr(F)    
&lt;none&gt;                556.9 210.82                      
- radio  1    1545.6 2102.5 474.52  546.74 &lt; 2.2e-16 ***
- TV     1    3061.6 3618.5 583.10 1082.98 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = sales ~ TV + radio, data = AD)

Coefficients:
(Intercept)           TV        radio  
    2.92110      0.04575      0.18799  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Or</span></span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a><span class="fu">stepAIC</span>(full, <span class="at">scope =</span> <span class="fu">list</span>(<span class="at">lower =</span> null, <span class="at">upper =</span> full), <span class="at">direction =</span> <span class="st">"backward"</span>, <span class="at">test =</span> <span class="st">"F"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=214.71
sales ~ X + TV + radio + newspaper

            Df Sum of Sq    RSS    AIC F Value  Pr(F)    
- newspaper  1      0.13  556.7 212.75    0.04 0.8342    
- X          1      0.22  556.8 212.79    0.08 0.7827    
&lt;none&gt;                    556.6 214.71                   
- radio      1   1354.48 1911.1 459.42  474.52 &lt;2e-16 ***
- TV         1   3056.91 3613.5 586.82 1070.95 &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Step:  AIC=212.75
sales ~ X + TV + radio

        Df Sum of Sq    RSS    AIC F Value  Pr(F)    
- X      1      0.18  556.9 210.82    0.06 0.8009    
&lt;none&gt;                556.7 212.75                   
- radio  1   1522.57 2079.3 474.29  536.03 &lt;2e-16 ***
- TV     1   3060.94 3617.7 585.05 1077.61 &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Step:  AIC=210.82
sales ~ TV + radio

        Df Sum of Sq    RSS    AIC F Value     Pr(F)    
&lt;none&gt;                556.9 210.82                      
- radio  1    1545.6 2102.5 474.52  546.74 &lt; 2.2e-16 ***
- TV     1    3061.6 3618.5 583.10 1082.98 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = sales ~ TV + radio, data = AD)

Coefficients:
(Intercept)           TV        radio  
    2.92110      0.04575      0.18799  </code></pre>
</div>
</div>
</section>
<section id="diagnostic-plots" class="level2">
<h2 class="anchored" data-anchor-id="diagnostic-plots">Diagnostic Plots</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="fu">residualPlots</span>(mod2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="MiscRegression_files/figure-html/daignos-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>           Test stat Pr(&gt;|Test stat|)    
TV           -6.7745        1.423e-10 ***
radio         1.0543           0.2931    
Tukey test    7.6351        2.256e-14 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqPlot</span>(mod2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="MiscRegression_files/figure-html/daignos-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]   6 131</code></pre>
</div>
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="fu">influenceIndexPlot</span>(mod2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="MiscRegression_files/figure-html/daignos-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We use a <em>confidence interval</em> to quantify the uncertainty surrounding the <em>average</em> <code>sales</code> over a large number of cities. For example, given that $100,000 is spent on <code>TV</code> advertising and $20,000 is spent on <code>Radio</code> advertising in each city, the 95% confidence interval is [10.9852544, 11.5276775]. We interpret this to mean that 95% of intervals of this form will contain the true value of <code>Sales</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(mod.be, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">TV =</span> <span class="dv">100</span>, <span class="at">radio =</span> <span class="dv">20</span>), <span class="at">interval =</span> <span class="st">"conf"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       fit      lwr      upr
1 11.25647 10.98525 11.52768</code></pre>
</div>
</div>
<p>On the other hand, a <em>prediction interval</em> can be used to quantify the uncertainty surrounding <code>sales</code> for a <em>particular</em> city. Given that $100,000 is spent on <code>TV</code> advertising and $20,000 is spent on <code>radio</code> advertising in <strong>a particular</strong> city, the 95% prediction interval is [7.9296161, 14.5833158]. We interpret this to mean that 95% of intervals of this form will contain the true value of <code>Sales</code> for this city.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(mod.be, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">TV =</span> <span class="dv">100</span>, <span class="at">radio =</span> <span class="dv">20</span>), <span class="at">interval =</span> <span class="st">"pred"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       fit      lwr      upr
1 11.25647 7.929616 14.58332</code></pre>
</div>
</div>
<p>Note that both the intervals are centered at 11.256466, but that the prediction interval is substantially wider than the confidence interval, reflecting the increased uncertainty about <code>Sales</code> for a given city in comparison to the average <code>sales</code> over many locations.</p>
</section>
<section id="non-additive-models" class="level2">
<h2 class="anchored" data-anchor-id="non-additive-models">Non-Additive Models</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a>nam1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(sales <span class="sc">~</span> TV<span class="sc">*</span>radio, <span class="at">data =</span> AD)</span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Same as </span></span>
<span id="cb193-3"><a href="#cb193-3" aria-hidden="true" tabindex="-1"></a>nam2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(sales <span class="sc">~</span> TV <span class="sc">+</span> radio <span class="sc">+</span> TV<span class="sc">:</span>radio, <span class="at">data =</span> AD)</span>
<span id="cb193-4"><a href="#cb193-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(nam1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = sales ~ TV * radio, data = AD)

Residuals:
    Min      1Q  Median      3Q     Max 
-6.3366 -0.4028  0.1831  0.5948  1.5246 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 6.750e+00  2.479e-01  27.233   &lt;2e-16 ***
TV          1.910e-02  1.504e-03  12.699   &lt;2e-16 ***
radio       2.886e-02  8.905e-03   3.241   0.0014 ** 
TV:radio    1.086e-03  5.242e-05  20.727   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.9435 on 196 degrees of freedom
Multiple R-squared:  0.9678,    Adjusted R-squared:  0.9673 
F-statistic:  1963 on 3 and 196 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(nam2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = sales ~ TV + radio + TV:radio, data = AD)

Residuals:
    Min      1Q  Median      3Q     Max 
-6.3366 -0.4028  0.1831  0.5948  1.5246 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 6.750e+00  2.479e-01  27.233   &lt;2e-16 ***
TV          1.910e-02  1.504e-03  12.699   &lt;2e-16 ***
radio       2.886e-02  8.905e-03   3.241   0.0014 ** 
TV:radio    1.086e-03  5.242e-05  20.727   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.9435 on 196 degrees of freedom
Multiple R-squared:  0.9678,    Adjusted R-squared:  0.9673 
F-statistic:  1963 on 3 and 196 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p><strong>Hierarchical Principle:</strong> If an interaction term is included in a model, one should also include the main effects, even if the <em>p-values</em> associated with their coefficients are not significant.</p>
</section>
<section id="qualitative-predictors" class="level2">
<h2 class="anchored" data-anchor-id="qualitative-predictors">Qualitative Predictors</h2>
<p>In the <code>Credit</code> data frame there are four qualitative features/variables <code>Gender</code>, <code>Student</code>, <code>Married</code>, and <code>Ethnicity</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a>Credit <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"http://statlearning.com/s/Credit.csv"</span>)</span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(Credit[, <span class="sc">-</span><span class="dv">1</span>], <span class="at">rownames =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item" id="htmlwidget-8e1fe96c0688a849169a" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-8e1fe96c0688a849169a">{"x":{"filter":"none","vertical":false,"data":[[3606,6645,7075,9504,4897,8047,3388,7114,3300,6819,8117,1311,5308,6922,3291,2525,3714,4378,6384,6626,2860,6378,2631,5179,1757,4323,3625,4534,13414,5611,5666,2733,7838,1829,2646,2558,6457,6481,3899,3461,3327,7659,4763,6257,6375,7569,5043,4431,2252,4569,5183,3969,5441,5466,1499,1786,4742,4779,3480,5294,5198,3089,1671,2998,2937,4160,9704,5099,5619,6819,3954,7402,4923,4523,5390,3180,3293,3254,6662,2101,3449,4263,4433,1433,2906,12066,6340,2271,4307,7518,5767,6040,2832,5435,3075,855,5382,3388,2963,8494,3736,2433,7582,9540,4768,3182,1337,3189,6033,3261,3271,2959,6637,6386,3326,4828,2117,9113,2161,1410,1402,8157,7056,1300,2529,2531,5533,3411,8376,3461,3821,1568,5443,5829,5835,3500,4116,3613,2073,10384,6045,6754,7416,4896,2748,4673,5110,1501,2420,886,5728,4831,2120,4612,3155,1362,4284,5521,5550,3000,4865,1705,7530,2330,5977,4527,2880,2327,2820,6179,2021,4270,4697,4745,10673,2168,2607,3965,4391,7499,3584,5180,6420,4090,11589,4442,3806,2179,7667,4411,5352,9560,3933,10088,2120,5384,7398,3977,2000,4159,5343,7333,1448,6784,5310,3878,2450,4391,4327,9156,3206,5309,4351,5245,5289,4229,2762,5395,1647,5222,5765,8760,6207,4613,7818,5673,6906,5614,4668,7555,5137,4776,4788,2278,8244,2923,4986,5149,2910,3557,3351,906,1233,6617,1787,2001,3211,2220,905,1551,2430,3202,8603,5182,6386,4221,1774,2493,2561,6196,5184,9310,4049,3536,5107,5013,4952,5833,1349,5565,3085,4866,3690,4706,5869,8732,3476,5000,6982,3063,5319,1852,8100,6396,2047,1626,1552,3098,5274,3907,3235,3665,5096,11200,2532,1389,5140,4381,2672,5051,4632,3526,4964,4970,7506,1924,3762,3874,4640,7010,4891,5429,5227,7685,9272,3907,7306,4712,1485,2586,1160,3096,3484,13913,2863,5072,10230,6662,3673,7576,4543,3976,5228,3402,4756,3409,5884,855,5303,10278,3807,3922,2955,3746,5199,1511,5380,10748,1134,5145,1561,5140,7140,4716,3873,11966,6090,2539,4336,4471,5891,4943,5101,6127,9824,6442,7871,3615,5759,8028,6135,2150,3782,5354,4840,5673,7167,1567,4941,2860,7760,8029,5495,3274,1870,5640,3683,1357,6827,7100,10578,6555,2308,1335,5758,4100,3838,4171,2525,5524],[283,483,514,681,357,569,259,512,266,491,589,138,394,511,269,200,286,339,448,479,235,458,213,398,156,326,289,333,949,411,413,210,563,162,199,220,455,462,300,264,253,538,351,445,469,564,376,320,205,354,376,301,394,413,138,154,372,367,281,390,364,254,160,251,223,320,694,380,418,505,318,538,355,338,418,224,251,253,468,171,288,317,344,122,232,828,448,182,352,543,431,456,249,388,245,120,367,266,241,607,256,190,531,682,365,259,115,263,449,279,250,231,491,474,268,369,186,626,173,137,128,599,481,117,192,195,433,259,610,279,281,162,407,427,452,257,314,278,175,728,459,483,549,387,228,341,371,150,192,121,435,353,184,344,235,143,338,406,406,235,381,160,515,203,429,367,214,178,219,459,167,299,344,339,750,206,221,292,316,560,294,382,459,335,805,316,309,167,554,326,385,701,287,730,181,398,517,304,169,310,383,529,145,499,392,321,180,358,320,642,243,397,323,383,410,337,215,392,149,370,437,633,451,344,584,411,527,430,341,547,387,378,360,187,579,232,369,388,236,263,262,103,128,460,147,189,265,188,93,134,191,267,621,402,469,304,135,186,215,450,383,665,296,270,380,379,360,433,142,410,217,347,299,353,439,636,257,353,518,248,377,183,581,485,167,156,142,272,387,296,268,287,380,817,205,149,370,321,204,372,355,289,365,352,536,165,287,298,332,494,369,396,386,534,656,296,522,340,129,229,126,236,282,982,223,364,721,508,297,527,329,291,377,261,351,270,438,119,377,707,301,299,260,280,401,137,420,754,112,389,155,374,507,342,292,832,442,188,339,344,434,362,382,433,685,489,564,263,440,599,466,173,293,383,368,413,515,142,366,214,538,574,409,282,180,398,287,126,482,503,747,472,196,138,410,307,296,321,192,415],[2,3,4,3,2,4,2,2,5,3,4,3,1,1,2,3,3,3,1,2,4,1,3,5,3,5,6,2,2,4,4,5,2,4,2,3,2,2,4,4,3,2,2,1,3,3,2,2,6,4,3,2,1,4,2,2,7,4,2,4,2,3,2,4,2,4,4,4,2,4,4,2,1,4,4,2,1,1,3,2,3,1,3,3,4,4,1,4,4,3,4,3,4,2,3,5,1,4,2,5,1,3,2,6,4,2,2,3,4,5,3,2,4,4,4,5,3,1,3,3,2,2,1,3,1,1,5,3,2,3,4,5,4,4,3,3,2,4,2,3,3,2,3,3,3,2,3,3,2,5,3,3,4,3,2,4,5,2,2,3,5,3,1,5,4,4,2,1,1,4,3,1,4,3,3,3,4,2,2,5,5,3,2,3,1,1,2,2,2,2,4,3,4,7,2,2,1,2,4,3,2,6,2,5,2,8,2,5,3,2,2,3,2,2,2,3,3,3,2,4,3,5,4,5,4,4,6,3,2,3,3,4,1,3,3,3,2,5,6,1,5,2,3,1,4,5,4,3,1,3,2,5,3,6,4,3,2,1,2,6,4,3,1,2,1,3,4,3,4,4,1,1,2,6,5,3,2,2,2,3,3,3,2,3,2,2,2,4,3,2,5,4,2,7,4,5,1,3,1,3,1,3,1,1,2,2,3,3,2,3,1,3,6,2,2,3,2,2,3,5,3,2,6,4,2,1,3,3,3,2,2,2,3,2,2,2,4,3,1,1,4,2,5,2,7,2,5,2,3,3,4,1,2,2,1,2,3,1,1,3,4,2,3,1,3,4,3,2,3,3,4,4,2,2,3,5,2,3,1,1,3,2,1,9,3,3,4,3,2,2,3,2,2,2,4,3,5,5,1,5],[34,82,71,36,68,77,37,87,66,41,30,64,57,49,75,57,73,69,28,44,63,72,61,48,57,25,44,44,41,55,47,43,48,30,25,49,71,69,25,47,54,66,66,24,25,50,64,49,72,49,49,27,32,66,47,60,79,65,70,81,35,59,77,75,79,28,38,69,78,55,75,81,47,31,45,28,68,30,45,65,40,83,63,38,69,41,33,59,57,52,42,47,51,26,45,46,59,74,68,47,41,70,56,66,53,58,74,72,64,37,57,60,42,30,41,81,62,47,40,81,67,83,84,77,30,34,50,72,89,56,56,46,49,80,77,81,70,35,74,87,32,33,84,64,32,51,55,56,69,44,28,66,24,32,31,34,75,72,83,53,67,81,56,80,44,46,35,37,32,36,57,63,60,58,54,52,32,34,29,67,69,81,66,29,62,30,52,75,83,85,50,52,56,39,79,73,67,84,51,43,40,67,58,40,45,29,78,37,46,91,62,25,66,44,62,79,60,65,71,76,53,78,44,72,50,28,78,47,34,76,59,29,39,71,41,25,37,38,58,35,71,36,47,56,66,80,59,50,38,43,47,66,64,60,79,50,71,60,36,55,63,67,66,52,55,46,86,29,82,48,39,30,25,48,81,50,50,50,78,59,35,33,50,75,67,41,48,69,42,30,78,56,31,46,42,67,49,74,70,76,50,38,46,79,64,50,80,41,33,34,52,57,63,75,69,43,57,71,82,54,78,27,51,98,66,66,82,68,54,44,72,48,83,68,64,23,68,32,45,80,35,77,37,44,39,33,51,69,70,71,70,71,41,47,44,58,36,40,81,79,82,46,62,80,67,69,56,70,37,57,40,75,46,37,76,44,46,51,33,84,83,84,33,64,76,58,57,62,80,44,81,43,24,65,40,32,65,67,44,64],[11,15,11,11,16,10,12,9,13,19,14,16,7,9,13,15,17,15,9,9,16,17,10,8,15,16,12,16,14,16,5,16,13,10,14,12,11,9,10,14,14,15,13,14,16,12,16,15,15,13,15,20,12,10,9,8,18,14,17,17,20,10,7,17,15,14,13,16,15,14,12,12,18,15,10,16,16,15,11,14,9,15,11,14,11,12,15,12,8,9,16,16,13,16,15,17,17,17,14,18,11,16,16,15,12,18,15,12,14,19,17,11,14,12,15,8,16,17,17,16,15,13,11,14,12,15,15,11,17,15,12,19,13,12,15,16,8,9,11,7,12,10,17,10,14,14,15,16,11,10,14,13,11,17,16,9,13,16,12,13,11,14,12,16,12,11,15,14,11,12,9,9,18,12,16,17,18,14,10,11,16,12,9,15,17,14,13,15,11,16,17,17,14,19,14,16,12,17,16,7,18,15,13,16,7,13,13,10,15,11,12,15,13,19,16,19,18,14,10,13,13,11,9,17,6,15,15,14,11,9,9,12,14,11,14,18,11,15,19,13,14,11,18,12,15,18,14,19,16,13,18,12,8,12,6,8,14,14,14,9,12,8,13,15,10,13,16,15,12,18,13,10,15,14,9,14,15,12,11,8,12,13,17,17,6,11,15,8,16,9,11,13,15,9,13,10,17,17,18,11,17,7,13,11,13,14,8,14,6,18,16,15,11,18,14,16,14,16,13,16,13,15,11,17,17,12,16,14,16,16,17,16,15,17,15,7,13,12,14,16,8,17,9,17,10,17,18,17,14,13,13,9,14,18,18,8,14,14,18,12,10,16,19,10,16,15,14,14,6,16,12,15,16,16,18,16,10,10,19,10,14,11,9,9,16,15,10,9,13,18,15,15,10,13,8,13,17,12,13,7],["No","Yes","No","Yes","No","No","Yes","No","Yes","Yes","No","No","Yes","No","Yes","Yes","Yes","Yes","Yes","No","Yes","Yes","No","No","Yes","Yes","Yes","No","Yes","Yes","Yes","No","Yes","No","Yes","Yes","Yes","Yes","Yes","No","Yes","No","Yes","Yes","Yes","Yes","Yes","No","No","No","No","No","No","No","Yes","Yes","Yes","Yes","No","Yes","Yes","Yes","Yes","No","Yes","Yes","Yes","Yes","Yes","No","No","Yes","Yes","No","Yes","No","No","Yes","Yes","No","Yes","No","No","Yes","No","Yes","No","Yes","No","Yes","No","No","No","No","Yes","Yes","No","Yes","Yes","No","No","Yes","No","No","Yes","Yes","No","No","No","No","Yes","Yes","No","Yes","No","Yes","Yes","No","Yes","No","Yes","No","Yes","Yes","Yes","Yes","Yes","Yes","No","No","Yes","No","No","Yes","Yes","Yes","Yes","No","Yes","No","Yes","No","No","Yes","No","No","Yes","No","Yes","No","Yes","Yes","Yes","No","No","Yes","Yes","Yes","Yes","No","Yes","No","No","Yes","No","No","No","Yes","Yes","Yes","No","Yes","No","No","No","No","No","Yes","Yes","Yes","No","No","Yes","Yes","Yes","Yes","No","No","No","Yes","Yes","Yes","No","Yes","No","Yes","No","Yes","Yes","No","No","Yes","Yes","Yes","Yes","No","No","Yes","No","Yes","Yes","No","No","No","Yes","Yes","No","No","Yes","Yes","Yes","Yes","No","No","No","Yes","Yes","Yes","Yes","No","No","No","No","No","No","Yes","No","No","Yes","Yes","Yes","No","Yes","Yes","Yes","Yes","Yes","No","No","Yes","Yes","No","Yes","No","Yes","No","Yes","No","No","Yes","No","Yes","Yes","Yes","No","Yes","Yes","Yes","No","Yes","No","Yes","Yes","No","Yes","No","Yes","No","Yes","Yes","Yes","Yes","Yes","Yes","No","Yes","Yes","No","Yes","No","No","Yes","No","No","No","Yes","Yes","No","Yes","Yes","No","Yes","Yes","No","Yes","Yes","No","Yes","No","Yes","No","Yes","No","Yes","No","No","No","No","Yes","No","No","Yes","No","No","No","Yes","No","Yes","Yes","Yes","No","No","No","No","Yes","Yes","No","No","No","No","Yes","Yes","No","Yes","No","No","No","No","No","Yes","Yes","No","No","No","Yes","Yes","No","No","No","No","Yes","Yes","Yes","No","No","No","No","No","Yes","No","No","No","Yes","Yes","Yes","Yes","Yes","No","No","No","Yes","No","No","No","No","Yes","No","No","Yes","No","Yes","Yes","No","No","No","No","No","Yes","No","Yes"],["No","Yes","No","No","No","No","No","No","No","Yes","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","Yes","No","No","No","No","No","No","No","No","Yes","No","No","No","No","No","Yes","No","No","No","No","Yes","Yes","No","Yes","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","Yes","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","Yes","No","Yes","No","No","Yes","Yes","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","Yes","No","Yes","No","Yes","No","No","No","No","No","No","No","No","No","Yes","No","No","No","No","No","No","No","No","No","No","No","Yes","No","No","No","No","Yes","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","Yes","No","No","No","No","No","No","No","No","No","No","No","Yes","No","No","No","Yes","No","No","No","No","No","No","No","No","No","No","Yes","No","Yes","No","Yes","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","Yes","No","No","No","No","No","Yes","Yes","No","No","No","No","No","No","No","No","No","No","No","Yes","No","No","No","No","No","No","No","No","No","No","Yes","Yes","No","No","No","No","No","Yes","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","Yes","No","No","No","No","No","No","No","No","No","Yes","No","No","No","Yes","No","No","No","No","No","Yes","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","Yes","No","No","No","No","No","No","Yes","Yes","No","No","No","No","No","No","No","No","Yes","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No"],["Yes","Yes","No","No","Yes","No","No","No","No","Yes","Yes","No","Yes","Yes","No","Yes","Yes","Yes","Yes","No","No","No","Yes","Yes","No","Yes","No","No","Yes","No","Yes","Yes","No","Yes","Yes","No","Yes","Yes","No","Yes","No","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","No","No","No","No","No","Yes","Yes","Yes","No","Yes","Yes","Yes","Yes","Yes","No","Yes","Yes","No","No","Yes","No","Yes","No","No","No","No","Yes","Yes","No","Yes","No","Yes","Yes","No","No","No","Yes","No","Yes","No","No","No","No","No","No","No","Yes","Yes","No","Yes","Yes","Yes","No","Yes","Yes","No","No","No","Yes","No","No","Yes","Yes","No","No","Yes","Yes","Yes","No","No","Yes","Yes","Yes","Yes","Yes","Yes","No","No","Yes","Yes","No","Yes","Yes","No","No","Yes","No","Yes","Yes","Yes","Yes","Yes","Yes","No","No","Yes","Yes","Yes","Yes","Yes","No","No","Yes","Yes","No","Yes","Yes","No","Yes","Yes","Yes","No","Yes","No","Yes","No","No","Yes","Yes","No","No","Yes","Yes","Yes","Yes","Yes","No","No","No","No","Yes","Yes","No","Yes","Yes","Yes","Yes","Yes","No","Yes","Yes","Yes","Yes","Yes","No","No","No","No","Yes","No","Yes","Yes","No","Yes","No","Yes","Yes","No","Yes","Yes","No","No","No","No","Yes","Yes","Yes","No","Yes","No","Yes","No","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","No","Yes","No","No","Yes","Yes","Yes","Yes","No","Yes","Yes","No","No","Yes","Yes","No","Yes","Yes","Yes","No","Yes","Yes","Yes","Yes","No","Yes","No","No","No","No","No","Yes","No","Yes","Yes","No","No","No","Yes","Yes","Yes","Yes","No","Yes","Yes","No","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","No","Yes","Yes","No","Yes","Yes","Yes","Yes","Yes","Yes","No","Yes","No","Yes","Yes","Yes","No","Yes","No","Yes","No","Yes","Yes","Yes","No","Yes","Yes","Yes","Yes","No","Yes","Yes","No","Yes","No","Yes","Yes","Yes","No","Yes","No","No","Yes","Yes","Yes","Yes","Yes","Yes","Yes","No","Yes","Yes","Yes","Yes","Yes","No","Yes","Yes","No","Yes","Yes","Yes","No","Yes","No","Yes","Yes","Yes","Yes","No","No","Yes","No","No","No","Yes","Yes","Yes","No","Yes","Yes","Yes","No","Yes","No","Yes","No","No","No","No","No","No","Yes","No","No","No","No","Yes","No","Yes","Yes","No"],["South","West","West","West","South","South","East","West","South","East","South","South","West","South","East","East","East","West","West","West","West","South","East","East","South","East","South","East","East","South","South","West","South","South","West","South","South","South","South","South","East","East","West","West","South","South","West","South","West","East","East","East","South","West","West","West","West","South","South","South","West","South","South","South","East","South","West","East","South","South","South","West","West","South","South","East","South","West","South","West","South","South","South","South","South","West","South","West","East","East","East","South","South","East","East","East","West","East","East","South","South","South","South","South","South","South","West","West","South","West","West","East","South","West","South","East","South","West","South","South","West","South","South","East","South","South","West","South","East","East","East","West","East","East","East","East","East","West","South","East","East","South","West","East","South","West","South","South","South","West","East","South","South","South","East","West","South","South","West","West","South","South","South","East","West","South","East","South","West","South","West","South","West","East","East","South","South","West","South","South","West","East","East","West","South","East","East","West","East","South","South","West","West","South","East","East","East","East","East","West","East","South","South","East","South","South","South","South","East","East","South","South","South","East","South","South","West","South","West","South","West","East","South","West","South","West","South","South","East","West","East","South","West","South","East","East","West","West","South","West","West","East","West","South","South","East","West","South","South","South","West","South","South","East","South","East","West","West","South","South","West","West","South","East","South","East","South","West","South","South","South","South","West","West","East","South","South","South","South","South","East","East","South","South","South","West","South","South","West","South","West","South","South","East","West","South","South","West","East","East","South","South","South","East","West","West","South","West","West","South","East","South","South","West","East","South","West","South","South","East","East","South","South","South","West","South","South","West","South","South","West","South","South","East","South","South","South","East","South","East","East","South","East","South","West","South","West","South","South","West","South","South","East","South","West","East","South","West","South","East","South","West","East","South","West","South","South","East","South","South","South","South","South","South","South","South","East","South","South","South","East","South","South","South","East","West","East","West","South","South","West","South","West","East","South","South","East","South","South","West"],[333,903,580,964,331,1151,203,872,279,1350,1407,0,204,1081,148,0,0,368,891,1048,89,968,0,411,0,671,654,467,1809,915,863,0,526,0,0,419,762,1093,531,344,50,1155,385,976,1120,997,1241,797,0,902,654,211,607,957,0,0,379,133,333,531,631,108,0,133,0,602,1388,889,822,1084,357,1103,663,601,945,29,532,145,391,0,162,99,503,0,0,1779,815,0,579,1176,1023,812,0,937,0,0,1380,155,375,1311,298,431,1587,1050,745,210,0,0,227,297,47,0,1046,768,271,510,0,1341,0,0,0,454,904,0,0,0,1404,0,1259,255,868,0,912,1018,835,8,75,187,0,1597,1425,605,669,710,68,642,805,0,0,0,581,534,156,0,0,0,429,1020,653,0,836,0,1086,0,548,570,0,0,0,1099,0,283,108,724,1573,0,0,384,453,1237,423,516,789,0,1448,450,188,0,930,126,538,1687,336,1426,0,802,749,69,0,571,829,1048,0,1411,456,638,0,1216,230,732,95,799,308,637,681,246,52,955,195,653,1246,1230,1549,573,701,1075,1032,482,156,1058,661,657,689,0,1329,191,489,443,52,163,148,0,16,856,0,0,199,0,0,98,0,132,1355,218,1048,118,0,0,0,1092,345,1050,465,133,651,549,15,942,0,772,136,436,728,1255,967,529,209,531,250,269,541,0,1298,890,0,0,0,0,863,485,159,309,481,1677,0,0,293,188,0,711,580,172,295,414,905,0,70,0,681,885,1036,844,823,843,1140,463,1142,136,0,0,5,81,265,1999,415,732,1361,984,121,846,1054,474,380,182,594,194,926,0,606,1107,320,426,204,410,633,0,907,1192,0,503,0,302,583,425,413,1405,962,0,347,611,712,382,710,578,1243,790,1264,216,345,1208,992,0,840,1003,588,1000,767,0,717,0,661,849,1352,382,0,905,371,0,1129,806,1393,721,0,0,734,560,480,138,0,966]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Limit<\/th>\n      <th>Rating<\/th>\n      <th>Cards<\/th>\n      <th>Age<\/th>\n      <th>Education<\/th>\n      <th>Own<\/th>\n      <th>Student<\/th>\n      <th>Married<\/th>\n      <th>Region<\/th>\n      <th>Balance<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[0,1,2,3,4,9]},{"name":"Limit","targets":0},{"name":"Rating","targets":1},{"name":"Cards","targets":2},{"name":"Age","targets":3},{"name":"Education","targets":4},{"name":"Own","targets":5},{"name":"Student","targets":6},{"name":"Married","targets":7},{"name":"Region","targets":8},{"name":"Balance","targets":9}],"order":[],"autoWidth":false,"orderClasses":false},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a>modP <span class="ot">&lt;-</span> <span class="fu">lm</span>(Balance <span class="sc">~</span> Income<span class="sc">*</span>Student, <span class="at">data =</span> Credit)</span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modP)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Balance ~ Income * Student, data = Credit)

Residuals:
    Min      1Q  Median      3Q     Max 
-773.39 -325.70  -41.13  321.65  814.04 

Coefficients:
                  Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)       200.6232    33.6984   5.953 5.79e-09 ***
Income              6.2182     0.5921  10.502  &lt; 2e-16 ***
StudentYes        476.6758   104.3512   4.568 6.59e-06 ***
Income:StudentYes  -1.9992     1.7313  -1.155    0.249    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 391.6 on 396 degrees of freedom
Multiple R-squared:  0.2799,    Adjusted R-squared:  0.2744 
F-statistic:  51.3 on 3 and 396 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Fitted Model: <span class="math inline">\(\widehat{\text{Balance}} = 200.6231529 + 6.2181687\cdot \text{Income} + 476.6758432\cdot \text{Student} -1.9991509\cdot\text{Income}\times\text{Student}\)</span></p>
<section id="predictors-with-only-two-levels" class="level3">
<h3 class="anchored" data-anchor-id="predictors-with-only-two-levels">Predictors with Only Two Levels</h3>
<p>Suppose we wish to investigate differences in credit card balance between males and females, ignoring the other variables for the moment.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ISLR)</span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Credit)</span>
<span id="cb200-3"><a href="#cb200-3" aria-hidden="true" tabindex="-1"></a>modS <span class="ot">&lt;-</span> <span class="fu">lm</span>(Balance <span class="sc">~</span> Gender, <span class="at">data =</span> Credit)</span>
<span id="cb200-4"><a href="#cb200-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Balance ~ Gender, data = Credit)

Residuals:
    Min      1Q  Median      3Q     Max 
-529.54 -455.35  -60.17  334.71 1489.20 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    509.80      33.13  15.389   &lt;2e-16 ***
GenderFemale    19.73      46.05   0.429    0.669    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 460.2 on 398 degrees of freedom
Multiple R-squared:  0.0004611, Adjusted R-squared:  -0.00205 
F-statistic: 0.1836 on 1 and 398 DF,  p-value: 0.6685</code></pre>
</div>
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(modS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> (Intercept) GenderFemale 
   509.80311     19.73312 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tapply</span>(Credit<span class="sc">$</span>Balance, Credit<span class="sc">$</span>Gender, mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Male   Female 
509.8031 529.5362 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> Credit, <span class="fu">aes</span>(<span class="at">x =</span> Gender, <span class="at">y =</span> Balance)) <span class="sc">+</span> </span>
<span id="cb206-3"><a href="#cb206-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb206-4"><a href="#cb206-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb206-5"><a href="#cb206-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">coef</span>(modS)[<span class="dv">1</span>] <span class="sc">+</span> <span class="fu">coef</span>(modS)[<span class="dv">2</span>], <span class="at">color =</span> <span class="st">"purple"</span>) <span class="sc">+</span> </span>
<span id="cb206-6"><a href="#cb206-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">coef</span>(modS)[<span class="dv">1</span>], <span class="at">color =</span> <span class="st">"green"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="MiscRegression_files/figure-html/GGSD-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
<p>Do females have a higher ratio of <code>Balance</code> to <code>Income</code> (credit utilization)? Here is an article from the <a href="https://www.washingtonpost.com/news/get-there/wp/2016/02/17/how-being-a-woman-can-ding-your-credit-score/">Washington Post</a> with numbers that mirror some of the results in the <code>Credit</code> data set.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a>Credit<span class="sc">$</span>Utilization <span class="ot">&lt;-</span> Credit<span class="sc">$</span>Balance <span class="sc">/</span> (Credit<span class="sc">$</span>Income<span class="sc">*</span><span class="dv">100</span>)</span>
<span id="cb207-2"><a href="#cb207-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tapply</span>(Credit<span class="sc">$</span>Utilization, Credit<span class="sc">$</span>Gender, mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Male    Female 
0.1487092 0.1535206 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb209"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tidyverse approach</span></span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true" tabindex="-1"></a>Credit <span class="sc">%&gt;%</span></span>
<span id="cb209-3"><a href="#cb209-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Ratio =</span> Balance <span class="sc">/</span> (Income<span class="sc">*</span><span class="dv">100</span>) ) <span class="sc">%&gt;%</span></span>
<span id="cb209-4"><a href="#cb209-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Gender) <span class="sc">%&gt;%</span></span>
<span id="cb209-5"><a href="#cb209-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="fu">mean</span>(Ratio))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2  2
  Gender   `mean(Ratio)`
  &lt;fct&gt;            &lt;dbl&gt;
1 " Male"          0.149
2 "Female"         0.154</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a>modU <span class="ot">&lt;-</span> <span class="fu">lm</span>(Utilization <span class="sc">~</span> Gender, <span class="at">data =</span> Credit)</span>
<span id="cb211-2"><a href="#cb211-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modU)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Utilization ~ Gender, data = Credit)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.15352 -0.13494 -0.05202  0.06069  0.96804 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.148709   0.012388  12.004   &lt;2e-16 ***
GenderFemale 0.004811   0.017221   0.279     0.78    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.1721 on 398 degrees of freedom
Multiple R-squared:  0.0001961, Adjusted R-squared:  -0.002316 
F-statistic: 0.07806 on 1 and 398 DF,  p-value: 0.7801</code></pre>
</div>
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(modU)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> (Intercept) GenderFemale 
 0.148709165  0.004811408 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb215"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> Credit, <span class="fu">aes</span>(<span class="at">x =</span> Gender, <span class="at">y =</span> Utilization)) <span class="sc">+</span> </span>
<span id="cb215-2"><a href="#cb215-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb215-3"><a href="#cb215-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb215-4"><a href="#cb215-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">coef</span>(modU)[<span class="dv">1</span>] <span class="sc">+</span> <span class="fu">coef</span>(modU)[<span class="dv">2</span>], <span class="at">color =</span> <span class="st">"purple"</span>) <span class="sc">+</span> </span>
<span id="cb215-5"><a href="#cb215-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">coef</span>(modU)[<span class="dv">1</span>], <span class="at">color =</span> <span class="st">"green"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="MiscRegression_files/figure-html/UTIL-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="moving-on-now" class="level2">
<h2 class="anchored" data-anchor-id="moving-on-now">Moving On Now</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a>modS1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Balance <span class="sc">~</span> Limit <span class="sc">+</span> Student, <span class="at">data =</span> Credit)</span>
<span id="cb216-2"><a href="#cb216-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modS1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Balance ~ Limit + Student, data = Credit)

Residuals:
    Min      1Q  Median      3Q     Max 
-637.77 -116.90    6.04  130.92  434.24 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -3.347e+02  2.307e+01  -14.51   &lt;2e-16 ***
Limit        1.720e-01  4.331e-03   39.70   &lt;2e-16 ***
StudentYes   4.044e+02  3.328e+01   12.15   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 199.7 on 397 degrees of freedom
Multiple R-squared:  0.8123,    Adjusted R-squared:  0.8114 
F-statistic: 859.2 on 2 and 397 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb218"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(modS1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> (Intercept)        Limit   StudentYes 
-334.7299372    0.1719538  404.4036438 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb220"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Interaction --- Non-additive Model</span></span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true" tabindex="-1"></a>modS2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Balance <span class="sc">~</span> Limit<span class="sc">*</span>Student, <span class="at">data =</span> Credit)</span>
<span id="cb220-3"><a href="#cb220-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modS2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Balance ~ Limit * Student, data = Credit)

Residuals:
    Min      1Q  Median      3Q     Max 
-705.84 -116.90    6.91  133.97  435.92 

Coefficients:
                   Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)      -3.262e+02  2.392e+01 -13.636  &lt; 2e-16 ***
Limit             1.702e-01  4.533e-03  37.538  &lt; 2e-16 ***
StudentYes        3.091e+02  7.878e+01   3.924 0.000103 ***
Limit:StudentYes  2.028e-02  1.520e-02   1.334 0.183010    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 199.5 on 396 degrees of freedom
Multiple R-squared:  0.8132,    Adjusted R-squared:  0.8118 
F-statistic: 574.5 on 3 and 396 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<section id="what-does-this-look-like" class="level3">
<h3 class="anchored" data-anchor-id="what-does-this-look-like">What does this look like?</h3>
<p>Several points:</p>
<ul>
<li>Is the interaction significant?</li>
<li>Which model is <code>ggplot2</code> graphing below?</li>
<li>Is this the correct model?</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb222"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> Credit, <span class="fu">aes</span>(<span class="at">x =</span> Limit, <span class="at">y =</span> Balance, <span class="at">color =</span> Student)) <span class="sc">+</span> </span>
<span id="cb222-2"><a href="#cb222-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb222-3"><a href="#cb222-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span> </span>
<span id="cb222-4"><a href="#cb222-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-GGDWDYE" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="MiscRegression_files/figure-html/fig-GGDWDYE-1.png" class="img-fluid figure-img" width="480"></p>
<figcaption class="figure-caption">Figure&nbsp;6: Balance versus Limit</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="correct-graph" class="level3">
<h3 class="anchored" data-anchor-id="correct-graph">Correct Graph</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb223"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a>S2M <span class="ot">&lt;-</span> <span class="fu">lm</span>(Balance <span class="sc">~</span> Limit <span class="sc">+</span> Student, <span class="at">data =</span> Credit)</span>
<span id="cb223-2"><a href="#cb223-2" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb223-3"><a href="#cb223-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> Credit, <span class="fu">aes</span>(<span class="at">x =</span> Limit, <span class="at">y =</span> Balance, <span class="at">color =</span> Student)) <span class="sc">+</span></span>
<span id="cb223-4"><a href="#cb223-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb223-5"><a href="#cb223-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb223-6"><a href="#cb223-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="fu">coef</span>(S2M)[<span class="dv">1</span>], <span class="at">slope =</span> <span class="fu">coef</span>(S2M)[<span class="dv">2</span>], <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span> </span>
<span id="cb223-7"><a href="#cb223-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="fu">coef</span>(S2M)[<span class="dv">1</span>] <span class="sc">+</span> <span class="fu">coef</span>(S2M)[<span class="dv">3</span>], <span class="at">slope =</span> <span class="fu">coef</span>(S2M)[<span class="dv">2</span>], <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span> </span>
<span id="cb223-8"><a href="#cb223-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-CG" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="MiscRegression_files/figure-html/fig-CG-1.png" class="img-fluid figure-img" width="480"></p>
<figcaption class="figure-caption">Figure&nbsp;7: Figure this one out!</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="qualitative-predictors-with-more-than-two-levels" class="level3">
<h3 class="anchored" data-anchor-id="qualitative-predictors-with-more-than-two-levels">Qualitative predictors with More than Two Levels</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb224"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a>modQ3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Balance <span class="sc">~</span> Limit <span class="sc">+</span> Ethnicity, <span class="at">data =</span> Credit)</span>
<span id="cb224-2"><a href="#cb224-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modQ3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Balance ~ Limit + Ethnicity, data = Credit)

Residuals:
    Min      1Q  Median      3Q     Max 
-677.39 -145.75   -8.75  139.56  776.46 

Coefficients:
                     Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)        -3.078e+02  3.417e+01  -9.007   &lt;2e-16 ***
Limit               1.718e-01  5.079e-03  33.831   &lt;2e-16 ***
EthnicityAsian      2.835e+01  3.304e+01   0.858    0.391    
EthnicityCaucasian  1.381e+01  2.878e+01   0.480    0.632    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 234 on 396 degrees of freedom
Multiple R-squared:  0.743, Adjusted R-squared:  0.7411 
F-statistic: 381.6 on 3 and 396 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb226"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(modQ3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       (Intercept)              Limit     EthnicityAsian EthnicityCaucasian 
      -307.7574777          0.1718203         28.3533975         13.8089629 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb228"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a>modRM <span class="ot">&lt;-</span> <span class="fu">lm</span>(Balance <span class="sc">~</span> Limit, <span class="at">data =</span> Credit)</span>
<span id="cb228-2"><a href="#cb228-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(modRM, modQ3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: Balance ~ Limit
Model 2: Balance ~ Limit + Ethnicity
  Res.Df      RSS Df Sum of Sq      F Pr(&gt;F)
1    398 21715657                           
2    396 21675307  2     40350 0.3686 0.6919</code></pre>
</div>
</div>
<p>What follows fits three separate regression lines based on <code>Ethnicity</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb230"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a>AfAmer <span class="ot">&lt;-</span> <span class="fu">lm</span>(Balance <span class="sc">~</span> Limit, <span class="at">data =</span> <span class="fu">subset</span>(Credit, Ethnicity <span class="sc">==</span> <span class="st">"African American"</span>))</span>
<span id="cb230-2"><a href="#cb230-2" aria-hidden="true" tabindex="-1"></a>AsAmer <span class="ot">&lt;-</span> <span class="fu">lm</span>(Balance <span class="sc">~</span> Limit, <span class="at">data =</span> <span class="fu">subset</span>(Credit, Ethnicity <span class="sc">==</span> <span class="st">"Asian"</span>))</span>
<span id="cb230-3"><a href="#cb230-3" aria-hidden="true" tabindex="-1"></a>CaAmer <span class="ot">&lt;-</span> <span class="fu">lm</span>(Balance <span class="sc">~</span> Limit, <span class="at">data =</span> <span class="fu">subset</span>(Credit, Ethnicity <span class="sc">==</span> <span class="st">"Caucasian"</span>))</span>
<span id="cb230-4"><a href="#cb230-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(<span class="fu">coef</span>(AfAmer), <span class="fu">coef</span>(AsAmer), <span class="fu">coef</span>(CaAmer))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     (Intercept)     Limit
[1,]   -301.2245 0.1704820
[2,]   -305.4270 0.1774679
[3,]   -282.4442 0.1693873</code></pre>
</div>
<div class="sourceCode cell-code" id="cb232"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> Credit, <span class="fu">aes</span>(<span class="at">x =</span> Limit, <span class="at">y =</span> Balance, <span class="at">color =</span> Ethnicity)) <span class="sc">+</span></span>
<span id="cb232-2"><a href="#cb232-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb232-3"><a href="#cb232-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb232-4"><a href="#cb232-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="MiscRegression_files/figure-html/threesep-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
<p><strong>Note:</strong> <code>Ethnicity</code> is not significant, so we really should have just one line.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb233"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> Credit, <span class="fu">aes</span>(<span class="at">x =</span> Limit, <span class="at">y =</span> Balance)) <span class="sc">+</span></span>
<span id="cb233-2"><a href="#cb233-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> Ethnicity)) <span class="sc">+</span> </span>
<span id="cb233-3"><a href="#cb233-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb233-4"><a href="#cb233-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="MiscRegression_files/figure-html/oneline-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="matrix-scatterplots" class="level2">
<h2 class="anchored" data-anchor-id="matrix-scatterplots">Matrix Scatterplots</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb234"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a><span class="fu">scatterplotMatrix</span>(<span class="sc">~</span> Balance <span class="sc">+</span> Income <span class="sc">+</span> Limit <span class="sc">+</span> Rating <span class="sc">+</span> Cards <span class="sc">+</span> Age <span class="sc">+</span> Education <span class="sc">+</span> Gender <span class="sc">+</span> Student <span class="sc">+</span> Married <span class="sc">+</span> Ethnicity,  <span class="at">data =</span> Credit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="MiscRegression_files/figure-html/SP23-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb235"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a>null <span class="ot">&lt;-</span> <span class="fu">lm</span>(Balance <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> Credit)</span>
<span id="cb235-2"><a href="#cb235-2" aria-hidden="true" tabindex="-1"></a>full <span class="ot">&lt;-</span> <span class="fu">lm</span>(Balance <span class="sc">~</span> ., <span class="at">data =</span> Credit)</span>
<span id="cb235-3"><a href="#cb235-3" aria-hidden="true" tabindex="-1"></a>modC <span class="ot">&lt;-</span> <span class="fu">stepAIC</span>(full, <span class="at">scope =</span> <span class="fu">list</span>(<span class="at">lower =</span> null, <span class="at">upper =</span> full), <span class="at">direction =</span> <span class="st">"backward"</span>, <span class="at">test =</span> <span class="st">"F"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=3682.12
Balance ~ ID + Income + Limit + Rating + Cards + Age + Education + 
    Gender + Student + Married + Ethnicity + Utilization

              Df Sum of Sq     RSS    AIC F Value     Pr(F)    
- Ethnicity    2     11141 3721961 3679.3    0.58 0.5607055    
- Education    1      2980 3713800 3680.4    0.31 0.5780258    
- ID           1      6003 3716824 3680.8    0.62 0.4298721    
- Gender       1      7246 3718066 3680.9    0.75 0.3858391    
- Married      1      8652 3719472 3681.1    0.90 0.3433763    
&lt;none&gt;                     3710820 3682.1                      
- Age          1     36685 3747505 3684.1    3.82 0.0514884 .  
- Rating       1     51096 3761916 3685.6    5.32 0.0216718 *  
- Utilization  1     67189 3778009 3687.3    6.99 0.0085356 ** 
- Cards        1    130397 3841217 3693.9   13.56 0.0002635 ***
- Limit        1    286876 3997696 3709.9   29.84 8.421e-08 ***
- Income       1   3051935 6762756 3920.2  317.46 &lt; 2.2e-16 ***
- Student      1   4655076 8365896 4005.3  484.22 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Step:  AIC=3679.32
Balance ~ ID + Income + Limit + Rating + Cards + Age + Education + 
    Gender + Student + Married + Utilization

              Df Sum of Sq     RSS    AIC F Value     Pr(F)    
- Education    1      3018 3724978 3677.6    0.31 0.5752095    
- ID           1      6005 3727965 3678.0    0.63 0.4293237    
- Married      1      6550 3728511 3678.0    0.68 0.4091349    
- Gender       1      6838 3728799 3678.1    0.71 0.3990231    
&lt;none&gt;                     3721961 3679.3                      
- Age          1     39096 3761056 3681.5    4.08 0.0441954 *  
- Rating       1     48423 3770384 3682.5    5.05 0.0252167 *  
- Utilization  1     70020 3791981 3684.8    7.30 0.0072007 ** 
- Cards        1    133187 3855148 3691.4   13.88 0.0002233 ***
- Limit        1    293994 4015955 3707.7   30.65 5.709e-08 ***
- Income       1   3042199 6764160 3916.3  317.14 &lt; 2.2e-16 ***
- Student      1   4672671 8394632 4002.7  487.11 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Step:  AIC=3677.64
Balance ~ ID + Income + Limit + Rating + Cards + Age + Gender + 
    Student + Married + Utilization

              Df Sum of Sq     RSS    AIC F Value     Pr(F)    
- ID           1      6006 3730984 3676.3    0.63 0.4288762    
- Gender       1      6717 3731695 3676.4    0.70 0.4028206    
- Married      1      7188 3732166 3676.4    0.75 0.3868054    
&lt;none&gt;                     3724978 3677.6                      
- Age          1     39443 3764421 3679.9    4.12 0.0430840 *  
- Rating       1     50628 3775606 3681.0    5.29 0.0220135 *  
- Utilization  1     71717 3796695 3683.3    7.49 0.0064909 ** 
- Cards        1    132836 3857815 3689.7   13.87 0.0002246 ***
- Limit        1    291061 4016040 3705.7   30.40 6.431e-08 ***
- Income       1   3040558 6765536 3914.4  317.53 &lt; 2.2e-16 ***
- Student      1   4693948 8418927 4001.8  490.19 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Step:  AIC=3676.29
Balance ~ Income + Limit + Rating + Cards + Age + Gender + Student + 
    Married + Utilization

              Df Sum of Sq     RSS    AIC F Value     Pr(F)    
- Married      1      6896 3737880 3675.0    0.72 0.3963978    
- Gender       1      8373 3739357 3675.2    0.88 0.3500974    
&lt;none&gt;                     3730984 3676.3                      
- Age          1     37726 3768710 3678.3    3.94 0.0477529 *  
- Rating       1     50282 3781266 3679.6    5.26 0.0224028 *  
- Utilization  1     74587 3805572 3682.2    7.80 0.0054920 ** 
- Cards        1    130839 3861823 3688.1   13.68 0.0002483 ***
- Limit        1    291132 4022117 3704.3   30.43  6.31e-08 ***
- Income       1   3035245 6766229 3912.4  317.27 &lt; 2.2e-16 ***
- Student      1   4689629 8420613 3999.9  490.21 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Step:  AIC=3675.03
Balance ~ Income + Limit + Rating + Cards + Age + Gender + Student + 
    Utilization

              Df Sum of Sq     RSS    AIC F Value     Pr(F)    
- Gender       1      8668 3746548 3674.0    0.91 0.3415625    
&lt;none&gt;                     3737880 3675.0                      
- Age          1     35395 3773275 3676.8    3.70 0.0550578 .  
- Rating       1     47158 3785038 3678.0    4.93 0.0269210 *  
- Utilization  1     72879 3810759 3680.7    7.62 0.0060328 ** 
- Cards        1    135372 3873252 3687.3   14.16 0.0001936 ***
- Limit        1    303600 4041480 3704.3   31.76 3.347e-08 ***
- Income       1   3056864 6794744 3912.1  319.76 &lt; 2.2e-16 ***
- Student      1   4770749 8508629 4002.1  499.04 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Step:  AIC=3673.95
Balance ~ Income + Limit + Rating + Cards + Age + Student + Utilization

              Df Sum of Sq     RSS    AIC F Value     Pr(F)    
&lt;none&gt;                     3746548 3674.0                      
- Age          1     35671 3782220 3675.7    3.73 0.0540906 .  
- Rating       1     46902 3793451 3676.9    4.91 0.0273163 *  
- Utilization  1     75071 3821620 3679.9    7.85 0.0053206 ** 
- Cards        1    136510 3883058 3686.3   14.28 0.0001817 ***
- Limit        1    303278 4049826 3703.1   31.73 3.383e-08 ***
- Income       1   3048196 6794744 3910.1  318.93 &lt; 2.2e-16 ***
- Student      1   4765085 8511634 4000.2  498.57 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb237"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a>modC</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Balance ~ Income + Limit + Rating + Cards + Age + 
    Student + Utilization, data = Credit)

Coefficients:
(Intercept)       Income        Limit       Rating        Cards          Age  
  -487.7563      -6.9234       0.1823       1.0649      16.3703      -0.5606  
 StudentYes  Utilization  
   403.9969     145.4632  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb239"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true" tabindex="-1"></a>modD <span class="ot">&lt;-</span> <span class="fu">stepAIC</span>(null, <span class="at">scope =</span> <span class="fu">list</span>(<span class="at">lower =</span> null, <span class="at">upper =</span> full), <span class="at">direction =</span> <span class="st">"forward"</span>, <span class="at">test =</span> <span class="st">"F"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=4905.56
Balance ~ 1

              Df Sum of Sq      RSS    AIC F Value     Pr(F)    
+ Rating       1  62904790 21435122 4359.6 1167.99 &lt; 2.2e-16 ***
+ Limit        1  62624255 21715657 4364.8 1147.76 &lt; 2.2e-16 ***
+ Utilization  1  27382381 56957530 4750.5  191.34 &lt; 2.2e-16 ***
+ Income       1  18131167 66208745 4810.7  108.99 &lt; 2.2e-16 ***
+ Student      1   5658372 78681540 4879.8   28.62 1.488e-07 ***
+ Cards        1    630416 83709496 4904.6    3.00   0.08418 .  
&lt;none&gt;                     84339912 4905.6                      
+ Gender       1     38892 84301020 4907.4    0.18   0.66852    
+ Education    1      5481 84334431 4907.5    0.03   0.87231    
+ ID           1      3101 84336810 4907.5    0.01   0.90377    
+ Married      1      2715 84337197 4907.5    0.01   0.90994    
+ Age          1       284 84339628 4907.6    0.00   0.97081    
+ Ethnicity    2     18454 84321458 4909.5    0.04   0.95749    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Step:  AIC=4359.63
Balance ~ Rating

              Df Sum of Sq      RSS    AIC F Value     Pr(F)    
+ Utilization  1  11779424  9655698 4042.6  484.32 &lt; 2.2e-16 ***
+ Income       1  10902581 10532541 4077.4  410.95 &lt; 2.2e-16 ***
+ Student      1   5735163 15699959 4237.1  145.02 &lt; 2.2e-16 ***
+ Age          1    649110 20786012 4349.3   12.40 0.0004798 ***
+ Cards        1    138580 21296542 4359.0    2.58 0.1087889    
+ Married      1    118209 21316913 4359.4    2.20 0.1386707    
&lt;none&gt;                     21435122 4359.6                      
+ Education    1     27243 21407879 4361.1    0.51 0.4776403    
+ Gender       1     16065 21419057 4361.3    0.30 0.5855899    
+ ID           1     14092 21421030 4361.4    0.26 0.6096002    
+ Limit        1      7960 21427162 4361.5    0.15 0.7011619    
+ Ethnicity    2     51100 21384022 4362.7    0.47 0.6233922    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Step:  AIC=4042.64
Balance ~ Rating + Utilization

            Df Sum of Sq     RSS    AIC F Value     Pr(F)    
+ Student    1   2671767 6983931 3915.1 151.493 &lt; 2.2e-16 ***
+ Income     1   1025771 8629927 3999.7  47.069  2.65e-11 ***
+ Married    1     95060 9560638 4040.7   3.937   0.04791 *  
+ Age        1     50502 9605197 4042.5   2.082   0.14983    
&lt;none&gt;                   9655698 4042.6                      
+ Limit      1     42855 9612843 4042.9   1.765   0.18472    
+ Education  1     28909 9626789 4043.4   1.189   0.27616    
+ ID         1     12426 9643273 4044.1   0.510   0.47545    
+ Gender     1      7187 9648511 4044.3   0.295   0.58735    
+ Cards      1      3371 9652327 4044.5   0.138   0.71017    
+ Ethnicity  2     13259 9642439 4046.1   0.272   0.76231    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Step:  AIC=3915.06
Balance ~ Rating + Utilization + Student

            Df Sum of Sq     RSS    AIC F Value   Pr(F)    
+ Income     1   2893712 4090219 3703.1 279.451 &lt; 2e-16 ***
+ Limit      1     77766 6906165 3912.6   4.448 0.03557 *  
+ Age        1     58618 6925313 3913.7   3.343 0.06823 .  
&lt;none&gt;                   6983931 3915.1                    
+ Married    1     33686 6950245 3915.1   1.914 0.16725    
+ Education  1      2344 6981587 3916.9   0.133 0.71591    
+ ID         1      1986 6981946 3916.9   0.112 0.73768    
+ Cards      1      1302 6982630 3917.0   0.074 0.78627    
+ Gender     1         9 6983922 3917.1   0.001 0.98212    
+ Ethnicity  2      1715 6982217 3919.0   0.048 0.95278    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Step:  AIC=3703.06
Balance ~ Rating + Utilization + Student + Income

            Df Sum of Sq     RSS    AIC F Value     Pr(F)    
+ Limit      1    178086 3912133 3687.3 17.9354 2.847e-05 ***
+ Age        1     34096 4056122 3701.7  3.3120   0.06953 .  
&lt;none&gt;                   4090219 3703.1                      
+ Married    1     15941 4074278 3703.5  1.5416   0.21512    
+ Gender     1      8880 4081339 3704.2  0.8572   0.35508    
+ ID         1      5005 4085214 3704.6  0.4827   0.48760    
+ Cards      1      4628 4085591 3704.6  0.4463   0.50447    
+ Education  1       445 4089774 3705.0  0.0428   0.83613    
+ Ethnicity  2     16108 4074111 3705.5  0.7769   0.46054    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Step:  AIC=3687.25
Balance ~ Rating + Utilization + Student + Income + Limit

            Df Sum of Sq     RSS    AIC F Value     Pr(F)    
+ Cards      1    129913 3782220 3675.7 13.4989 0.0002718 ***
+ Age        1     29075 3883058 3686.3  2.9427 0.0870572 .  
&lt;none&gt;                   3912133 3687.3                      
+ Gender     1     10045 3902089 3688.2  1.0116 0.3151296    
+ Married    1      8872 3903262 3688.3  0.8932 0.3451820    
+ ID         1      3818 3908316 3688.9  0.3839 0.5358946    
+ Education  1      3501 3908633 3688.9  0.3520 0.5533444    
+ Ethnicity  2     12590 3899543 3690.0  0.6328 0.5316436    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Step:  AIC=3675.74
Balance ~ Rating + Utilization + Student + Income + Limit + Cards

            Df Sum of Sq     RSS    AIC F Value   Pr(F)  
+ Age        1     35671 3746548 3674.0  3.7323 0.05409 .
&lt;none&gt;                   3782220 3675.7                  
+ Gender     1      8945 3773275 3676.8  0.9293 0.33564  
+ ID         1      5574 3776646 3677.2  0.5785 0.44735  
+ Married    1      4801 3777419 3677.2  0.4982 0.48069  
+ Education  1      3733 3778487 3677.3  0.3873 0.53408  
+ Ethnicity  2     10981 3771239 3678.6  0.5693 0.56641  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Step:  AIC=3673.95
Balance ~ Rating + Utilization + Student + Income + Limit + Cards + 
    Age

            Df Sum of Sq     RSS    AIC F Value  Pr(F)
&lt;none&gt;                   3746548 3674.0               
+ Gender     1    8668.5 3737880 3675.0 0.90676 0.3416
+ ID         1    7358.8 3739190 3675.2 0.76949 0.3809
+ Married    1    7191.5 3739357 3675.2 0.75197 0.3864
+ Education  1    3505.2 3743043 3675.6 0.36616 0.5455
+ Ethnicity  2    8615.0 3737933 3677.0 0.44943 0.6383</code></pre>
</div>
<div class="sourceCode cell-code" id="cb241"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb241-1"><a href="#cb241-1" aria-hidden="true" tabindex="-1"></a>modD</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Balance ~ Rating + Utilization + Student + Income + 
    Limit + Cards + Age, data = Credit)

Coefficients:
(Intercept)       Rating  Utilization   StudentYes       Income        Limit  
  -487.7563       1.0649     145.4632     403.9969      -6.9234       0.1823  
      Cards          Age  
    16.3703      -0.5606  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb243"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb243-1"><a href="#cb243-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict</span></span>
<span id="cb243-2"><a href="#cb243-2" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(modC, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">Income =</span> <span class="dv">80</span>, <span class="at">Limit =</span> <span class="dv">5000</span>, <span class="at">Cards =</span> <span class="dv">3</span>, <span class="at">Age =</span> <span class="dv">52</span>, <span class="at">Student =</span> <span class="st">"No"</span>, <span class="at">Rating =</span> <span class="dv">800</span>, <span class="at">Utilization =</span> <span class="fl">0.10</span>), <span class="at">interval =</span> <span class="st">"pred"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       fit      lwr      upr
1 756.2699 309.4089 1203.131</code></pre>
</div>
</div>
</section>
<section id="more-diagnostic-plots" class="level2">
<h2 class="anchored" data-anchor-id="more-diagnostic-plots">More Diagnostic Plots</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb245"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb245-1"><a href="#cb245-1" aria-hidden="true" tabindex="-1"></a><span class="fu">residualPlots</span>(modC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="MiscRegression_files/figure-html/DPcar-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>            Test stat Pr(&gt;|Test stat|)    
Income         1.5431           0.1236    
Limit         12.2615           &lt;2e-16 ***
Rating        11.7689           &lt;2e-16 ***
Cards         -0.7709           0.4412    
Age           -0.2795           0.7800    
Student                                   
Utilization    1.4250           0.1550    
Tukey test    25.9407           &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb247"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb247-1"><a href="#cb247-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqPlot</span>(modC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="MiscRegression_files/figure-html/DPcar-2.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 121 242</code></pre>
</div>
<div class="sourceCode cell-code" id="cb249"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb249-1"><a href="#cb249-1" aria-hidden="true" tabindex="-1"></a><span class="fu">influenceIndexPlot</span>(modC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="MiscRegression_files/figure-html/DPcar-3.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="non-linear-relationships" class="level2">
<h2 class="anchored" data-anchor-id="non-linear-relationships">Non-linear Relationships</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb250"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb250-1"><a href="#cb250-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ISLR)</span>
<span id="cb250-2"><a href="#cb250-2" aria-hidden="true" tabindex="-1"></a>car1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> horsepower, <span class="at">data =</span> Auto)</span>
<span id="cb250-3"><a href="#cb250-3" aria-hidden="true" tabindex="-1"></a>car2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> <span class="fu">poly</span>(horsepower, <span class="dv">2</span>), <span class="at">data =</span> Auto)</span>
<span id="cb250-4"><a href="#cb250-4" aria-hidden="true" tabindex="-1"></a>car5 <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> <span class="fu">poly</span>(horsepower, <span class="dv">5</span>), <span class="at">data =</span> Auto)</span>
<span id="cb250-5"><a href="#cb250-5" aria-hidden="true" tabindex="-1"></a>xs <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(Auto<span class="sc">$</span>horsepower), <span class="fu">max</span>(Auto<span class="sc">$</span>horsepower), <span class="at">length =</span> <span class="dv">500</span>)</span>
<span id="cb250-6"><a href="#cb250-6" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="fu">predict</span>(car1, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">horsepower =</span> xs))</span>
<span id="cb250-7"><a href="#cb250-7" aria-hidden="true" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(car2, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">horsepower =</span> xs))</span>
<span id="cb250-8"><a href="#cb250-8" aria-hidden="true" tabindex="-1"></a>y5 <span class="ot">&lt;-</span> <span class="fu">predict</span>(car5, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">horsepower =</span> xs))</span>
<span id="cb250-9"><a href="#cb250-9" aria-hidden="true" tabindex="-1"></a>DF <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> xs, <span class="at">y1 =</span> y1, <span class="at">y2 =</span> y2, <span class="at">y5 =</span> y5)</span>
<span id="cb250-10"><a href="#cb250-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> Auto, <span class="fu">aes</span>(<span class="at">x =</span> horsepower, <span class="at">y =</span> mpg)) <span class="sc">+</span> </span>
<span id="cb250-11"><a href="#cb250-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb250-12"><a href="#cb250-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb250-13"><a href="#cb250-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> DF, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y1), <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span> </span>
<span id="cb250-14"><a href="#cb250-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> DF, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y2), <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span> </span>
<span id="cb250-15"><a href="#cb250-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> DF, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y5), <span class="at">color =</span> <span class="st">"green"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-NLR" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="MiscRegression_files/figure-html/fig-NLR-1.png" class="img-fluid figure-img" width="480"></p>
<figcaption class="figure-caption">Figure&nbsp;8: Showing non-linear relationships</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb251"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb251-1"><a href="#cb251-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> Auto, <span class="fu">aes</span>(<span class="at">x =</span> horsepower, <span class="at">y =</span> mpg)) <span class="sc">+</span> </span>
<span id="cb251-2"><a href="#cb251-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"lightblue"</span>) <span class="sc">+</span> </span>
<span id="cb251-3"><a href="#cb251-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb251-4"><a href="#cb251-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">data =</span> Auto, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb251-5"><a href="#cb251-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> y <span class="sc">~</span> <span class="fu">poly</span>(x, <span class="dv">2</span>), <span class="at">data =</span> Auto, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb251-6"><a href="#cb251-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> y <span class="sc">~</span> <span class="fu">poly</span>(x, <span class="dv">5</span>), <span class="at">data =</span> Auto, <span class="at">color =</span> <span class="st">"green"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="MiscRegression_files/figure-html/smooth-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb252"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true" tabindex="-1"></a>newC <span class="ot">&lt;-</span> <span class="fu">update</span>(modC, .<span class="sc">~</span>. <span class="sc">-</span> Limit <span class="sc">-</span> Income <span class="sc">-</span> Rating <span class="sc">+</span> <span class="fu">poly</span>(Income, <span class="dv">2</span>) <span class="sc">+</span> <span class="fu">poly</span>(Limit, <span class="dv">4</span>))</span>
<span id="cb252-2"><a href="#cb252-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(newC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Balance ~ Cards + Age + Student + Utilization + 
    poly(Income, 2) + poly(Limit, 4), data = Credit)

Residuals:
    Min      1Q  Median      3Q     Max 
-327.92  -31.35   -3.54   30.91  200.35 

Coefficients:
                   Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)        408.5875    12.2594  33.328  &lt; 2e-16 ***
Cards               17.2245     2.1497   8.013 1.32e-14 ***
Age                 -0.7256     0.1699  -4.270 2.46e-05 ***
StudentYes         369.4275    10.7980  34.213  &lt; 2e-16 ***
Utilization        422.8552    36.6956  11.523  &lt; 2e-16 ***
poly(Income, 2)1 -5263.1585   167.9209 -31.343  &lt; 2e-16 ***
poly(Income, 2)2  -896.3437    95.2993  -9.406  &lt; 2e-16 ***
poly(Limit, 4)1  11775.8484   165.8389  71.008  &lt; 2e-16 ***
poly(Limit, 4)2   1920.4673    97.7898  19.639  &lt; 2e-16 ***
poly(Limit, 4)3   -814.2430    61.0972 -13.327  &lt; 2e-16 ***
poly(Limit, 4)4    393.7068    59.2827   6.641 1.05e-10 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 57.15 on 389 degrees of freedom
Multiple R-squared:  0.9849,    Adjusted R-squared:  0.9845 
F-statistic:  2544 on 10 and 389 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb254"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a><span class="fu">residualPlots</span>(newC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="MiscRegression_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                Test stat Pr(&gt;|Test stat|)    
Cards             -0.1284           0.8979    
Age               -1.2123           0.2261    
Student                                       
Utilization       -5.4273        1.010e-07 ***
poly(Income, 2)                               
poly(Limit, 4)                                
Tukey test         8.1970        2.465e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb256"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb256-1"><a href="#cb256-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqPlot</span>(newC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="MiscRegression_files/figure-html/unnamed-chunk-12-2.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 249 321</code></pre>
</div>
<div class="sourceCode cell-code" id="cb258"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb258-1"><a href="#cb258-1" aria-hidden="true" tabindex="-1"></a><span class="fu">influenceIndexPlot</span>(newC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="MiscRegression_files/figure-html/unnamed-chunk-12-3.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="variance-inflation-factor-vif" class="level2">
<h2 class="anchored" data-anchor-id="variance-inflation-factor-vif">Variance Inflation Factor (VIF)</h2>
<p>The VIF is the ratio of the variance of <span class="math inline">\(\hat{\beta}_j\)</span> when fitting the full model divided by the variance of <span class="math inline">\(\hat{\beta}_j\)</span> if it is fit on its own. The smallest possible value for VIF is 1, which indicates the complete absence of collinearity. The VIF for each variable can be computed using the formula:</p>
<p><span class="math display">\[VIF(\hat{\beta}_j) = \frac{1}{1 - R^2_{X_j|X_{-j}}}\]</span></p>
<p>where <span class="math inline">\(R^2_{X_j|X_{-j}}\)</span> is the <span class="math inline">\(R^2\)</span> from a regression of <span class="math inline">\(X_j\)</span> onto all of the other predictors. If <span class="math inline">\(R^2_{X_j|X_{-j}}\)</span> is close to one, then collinearity is present, and so the VIF will be large.</p>
<p>Compute the VIF for each <span class="math inline">\(\hat{\beta}_j\)</span> of <code>modC</code></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb259"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb259-1"><a href="#cb259-1" aria-hidden="true" tabindex="-1"></a>modC</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Balance ~ Income + Limit + Rating + Cards + Age + 
    Student + Utilization, data = Credit)

Coefficients:
(Intercept)       Income        Limit       Rating        Cards          Age  
  -487.7563      -6.9234       0.1823       1.0649      16.3703      -0.5606  
 StudentYes  Utilization  
   403.9969     145.4632  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb261"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb261-1"><a href="#cb261-1" aria-hidden="true" tabindex="-1"></a>R2inc <span class="ot">&lt;-</span> <span class="fu">summary</span>(<span class="fu">lm</span>(Income <span class="sc">~</span> Limit <span class="sc">+</span> Rating <span class="sc">+</span> Cards <span class="sc">+</span> Age <span class="sc">+</span> Student <span class="sc">+</span> Utilization, <span class="at">data =</span> Credit))<span class="sc">$</span>r.squared</span>
<span id="cb261-2"><a href="#cb261-2" aria-hidden="true" tabindex="-1"></a>R2inc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8716908</code></pre>
</div>
<div class="sourceCode cell-code" id="cb263"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb263-1"><a href="#cb263-1" aria-hidden="true" tabindex="-1"></a>VIFinc <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span> <span class="sc">-</span> R2inc)</span>
<span id="cb263-2"><a href="#cb263-2" aria-hidden="true" tabindex="-1"></a>VIFinc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7.793671</code></pre>
</div>
<div class="sourceCode cell-code" id="cb265"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb265-1"><a href="#cb265-1" aria-hidden="true" tabindex="-1"></a>R2lim <span class="ot">&lt;-</span> <span class="fu">summary</span>(<span class="fu">lm</span>(Limit <span class="sc">~</span> Income <span class="sc">+</span> Rating <span class="sc">+</span> Cards <span class="sc">+</span> Age <span class="sc">+</span> Student <span class="sc">+</span> Utilization, <span class="at">data =</span> Credit))<span class="sc">$</span>r.squared</span>
<span id="cb265-2"><a href="#cb265-2" aria-hidden="true" tabindex="-1"></a>R2lim</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9957067</code></pre>
</div>
<div class="sourceCode cell-code" id="cb267"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb267-1"><a href="#cb267-1" aria-hidden="true" tabindex="-1"></a>VIFlim <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span> <span class="sc">-</span> R2lim)</span>
<span id="cb267-2"><a href="#cb267-2" aria-hidden="true" tabindex="-1"></a>VIFlim</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 232.9193</code></pre>
</div>
</div>
<p>This is tedious is there a function to do this? Yes!</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb269"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb269-1"><a href="#cb269-1" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">vif</span>(modC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Income       Limit      Rating       Cards         Age     Student 
   7.793671  232.919318  230.957276    1.472901    1.046060    1.233070 
Utilization 
   3.323397 </code></pre>
</div>
</div>
</section>
<section id="exercise" class="level2">
<h2 class="anchored" data-anchor-id="exercise">Exercise</h2>
<ul>
<li><p>Create a model that predicts an individuals credit rating (<code>Rating</code>).</p></li>
<li><p>Create another model that predicts rating with <code>Limit</code>, <code>Cards</code>, <code>Married</code>, <code>Student</code>, and <code>Education</code> as features.</p></li>
<li><p>Use your model to predict the <code>Rating</code> for an individual who has a credit card limit of $6,000, has 4 credit cards, is married, is not a student, and has an undergraduate degree (<code>Education</code> = 16).</p></li>
<li><p>Use your model to predict the <code>Rating</code> for an individual who has a credit card limit of $12,000, has 2 credit cards, is married, is not a student, and has an eighth grade education (<code>Education</code> = 8).</p></li>
</ul>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>